var dynamsoft=dynamsoft||{dcsEnv:{}};dynamsoft.dcsEnv=dynamsoft.dcsEnv||{};dynamsoft.dcsEnv.bTrial=true;dynamsoft.dcsEnv.productKey="t0068NQAAAHGf0Jc6Y6F1mD8Ir4FQXZmx7Dy27ShYbGc3TxgjtyU0Kb+9OWfqF7xgTdz5HYk9uq0x+5cAXDs2DtvRNtmSK6o=";dynamsoft.dcsEnv.sessionTimeout=1200;dynamsoft.dcsEnv.resourcesPath="http://www.dynamsoft.com/library/dcs/DCSResources";var dynamsoft=dynamsoft||{};dynamsoft.lib=dynamsoft.lib||{};dynamsoft.lib.detect=dynamsoft.lib.detect||{};dynamsoft.initOrder=dynamsoft.initOrder||[];dynamsoft.dcsEnv=dynamsoft.dcsEnv||{};dynamsoft.dcsEnv.host=dynamsoft.dcsEnv.host||{};dynamsoft.dcsEnv.host.win=dynamsoft.dcsEnv.host.win||window;dynamsoft.dcsEnv._lang=0;var dynamsoft=dynamsoft||{};dynamsoft.lib=dynamsoft.lib||{};(function(lib,undefined){var OP=Object.prototype,AP=Array.prototype,toString=OP.toString,win=window,nil=undefined,EMPTY_STR="",FALSE=!1,TRUE=!0,_console=FALSE,class2TypeMap={},mix,each,navInfo,isNil,types,mixIsFunctions;lib.mix=mix=function(dest,source){for(var i in source){dest[i]=source[i]}return dest};isNil=function(o){return o===nil};isDef=function(o){return o!==nil};mix(lib,{isDef:isDef,isUndef:isNil,isUndefined:isNil,isNull:function(o){return o===null},isNaN:function(o){return isNaN(o)},type:function(o){if(o===null||o===nil){return String(o)}return class2TypeMap[toString.call(o)]||"object"},isPlainObject:function(obj){if(!obj||lib.type(obj)!=="object"||obj.nodeType||obj.window==obj){return FALSE}var key,objConstructor;try{if((objConstructor=obj.constructor)&&!hasOwnProperty(obj,"constructor")&&!hasOwnProperty(objConstructor.prototype,"isPrototypeOf")){return FALSE}}catch(e){return FALSE}for(key in obj){}return isNil(key)||hasOwnProperty(obj,key)}});mixIsFunctions=function(name,lc){class2TypeMap["[object "+name+"]"]=lc=name.toLowerCase();lib["is"+name]=function(o){return lib.type(o)===lc}};mixIsFunctions("Function");lib.each=each=function(object,fn,context){if(object){var key,val,keys,i=0,length=object.length,isObj=isNil(length)||lib.isFunction(object);context=context||null;if(isObj){keys=lib.keys(object);for(;i<keys.length;i++){key=keys[i];if(fn.call(context,object[key],key,object)===FALSE){break}}}else{for(val=object[0];i<length;val=object[++i]){if(fn.call(context,val,i,object)===FALSE){break}}}}return object};types=["String","Object","Boolean","Number"];if(Array.isArray){lib.isArray=Array.isArray}else{types.push("Array")}each(types,mixIsFunctions);if(!isNil(win.console)){_console=win.console;if(!lib.isFunction(_console.log)||!lib.isFunction(_console.error)){_console=false}}mix(lib,{debug:FALSE,log:function(txt){if(lib.debug&&_console){_console.log(txt)}},error:function(txt){if(lib.debug&&_console){_console.error(txt)}},getLogger:function(){var _=lib.log;return{warn:_,log:_,info:_,debug:_}},nil:nil,noop:function(){}});mix(lib,{startsWith:function(str,prefix){return str.lastIndexOf(prefix,0)===0},endsWith:function(str,suffix){var ind=str.length-suffix.length;return ind>=0&&str.indexOf(suffix,ind)===ind},replaceAll:function(str,sFind,sReplace){return str.replace(eval("/"+sFind+"/gi"),sReplace)},upperCaseFirst:function(str){return str.charAt(0).toUpperCase()+str.substr(1)},makeArray:function(o){if(o==null){return[]}if(lib.isArray(o)){return o}var lengthType=typeof o.length,oType=typeof o;if(lengthType!=="number"||o.alert||oType==="string"||oType==="function"&&!("item"in o&&lengthType==="number")){return[o]}var ret=[];for(var i=0,l=o.length;i<l;i++){ret[i]=o[i]}return ret}});var hasEnumBug=!{toString:1}.propertyIsEnumerable("toString"),enumProperties=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];lib.keys=Object.keys||function(o){var result=[],p,i;for(p in o){if(o.hasOwnProperty(p)){result.push(p)}}if(hasEnumBug){for(i=enumProperties.length-1;i>=0;i--){p=enumProperties[i];if(o.hasOwnProperty(p)){result.push(p)}}}return result};function hasOwnProperty(o,p){return OP.hasOwnProperty.call(o,p)}var doc=win.document,docElement=doc&&doc.documentElement,head=doc.getElementsByTagName("head")[0]||docElement,scriptOnload=doc.createElement("script").readyState?function(node,callback){var oldCallback=node.onreadystatechange;node.onreadystatechange=function(){var rs=node.readyState;if(rs==="loaded"||rs==="complete"){node.onreadystatechange=null;oldCallback&&oldCallback();callback.call(this)}}}:function(node,callback){node.addEventListener("load",callback,FALSE);node.addEventListener("error",callback,FALSE)};lib.getScript=function(url,isAsync,callback){var node,u;if(!lib.isFunction(callback)){callback=function(){}}if(!lib.isString(url)||url==EMPTY_STR){callback();return}node=doc.createElement("script");u=["",url].join(EMPTY_STR);node.src=u;if(isAsync){node.async=TRUE}node.charset="utf-8";scriptOnload(node,callback);head.insertBefore(node,head.firstChild);return node};lib.getCss=function(url,callback){var node,u,c=callback;if(!lib.isFunction(c)){c=!1}if(!lib.isString(url)||url==EMPTY_STR){c&&c();return}node=doc.createElement("link");node.href=url;node.rel="stylesheet";node.async=TRUE;c&&scriptOnload(node,c);head.insertBefore(node,head.firstChild);return node};lib.getRandom=function(){var a=(new Date).getTime()%1e4,b=[],tmp;for(var i=0;i<5;i++){tmp=Math.floor(Math.random()*10);if(i==0&&tmp==0){i=-1;continue}b.push(tmp)}if(a<10){b.push("000")}else{if(a<100){b.push("00")}else{if(a<1e3){b.push("0")}}}b.push(a);return b.join("")};mix(lib,{get:function(id){return doc.getElementById(id)},hide:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){o.style.display="none"}},show:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){o.style.display=EMPTY_STR}},toggle:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){if(o.style.display==="none"){o.style.display=EMPTY_STR}else{o.style.display="none"}}},empty:function(el){if(!el){return}while(el.firstChild){el.removeChild(el.firstChild)}},getOffset:function(evt,_parent,target){evt=evt||window.event;var el=target||evt.target,x=0,y=0,parentLeft=0,parentTop=0,scrollTop,scrollLeft,bFixed=false;while(el&&!isNaN(el.offsetLeft)&&!isNaN(el.offsetTop)){scrollLeft=el.scrollLeft;scrollTop=el.scrollTop;if(el.tagName==="BODY"){if(bFixed){scrollLeft=0;scrollTop=0}else{scrollLeft=scrollLeft|document.documentElement.scrollLeft;scrollTop=scrollTop|document.documentElement.scrollTop}}else{if(el.style.position==="fixed"){bFixed=true}}x+=el.offsetLeft-scrollLeft;y+=el.offsetTop-scrollTop;el=el.offsetParent}if(_parent){parentLeft=_parent.left;parentTop=_parent.top}x=evt.clientX-x-parentLeft;y=evt.clientY-y-parentTop;return{x:x,y:y}},getElDimensions:function(el,bOffset){var displayFormat,elDimensions;if(!el){return false}displayFormat=el.style.display;el.style.display="";elDimensions=bOffset?{offsetTop:el.offsetTop,offsetLeft:el.offsetLeft,offsetWidth:el.offsetWidth,offsetHeight:el.offsetHeight}:{clientTop:el.clientTop,clientLeft:el.clientLeft,clientWidth:el.clientWidth?el.clientWidth:parseInt(el.style.width)?parseInt(el.style.width):0,clientHeight:el.clientHeight?el.clientHeight:parseInt(el.style.height)?parseInt(el.style.height):0};el.style.display=displayFormat;return elDimensions}});var ua=navigator.userAgent.toLowerCase(),_platform=navigator.platform.toLowerCase(),_protocol=doc.location.protocol,_ssl=_protocol==="https:",_bFileSystem=_protocol!=="https:"&&_protocol!=="http:",_bWin=_platform=="win32"||_platform=="win64"||_platform=="windows",_bMac=_platform=="mac68k"||_platform=="macppc"||_platform=="macintosh"||_platform=="macintel"||_platform=="iphone",_bLinux=_platform.indexOf("linux")>=0,_isX64=_platform=="win64"||ua.indexOf("WOW64")>=0||ua.indexOf("x86_64")>=0||ua.indexOf("win64")>=0||ua.indexOf("x64")>=0,_nMSIE=ua.indexOf("msie"),_nTrident=ua.indexOf("trident"),_nRV=ua.indexOf("rv:"),_nEdge=ua.indexOf("edge"),_tmp=ua.match(/version\/([\d.]+).*safari/),_bSafari=_tmp?TRUE:FALSE,_nSafari=_tmp?_tmp[1]:0,_nFirefox=ua.indexOf("firefox"),_bFirefox=_nFirefox!=-1,_bEdge=_bWin&&!_bFirefox&&_nEdge!=-1,_indexOfChrome=ua.indexOf("chrome"),_bChrome=!_bEdge&&_indexOfChrome!=-1,_bIE=_bWin&&!_bFirefox&&!_bEdge&&!_bChrome&&(_nMSIE!=-1||_nTrident!=-1||_nRV!=-1),_strIEVersion="",_IEMode=0,_bGecko=ua.match(/Gecko/)?TRUE:FALSE,_bHTML5Edition=FALSE,_strBrowserVersion=EMPTY_STR,_bQuerySelector=FALSE,_nativeJson=win.JSON,guidNum=0;if(_bEdge){_tmp=ua.slice(_nEdge+5);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strIEVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bChrome){_tmp=ua.slice(_indexOfChrome+7);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strBrowserVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bFirefox){_tmp=ua.slice(_nFirefox+8);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strBrowserVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bIE){if(_nMSIE!=-1){_tmp=ua.slice(_nMSIE+4);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_strIEVersion=_tmp}else{if(_nRV!=-1){_tmp=ua.slice(_nRV+3);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_tmp=_tmp.slice(0,_tmp.indexOf(")"));_strIEVersion=_tmp}else{if(_nTrident!=-1){_tmp=ua.slice(_nTrident+7);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_strIEVersion=_tmp}}}if(_strIEVersion===""||_strIEVersion>8){_bHTML5Edition=TRUE}_strBrowserVersion=_tmp}else{if(_bSafari){if(_tmp){_strBrowserVersion=_tmp[1]}_tmp=_nSafari;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=7){_bHTML5Edition=TRUE}}}}}}if(_bEdge||_bIE){if(doc.documentMode){_IEMode=doc.documentMode}else{_IEMode=5;if(doc.compatMode){if(doc.compatMode=="CSS1Compat"){_IEMode=7}}}}if(docElement&&docElement.querySelector&&(!_bIE||_bIE&&_strBrowserVersion>8)){_bQuerySelector=TRUE}if(_bIE&&_strBrowserVersion<9){_nativeJson=null}dynamsoft.navInfo=navInfo={host:win,bSSL:_ssl,bFileSystem:_bFileSystem,bWin:_bWin,bMac:_bMac,bLinux:_bLinux,isX64:_isX64,bIE:_bIE,bEdge:_bEdge,bChrome:_bChrome,bFirefox:_bFirefox,bSafari:_bSafari,bGecko:_bGecko,bHTML5Edition:_bHTML5Edition,strBrowserVersion:_strBrowserVersion,IEMode:_IEMode,bQuerySelectorSupported:_bQuerySelector,nativeJson:_nativeJson,nodejs:FALSE,scrollBarWidth:false};var RE_TRIM=/^[\s\xa0]+|[\s\xa0]+$/g,trim=String.prototype.trim,indexOf=AP.indexOf,lastIndexOf=AP.lastIndexOf,filter=AP.filter,every=AP.every,some=AP.some,map=AP.map;mix(lib,{now:Date.now||function(){return+new Date},guid:function(pre){return(pre||EMPTY_STR)+guidNum++},trim:trim?function(str){return str==null?EMPTY_STR:trim.call(str)}:function(str){return str==null?EMPTY_STR:(str+"").replace(RE_TRIM,EMPTY_STR)},filter:filter?function(arr,fn,context){return filter.call(arr,fn,context||this)}:function(arr,fn,context){var ret=[];each(arr,function(item,i,arr){if(fn.call(context||this,item,i,arr)){ret.push(item)}});return ret},indexOf:indexOf?function(item,arr){return indexOf.call(arr,item)}:function(item,arr){each(arr,function(v,k){if(v===item){return k}});return-1}});var logger=lib.getLogger(),SEP="&",EQ="=",HEX_BASE=16,htmlEntities={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},reverseEntities={},escapeReg,unEscapeReg,escapeRegExp=/[\-#$\^*()+\[\]{}|\\,.?\s]/g;(function(){for(var k in htmlEntities){reverseEntities[htmlEntities[k]]=k}})();function isValidParamValue(val){var t=typeof val;return val==null||t!=="object"&&t!=="function"}function getEscapeReg(){if(escapeReg){return escapeReg}var str=EMPTY_STR;each(htmlEntities,function(entity){str+=entity+"|"});str=str.slice(0,-1);escapeReg=new RegExp(str,"g");return escapeReg}function getUnEscapeReg(){if(unEscapeReg){return unEscapeReg}var str=EMPTY_STR;each(reverseEntities,function(entity){str+=entity+"|"});str+="&#(\\d{1,5});";unEscapeReg=new RegExp(str,"g");return unEscapeReg}lib.mix(lib,{urlEncode:function(s){return encodeURIComponent(String(s))},urlDecode:function(s){return decodeURIComponent(s.replace(/\+/g," "))},fromUnicode:function(str){return str.replace(/\\u([a-f\d]{4})/gi,function(m,u){return String.fromCharCode(parseInt(u,HEX_BASE))})},escapeHtml:function(str){return(str+"").replace(getEscapeReg(),function(m){return reverseEntities[m]})},escapeRegExp:function(str){return str.replace(escapeRegExp,"\\$&")},unEscapeHtml:function(str){return str.replace(getUnEscapeReg(),function(m,n){return htmlEntities[m]||String.fromCharCode(+n)})},param:function(o,sep,eq,serializeArray){sep=sep||SEP;eq=eq||EQ;if(isNil(serializeArray)){serializeArray=TRUE}var buf=[],key,i,v,len,val,encode=lib.urlEncode;for(key in o){val=o[key];key=encode(key);if(isValidParamValue(val)){buf.push(key);if(isDef(val)){buf.push(eq,encode(val+EMPTY_STR))}buf.push(sep)}else{if(lib.isArray(val)&&val.length){for(i=0,len=val.length;i<len;++i){v=val[i];if(isValidParamValue(v)){buf.push(key,serializeArray?encode("[]"):EMPTY_STR);if(isDef(v)){buf.push(eq,encode(v+EMPTY_STR))}buf.push(sep)}}}}}buf.pop();return buf.join(EMPTY_STR)},unparam:function(str,sep,eq){if(!lib.isString(str)||!(str=lib.trim(str))){return{}}sep=sep||SEP;eq=eq||EQ;var ret={},eqIndex,decode=lib.urlDecode,pairs=str.split(sep),key,val,i=0,len=pairs.length;for(;i<len;++i){eqIndex=lib.indexOf(eq,pairs[i]);if(eqIndex===-1){key=decode(pairs[i]);val=nil}else{key=decode(pairs[i].substring(0,eqIndex));val=pairs[i].substring(eqIndex+1);try{val=decode(val)}catch(e){logger.error("decodeURIComponent error : "+val);logger.error(e)}if(lib.endsWith(key,"[]")){key=key.substring(0,key.length-2)}}if(key in ret){if(lib.isArray(ret[key])){ret[key].push(val)}else{ret[key]=[ret[key],val]}}else{ret[key]=val}}return ret}});var splitPathRe=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function normalizeArray(parts,allowAboveRoot){var up=0,i=parts.length-1,newParts=[],last;for(;i>=0;i--){last=parts[i];if(last!=="."){if(last===".."){up++}else{if(up){up--}else{newParts[newParts.length]=last}}}}if(allowAboveRoot){for(;up--;up){newParts[newParts.length]=".."}}newParts=newParts.reverse();return newParts}var Path=lib.Path={resolve:function(){var resolvedPath="",resolvedPathStr,i,args=arguments,path,absolute=0;for(i=args.length-1;i>=0&&!absolute;i--){path=args[i];if(lib.isString(path)&&!!path){resolvedPath=path+"/"+resolvedPath;absolute=path.charAt(0)==="/"}}resolvedPathStr=normalizeArray(lib.filter(resolvedPath.split("/"),function(p){return!!p}),!absolute).join("/");return(absolute?"/":"")+resolvedPathStr||"."},normalize:function(path){var absolute=path.charAt(0)==="/",trailingSlash=path.slice(-1)==="/";path=normalizeArray(lib.filter(path.split("/"),function(p){return!!p}),!absolute).join("/");if(!path&&!absolute){path="."}if(path&&trailingSlash){path+="/"}return(absolute?"/":"")+path},join:function(){var args=lib.makeArray(arguments);return Path.normalize(lib.filter(args,function(p){return p&&lib.isString(p)}).join("/"))},relative:function(from,to){from=Path.normalize(from);to=Path.normalize(to);var fromParts=lib.filter(from.split("/"),function(p){return!!p}),path=[],sameIndex,sameIndex2,toParts=lib.filter(to.split("/"),function(p){return!!p}),commonLength=Math.min(fromParts.length,toParts.length);for(sameIndex=0;sameIndex<commonLength;sameIndex++){if(fromParts[sameIndex]!==toParts[sameIndex]){break}}sameIndex2=sameIndex;while(sameIndex<fromParts.length){path.push("..");sameIndex++}path=path.concat(toParts.slice(sameIndex2));path=path.join("/");return path},basename:function(path,ext){var result=path.match(splitPathRe)||[],basename;basename=result[3]||"";if(ext&&basename&&basename.slice(-1*ext.length)===ext){basename=basename.slice(0,-1*ext.length)}return basename},dirname:function(path){var result=path.match(splitPathRe)||[],root=result[1]||"",dir=result[2]||"";if(!root&&!dir){return"."}if(dir){dir=dir.substring(0,dir.length-1)}return root+dir},extname:function(path){return(path.match(splitPathRe)||[])[4]||""}};var logger=lib.getLogger(),reDisallowedInSchemeOrUserInfo=/[#\/\?@]/g,reDisallowedInPathName=/[#\?]/g,reDisallowedInQuery=/[#@]/g,reDisallowedInFragment=/#/g,URI_SPLIT_REG=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),Path=lib.Path,REG_INFO={scheme:1,userInfo:2,hostname:3,port:4,path:5,query:6,fragment:7};function parseQuery(self){if(!self._queryMap){self._queryMap=lib.unparam(self._query)}}function Query(query){this._query=query||""}Query.prototype={constructor:Query,clone:function(){return new Query(this.toString())},reset:function(query){var self=this;self._query=query||"";self._queryMap=null;return self},count:function(){var self=this,count=0,_queryMap,k;parseQuery(self);_queryMap=self._queryMap;for(k in _queryMap){if(lib.isArray(_queryMap[k])){count+=_queryMap[k].length}else{count++}}return count},has:function(key){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(key){return key in _queryMap}else{return!lib.isEmptyObject(_queryMap)}},get:function(key){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(key){return _queryMap[key]}else{return _queryMap}},keys:function(){var self=this;parseQuery(self);return lib.keys(self._queryMap)},set:function(key,value){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(lib.isString(key)){self._queryMap[key]=value}else{if(key instanceof Query){key=key.get()}each(key,function(v,k){_queryMap[k]=v})}return self},remove:function(key){var self=this;parseQuery(self);if(key){delete self._queryMap[key]}else{self._queryMap={}}return self},add:function(key,value){var self=this,_queryMap,currentValue;if(lib.isString(key)){parseQuery(self);_queryMap=self._queryMap;currentValue=_queryMap[key];if(isNil(currentValue)){currentValue=value}else{currentValue=[].concat(currentValue).concat(value)}_queryMap[key]=currentValue}else{if(key instanceof Query){key=key.get()}for(var k in key){self.add(k,key[k])}}return self},toString:function(serializeArray){var self=this;parseQuery(self);return lib.param(self._queryMap,nil,nil,serializeArray)}};function padding2(str){return str.length===1?"0"+str:str}function equalsIgnoreCase(str1,str2){return str1.toLowerCase()===str2.toLowerCase()}function encodeSpecialChars(str,specialCharsReg){return encodeURI(str).replace(specialCharsReg,function(m){return"%"+padding2(m.charCodeAt(0).toString(16))})}function Uri(uriStr){if(uriStr instanceof Uri){return uriStr.clone()}var components,self=this;lib.mix(self,{scheme:"",userInfo:"",hostname:"",port:"",path:"",query:"",fragment:""});components=Uri.getComponents(uriStr);each(components,function(v,key){v=v||"";if(key==="query"){self.query=new Query(v)}else{try{v=lib.urlDecode(v)}catch(e){logger.error(e+"urlDecode error : "+v)}self[key]=v}});return self}Uri.prototype={constructor:Uri,clone:function(){var uri=new Uri,self=this;each(REG_INFO,function(index,key){uri[key]=self[key]});uri.query=uri.query.clone();return uri},resolve:function(relativeUri){if(lib.isString(relativeUri)){relativeUri=new Uri(relativeUri)}var self=this,override=0,lastSlashIndex,order=["scheme","userInfo","hostname","port","path","query","fragment"],target=self.clone();each(order,function(o){if(o==="path"){if(override){target[o]=relativeUri[o]}else{var path=relativeUri.path;if(path){override=1;if(!lib.startsWith(path,"/")){if(target.hostname&&!target.path){path="/"+path}else{if(target.path){lastSlashIndex=target.path.lastIndexOf("/");if(lastSlashIndex!==-1){path=target.path.slice(0,lastSlashIndex+1)+path}}}}target.path=Path.normalize(path)}}}else{if(o==="query"){if(override||relativeUri.query.toString()){target.query=relativeUri.query.clone();override=1}}else{if(override||relativeUri[o]){target[o]=relativeUri[o];override=1}}}});return target},getScheme:function(){return this.scheme},setScheme:function(scheme){this.scheme=scheme;return this},getHostname:function(){return this.hostname},setHostname:function(hostname){this.hostname=hostname;return this},setUserInfo:function(userInfo){this.userInfo=userInfo;return this},getUserInfo:function(){return this.userInfo},setPort:function(port){this.port=port;return this},getPort:function(){return this.port},setPath:function(path){this.path=path;return this},getPath:function(){return this.path},setQuery:function(query){if(lib.isString(query)){if(lib.startsWith(query,"?")){query=query.slice(1)}query=new Query(encodeSpecialChars(query,reDisallowedInQuery))}this.query=query;return this},getQuery:function(){return this.query},getFragment:function(){return this.fragment},setFragment:function(fragment){var self=this;if(lib.startsWith(fragment,"#")){fragment=fragment.slice(1)}self.fragment=fragment;return self},isSameOriginAs:function(other){var self=this;return equalsIgnoreCase(self.hostname,other.hostname)&&equalsIgnoreCase(self.scheme,other.scheme)&&equalsIgnoreCase(self.port,other.port)},toString:function(serializeArray){var out=[],self=this,scheme,hostname,path,port,fragment,query,userInfo;if(scheme=self.scheme){out.push(encodeSpecialChars(scheme,reDisallowedInSchemeOrUserInfo));out.push(":")}if(hostname=self.hostname){out.push("//");if(userInfo=self.userInfo){out.push(encodeSpecialChars(userInfo,reDisallowedInSchemeOrUserInfo));out.push("@")}out.push(encodeURIComponent(hostname));if(port=self.port){out.push(":");out.push(port)}}if(path=self.path){if(hostname&&!lib.startsWith(path,"/")){path="/"+path}path=Path.normalize(path);out.push(encodeSpecialChars(path,reDisallowedInPathName))}if(query=self.query.toString.call(self.query,serializeArray)){out.push("?");out.push(query)}if(fragment=self.fragment){out.push("#");out.push(encodeSpecialChars(fragment,reDisallowedInFragment))}return out.join("")}};Uri.Query=Query;Uri.getComponents=function(url){url=url||EMPTY_STR;var m=url.match(URI_SPLIT_REG)||[],ret={};each(REG_INFO,function(index,key){ret[key]=m[index]});return ret};lib.Uri=Uri;var logger=lib.getLogger();var win=navInfo.host,doc=win.document,docElem=doc&&doc.documentElement,location=win.location,domReady=0,callbacks=[],POLL_RETIRES=500,POLL_INTERVAL=40,RE_ID_STR=/^#?([\w-]+)$/,RE_NOT_WHITESPACE=/\S/,standardEventModel=!!(doc&&doc.addEventListener),DOM_READY_EVENT="DOMContentLoaded",READY_STATE_CHANGE_EVENT="readystatechange",LOAD_EVENT="load",COMPLETE="complete",addEventListener=standardEventModel?function(el,type,fn){el.addEventListener(type,fn,false)}:function(el,type,fn){el.attachEvent("on"+type,fn)},removeEventListener=standardEventModel?function(el,type,fn){el.removeEventListener(type,fn,false)}:function(el,type,fn){el.detachEvent("on"+type,fn)};lib.mix(lib,{isWindow:function(obj){return obj!=null&&obj==obj.window},globalEval:function(data){if(data&&RE_NOT_WHITESPACE.test(data)){if(win.execScript){win.execScript(data)}else{(function(data){win.eval.call(win,data)})(data)}}},ready:function(fn){if(domReady){try{fn(lib)}catch(e){lib.log(e.stack||e,"error");setTimeout(function(){throw e},0)}}else{callbacks.push(fn)}return this}});function fireReady(){if(domReady){return}if(doc&&!navInfo.nodejs){removeEventListener(win,LOAD_EVENT,fireReady)}domReady=1;for(var i=0;i<callbacks.length;i++){try{callbacks[i](lib)}catch(e){lib.log(e.stack||e,"error");setTimeout(function(){throw e},0)}}}function bindReady(){if(!doc||doc.readyState===COMPLETE){fireReady();return}addEventListener(win,LOAD_EVENT,fireReady);if(standardEventModel){var domReady=function(){removeEventListener(doc,DOM_READY_EVENT,domReady);fireReady()};addEventListener(doc,DOM_READY_EVENT,domReady)}else{var stateChange=function(){if(doc.readyState===COMPLETE){removeEventListener(doc,READY_STATE_CHANGE_EVENT,stateChange);fireReady()}};addEventListener(doc,READY_STATE_CHANGE_EVENT,stateChange);var notframe,doScroll=docElem&&docElem.doScroll;try{notframe=win.frameElement===null}catch(e){notframe=false}if(doScroll&&notframe){var readyScroll=function(){try{doScroll("left");fireReady()}catch(ex){setTimeout(readyScroll,POLL_INTERVAL)}};readyScroll()}}}bindReady();if(navInfo.bIE){try{doc.execCommand("BackgroundImageCache",false,true)}catch(e){}}lib.switchEvent=function(e){e=e||window.event;if(e.which==null){e.which=e.button<2?1:e.button==4?2:3}else{e.which=e.which<2?1:e.which==2?2:3}return e};lib.currentStyle=function(obj,prop){if(obj.currentStyle){return obj.currentStyle[prop]}else{if(window.getComputedStyle){propprop=prop.replace(/([A-Z])/g,"-$1");propprop=prop.toLowerCase();return document.defaultView.getComputedStyle(obj,null)[prop]}}return null};lib.extend=function(ParentClass,childAddConstructor){var ChildClass=function(){ParentClass.apply(this,arguments);if(childAddConstructor){childAddConstructor.apply(this,arguments)}};for(var i in ParentClass.prototype){ChildClass.prototype[i]=ParentClass.prototype[i]}ChildClass.prototype.constructor=ChildClass;return ChildClass};lib.colorStrToInt=function(str){var mystr="0x";if(/^(rgb|RGB)/.test(str)){var nums=str.replace(/[^\d,.]/g,"").split(",");for(var i=0;i<3;++i){var hex=Number(nums[i]).toString(16);if(hex.length==1){hex="0"+hex}mystr+=hex}if(nums.length==4){var hex=Math.round(Number(nums[i])*255).toString(16);if(hex.length==1){hex="0"+hex}mystr+=hex}else{mystr+="ff"}}else{if(str=="transparent"){mystr+="00000000"}else{if(/^#[0-9a-fA-f]{6}$/.test(str)){mystr+=str.replace(/#/,"")+"ff"}else{if(/^#[0-9a-fA-f]{3}$/.test(str)){for(var i=0;i<3;++i){mystr+=str[i]+str[i]}mystr+="ff"}else{mystr="-1"}}}}return Number(mystr)};lib.IntToColorStr=function(value){if(value>4294967295||value<0){return null}var str;if(!navInfo.bHTML5Edition){if(value%256==0){str="transparent"}else{str=Math.floor(value/256).toString(16);while(str.length!=6){str="0"+str}str="#"+str}}else{str="rgba("+Math.floor(value/16777216)+","+Math.floor(value/65536)%256+","+Math.floor(value/256)%256+","+value%256/255+")"}return str};var customEvent={fire:function(type){var self=this,args;self.exec=self.exec||{};type=type.toLowerCase();args=AP.slice.call(arguments,1);each(self.exec[type]||[],function(item){var fn=item.f,ctx=item.c||self;try{fn.apply(ctx,args)}catch(e){console.log(e)}})},on:function(type,fn,ctx){var self=this;self.exec=self.exec||{};type=type.toLowerCase();self.exec[type]=self.exec[type]||[];self.exec[type].push({f:fn,c:ctx})},off:function(type,fn,c){var self=this,exec=self.exec;if(!exec){return}if(!type){self.exec=null;return}type=type.toLowerCase();if(!fn){exec[type]=null;return}var arr=exec[type]||[];for(var i=arr.length-1;i>=0;i--){if(arr[i]===fn){arr.splice(i,1)}}}};function Attributes(config){var self=this;self.__attrs={};self.__attrVals={};self.userConfig=config;while(c){self.addAttrs(c.ATTRS);c=c.superclass?c.superclass.constructor:null}lib.mix(self.__attrs,config)}lib.mix(Attributes.prototype,{get:function(name){var self=this;if(name in self.__attrs){return self.__attrs[name]}return""},set:function(name,v){var self=this;if(name in self.__attrs){self.__attrs[name]=v}},addAttrs:function(attrsConfig){lib.mix(this.__attrs,attrsConfig)}});Attributes.extend=function(px){var SuperClass=this,childAddConstructor,ret;px=px||{};if(px.constructor){childAddConstructor=px.constructor}ret=extend(SuperClass,childAddConstructor);lib.mix(ret,px);return ret};lib.obj={Attributes:Attributes,customEvent:customEvent}})(dynamsoft.lib);(function(s){var ao,g=RegExp,ac,Z,f,k,t,aj,W,S,r,u,o,p,am=!0,d,K,b,Q,ak="dws_"+1*new Date,al=window.document,I=0,w=0,ag=ar(),ah=ar(),E=ar(),x=function(at,e){if(at===e){r=true}return 0},G=[],T=G.pop,Y=G.push,ai=G.push,C=G.slice,F=function(av,au){var at=0,e=av.length;for(;at<e;at++){if(av[at]===au){return at}}return-1},ae="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",O="[\\x20\\t\\r\\n\\f]",z="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ab=["\\[",O,"*(",z,")(?:",O,"*([*^$|!~]?=)",O,"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(",z,"))|)",O,"*\\]"].join(""),B=new g(O+"+","g"),af=new g(["^",O,"+|((?:^|[^\\\\])(?:\\\\.)*)",O,"+$"].join(""),"g"),m=new g(["^",O,"*,",O,"*"].join("")),V=new g(["^",O,"*([>+~]|",O,")",O,"*"].join("")),D=new g("="+O+"*([^\\]'\"]*?)"+O+"*\\]","g"),h=new g("^"+z+"$"),U={ID:new g("^#("+z+")"),CLASS:new g("^\\.("+z+")"),TAG:new g("^("+z+"|[*])"),ATTR:new g("^"+ab),needsContext:new g(["^",O,"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(",O,"*((?:-\\d)?\\d*)",O,"*\\)|)(?=[^-]|$)"].join(""),"i")},J=/^[^{]+\{\s*\[native \w/,aa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,P=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,l=function(at,e){if(e){if(at==="\0"){return"ï¿½"}return at.slice(0,-1)+"\\"+at.charCodeAt(at.length-1).toString(16)+" "}return"\\"+at},q=function(){u()};try{ai.apply(G=C.call(al.childNodes),al.childNodes);G[al.childNodes.length].nodeType}catch(aq){ai={apply:G.length?function(at,e){Y.apply(at,C.call(e))}:function(av,au){var e=av.length,at=0;while(av[e++]=au[at++]){}av.length=e-1}}}function ad(az,at,aC,aF){var ax,aD,aw,e,aE,av,aA,au=at&&at.ownerDocument,aB=at?at.nodeType:9;aC=aC||[];if(typeof az!=="string"||!az||aB!==1&&aB!==9&&aB!==11){return aC}if(!aF){if((at?at.ownerDocument||at:al)!==o){u(at)}at=at||o;if(aB!==11&&(aE=aa.exec(az))){if(ax=aE[1]){if(aB===9){if(aw=at.getElementById(ax)){if(aw.id===ax){aC.push(aw);return aC}}else{return aC}}else{if(au&&(aw=au.getElementById(ax))&&Q(at,aw)&&aw.id===ax){aC.push(aw);return aC}}}else{if(aE[2]){ai.apply(aC,at.getElementsByTagName(az));return aC}else{if((ax=aE[3])&&ac.getElementsByClassName&&at.getElementsByClassName){ai.apply(aC,at.getElementsByClassName(ax));return aC}}}}if(ac.qsa&&!E[az+" "]&&(!d||!d.test(az))){if(aB!==1){au=at;aA=az}else{if(at.nodeName.toLowerCase()!=="object"){if(e=at.getAttribute("id")){e=e.replace(P,l)}else{at.setAttribute("id",e=ak)}av=k(az);aD=av.length;while(aD--){av[aD]="#"+e+" "+a(av[aD])}aA=av.join(",");au=at}}if(aA){try{ai.apply(aC,au.querySelectorAll(aA));return aC}catch(ay){}finally{if(e===ak){at.removeAttribute("id")}}}}}return aj(az.replace(af,"$1"),at,aC,aF)}function ar(){var at=[];function e(au,av){if(at.push(au+" ")>Z.cacheLength){delete e[at.shift()]}return e[au+" "]=av}return e}function an(e){e[ak]=true;return e}function X(au){var at=o.createElement("fieldset");try{return!!au(at)}catch(av){return false}finally{if(at.parentNode){at.parentNode.removeChild(at)}at=null}}function y(e,at){}function j(at,e){var av=e&&at,au=av&&at.nodeType===1&&e.nodeType===1&&at.sourceIndex-e.sourceIndex;if(au){return au}if(av){while(av=av.nextSibling){if(av===e){return-1}}}return at?1:-1}function R(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}ac=ad.support={};u=ad.setDocument=function(au){var e,at,av=au?au.ownerDocument||au:al;if(av===o||av.nodeType!==9||!av.documentElement){return o}o=av;p=o.documentElement;if(al!==o&&(at=o.defaultView)&&at.top!==at){if(at.addEventListener){at.addEventListener("unload",q,false)}else{if(at.attachEvent){at.attachEvent("onunload",q)}}}ac.attributes=X(function(aw){aw.className="i";return!aw.getAttribute("className")});ac.getElementsByTagName=X(function(aw){aw.appendChild(o.createComment(""));return!aw.getElementsByTagName("*").length});ac.getElementsByClassName=J.test(o.getElementsByClassName);ac.getById=X(function(aw){p.appendChild(aw).id=ak;return!o.getElementsByName||!o.getElementsByName(ak).length});if(ac.getById){Z.filter.ID=function(ax){var aw=ax;return function(ay){return ay.getAttribute("id")===aw}}}else{Z.filter.ID=function(ax){var aw=new g(["^",ax,"$"].join(""),"g");return function(az){var ay=typeof az.getAttributeNode!=="undefined"&&az.getAttributeNode("id");return ay&&aw.test(ay.value)}}}Z.find.TAG=ac.getElementsByTagName?function(aw,ax){if(typeof ax.getElementsByTagName!=="undefined"){return ax.getElementsByTagName(aw)}else{if(ac.qsa){return ax.querySelectorAll(aw)}}}:function(aw,aA){var aB,az=[],ay=0,ax=aA.getElementsByTagName(aw);if(aw==="*"){while(aB=ax[ay++]){if(aB.nodeType===1){az.push(aB)}}return az}return ax};Z.find.CLASS=ac.getElementsByClassName&&function(ax,aw){if(typeof aw.getElementsByClassName!=="undefined"){return aw.getElementsByClassName(ax)}};K=[];d=[];if(ac.qsa=J.test(o.querySelectorAll)){X(function(aw){p.appendChild(aw).innerHTML="<a id='"+ak+"'></a><select id='"+ak+"-\r\\' msallowcapture=''><option selected=''></option></select>";if(aw.querySelectorAll("[msallowcapture^='']").length){d.push("[*^$]="+O+"*(?:''|\"\")")}if(!aw.querySelectorAll("[selected]").length){
d.push("\\["+O+"*(?:value|"+ae+")")}if(!aw.querySelectorAll("[id~="+ak+"-]").length){d.push("~=")}if(!aw.querySelectorAll(":checked").length){d.push(":checked")}if(!aw.querySelectorAll("a#"+ak+"+*").length){d.push(".#.+[+~]")}});X(function(ax){ax.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var aw=o.createElement("input");aw.setAttribute("type","hidden");ax.appendChild(aw).setAttribute("name","D");if(ax.querySelectorAll("[name=d]").length){d.push("name"+O+"*[*^$|!~]?=")}if(ax.querySelectorAll(":enabled").length!==2){d.push(":enabled",":disabled")}p.appendChild(ax).disabled=true;if(ax.querySelectorAll(":disabled").length!==2){d.push(":enabled",":disabled")}ax.querySelectorAll("*,:x");d.push(",.*:")})}if(ac.matchesSelector=J.test(b=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector)){X(function(aw){ac.disconnectedMatch=b.call(aw,"*");b.call(aw,"[s!='']:x")})}d=d.length&&new g(d.join("|"));K=K.length&&new g(K.join("|"));e=J.test(p.compareDocumentPosition);Q=e||J.test(p.contains)?function(ax,aw){var az=ax.nodeType===9?ax.documentElement:ax,ay=aw&&aw.parentNode;return ax===ay||!!(ay&&ay.nodeType===1&&(az.contains?az.contains(ay):ax.compareDocumentPosition&&ax.compareDocumentPosition(ay)&16))}:function(ax,aw){if(aw){while(aw=aw.parentNode){if(aw===ax){return true}}}return false};x=e?function(ax,aw){if(ax===aw){r=true;return 0}var ay=!ax.compareDocumentPosition-!aw.compareDocumentPosition;if(ay){return ay}ay=(ax.ownerDocument||ax)===(aw.ownerDocument||aw)?ax.compareDocumentPosition(aw):1;if(ay&1||!ac.sortDetached&&aw.compareDocumentPosition(ax)===ay){if(ax===o||ax.ownerDocument===al&&Q(al,ax)){return-1}if(aw===o||aw.ownerDocument===al&&Q(al,aw)){return 1}return S?F(S,ax)-F(S,aw):0}return ay&4?-1:1}:function(ax,aw){if(ax===aw){r=true;return 0}var aD,aA=0,aC=ax.parentNode,az=aw.parentNode,ay=[ax],aB=[aw];if(!aC||!az){return ax===o?-1:aw===o?1:aC?-1:az?1:S?F(S,ax)-F(S,aw):0}else{if(aC===az){return j(ax,aw)}}aD=ax;while(aD=aD.parentNode){ay.unshift(aD)}aD=aw;while(aD=aD.parentNode){aB.unshift(aD)}while(ay[aA]===aB[aA]){aA++}return aA?j(ay[aA],aB[aA]):ay[aA]===al?-1:aB[aA]===al?1:0};return o};ad.matches=function(at,e){return ad(at,null,null,e)};ad.matchesSelector=function(au,aw){if((au.ownerDocument||au)!==o){u(au)}aw=aw.replace(D,"='$1']");if(ac.matchesSelector&&!E[aw+" "]&&(!K||!K.test(aw))&&(!d||!d.test(aw))){try{var at=b.call(au,aw);if(at||ac.disconnectedMatch||au.document&&au.document.nodeType!==11){return at}}catch(av){}}return ad(aw,o,null,[au]).length>0};ad.contains=function(e,at){if((e.ownerDocument||e)!==o){u(e)}return Q(e,at)};ad.escape=function(e){return(e+"").replace(P,l)};ad.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};ad.uniqueSort=function(au){var av,aw=[],e=0,at=0;r=!ac.detectDuplicates;S=!ac.sortStable&&au.slice(0);au.sort(x);if(r){while(av=au[at++]){if(av===au[at]){e=aw.push(at)}}while(e--){au.splice(aw[e],1)}}S=null;return au};f=ad.getText=function(aw){var av,at="",au=0,e=aw.nodeType;if(!e){while(av=aw[au++]){at+=f(av)}}else{if(e===1||e===9||e===11){if(typeof aw.textContent==="string"){return aw.textContent}else{for(aw=aw.firstChild;aw;aw=aw.nextSibling){at+=f(aw)}}}else{if(e===3||e===4){return aw.nodeValue}}}return at};Z=ad.selectors={cacheLength:50,match:U,find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[3]=e[3]||e[4]||e[5]||"";if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)}},filter:{TAG:function(at){var e=at.toLowerCase();return at==="*"?function(){return true}:function(au){return au.nodeName&&au.nodeName.toLowerCase()===e}},CLASS:function(e){var at=ag[e+" "];return at||(at=new g("(^|"+O+")"+e+"("+O+"|$)"))&&ag(e,function(au){return at.test(typeof au.className==="string"&&au.className||typeof au.getAttribute!=="undefined"&&au.getAttribute("class")||"")})},ATTR:function(au,at,e){return function(aw){var av=ad.attr(aw,au);if(av==null){return at==="!="}if(!at){return true}av+="";return at==="="?av===e:at==="!="?av!==e:at==="^="?e&&av.indexOf(e)===0:at==="*="?e&&av.indexOf(e)>-1:at==="$="?e&&av.slice(-e.length)===e:at==="~="?(" "+av.replace(B," ")+" ").indexOf(e)>-1:at==="|="?av===e||av.slice(0,e.length+1)===e+"-":false}}}};function A(){}A.prototype=Z.filters=Z.pseudos;Z.setFilters=new A;k=ad.tokenize=function(aw,aB){var at,ax,az=[],aA,ay,au,e,av=ah[aw+" "];if(av){return aB?0:av.slice(0)}ay=aw;au=[];e=Z.preFilter;while(ay){if(!at||(ax=m.exec(ay))){if(ax){ay=ay.slice(ax[0].length)||ay}au.push(az=[])}at=false;if(ax=V.exec(ay)){at=ax.shift();az.push({value:at,type:ax[0].replace(af," ")});ay=ay.slice(at.length)}for(aA in Z.filter){if((ax=U[aA].exec(ay))&&(!e[aA]||(ax=e[aA](ax)))){at=ax.shift();az.push({value:at,type:aA,matches:ax});ay=ay.slice(at.length)}}if(!at){break}}return aB?ay.length:ay?ad.error(aw):ah(aw,au).slice(0)};function a(av){var au=0,at=av.length,e="";for(;au<at;au++){e+=av[au].value}return e}function M(ay,aw,ax){var e=aw.dir,av=aw.next,au=av||e,az=ax&&au==="parentNode",at=w++;return aw.first?function(aC,aB,aA){while(aC=aC[e]){if(aC.nodeType===1||az){return ay(aC,aB,aA)}}return false}:function(aF,aD,aC){var aG,aA,aE,aB=[I,at];if(aC){while(aF=aF[e]){if(aF.nodeType===1||az){if(ay(aF,aD,aC)){return true}}}}else{while(aF=aF[e]){if(aF.nodeType===1||az){aE=aF[ak]||(aF[ak]={});aA=aE[aF.uniqueID]||(aE[aF.uniqueID]={});if(av&&av===aF.nodeName.toLowerCase()){aF=aF[e]||aF}else{if((aG=aA[au])&&aG[0]===I&&aG[1]===at){return aB[2]=aG[2]}else{aA[au]=aB;if(aB[2]=ay(aF,aD,aC)){return true}}}}}}return false}}function v(e){return e.length>1?function(aw,av,at){var au=e.length;while(au--){if(!e[au](aw,av,at)){return false}}return true}:e[0]}function H(at,aw,av){var au=0,e=aw.length;for(;au<e;au++){ad(at,aw[au],av)}return av}function L(e,at,au,av,ay){var aw,aB=[],ax=0,az=e.length,aA=at!=null;for(;ax<az;ax++){if(aw=e[ax]){if(!au||au(aw,av,ay)){aB.push(aw);if(aA){at.push(ax)}}}}return aB}function ap(au,at,aw,av,ax,e){if(av&&!av[ak]){av=ap(av)}if(ax&&!ax[ak]){ax=ap(ax,e)}return an(function(aI,aF,aA,aH){var aK,aG,aC,aB=[],aJ=[],az=aF.length,ay=aI||H(at||"*",aA.nodeType?[aA]:aA,[]),aD=au&&(aI||!at)?L(ay,aB,au,aA,aH):ay,aE=aw?ax||(aI?au:az||av)?[]:aF:aD;if(aw){aw(aD,aE,aA,aH)}if(av){aK=L(aE,aJ);av(aK,[],aA,aH);aG=aK.length;while(aG--){if(aC=aK[aG]){aE[aJ[aG]]=!(aD[aJ[aG]]=aC)}}}if(aI){if(ax||au){if(ax){aK=[];aG=aE.length;while(aG--){if(aC=aE[aG]){aK.push(aD[aG]=aC)}}ax(null,aE=[],aK,aH)}aG=aE.length;while(aG--){if((aC=aE[aG])&&(aK=ax?F(aI,aC):aB[aG])>-1){aI[aK]=!(aF[aK]=aC)}}}}else{aE=L(aE===aF?aE.splice(az,aE.length):aE);if(ax){ax(null,aF,aE,aH)}else{ai.apply(aF,aE)}}})}function N(ay){var at,aw,au,ax=ay.length,aB=Z.relative[ay[0].type],aC=aB||Z.relative[" "],av=aB?1:0,az=M(function(aD){return aD===at},aC,true),aA=M(function(aD){return F(at,aD)>-1},aC,true),e=[function(aG,aF,aE){var aD=!aB&&(aE||aF!==W)||((at=aF).nodeType?az(aG,aF,aE):aA(aG,aF,aE));at=null;return aD}];for(;av<ax;av++){if(aw=Z.relative[ay[av].type]){e=[M(v(e),aw)]}else{aw=Z.filter[ay[av].type].apply(null,ay[av].matches);if(aw[ak]){au=++av;for(;au<ax;au++){if(Z.relative[ay[au].type]){break}}return ap(av>1&&v(e),av>1&&a(ay.slice(0,av-1).concat({value:ay[av-2].type===" "?"*":""})).replace(af,"$1"),aw,av<au&&N(ay.slice(av,au)),au<ax&&N(ay=ay.slice(au)),au<ax&&a(ay))}e.push(aw)}}return v(e)}function n(av,au){var e=au.length>0,aw=av.length>0,at=function(aG,aA,aF,aE,aJ){var aB,aC,aH,aL=0,aD="0",ax=aG&&[],aM=[],aK=W,az=aG||aw&&Z.find.TAG("*",aJ),ay=I+=aK==null?1:Math.random()||.1,aI=az.length;if(aJ){W=aA===o||aA||aJ}for(;aD!==aI&&(aB=az[aD])!=null;aD++){if(aw&&aB){aC=0;if(!aA&&aB.ownerDocument!==o){u(aB);aF=!am}while(aH=av[aC++]){if(aH(aB,aA||o,aF)){aE.push(aB);break}}if(aJ){I=ay}}if(e){if(aB=!aH&&aB){aL--}if(aG){ax.push(aB)}}}aL+=aD;if(e&&aD!==aL){aC=0;while(aH=au[aC++]){aH(ax,aM,aA,aF)}if(aG){if(aL>0){while(aD--){if(!(ax[aD]||aM[aD])){aM[aD]=T.call(aE)}}}aM=L(aM)}ai.apply(aE,aM);if(aJ&&!aG&&aM.length>0&&aL+au.length>1){ad.uniqueSort(aE)}}if(aJ){I=ay;W=aK}return ax};return e?an(at):at}t=ad.compile=function(e,au){var av,at=[],ax=[],aw=E[e+" "];if(!aw){if(!au){au=k(e)}av=au.length;while(av--){aw=N(au[av]);if(aw[ak]){at.push(aw)}else{ax.push(aw)}}aw=E(e,n(ax,at));aw.selector=e}return aw};aj=ad.select=function(e,ax,aw,at){var av,ay=typeof e==="function"&&e,au=!at&&k(e=ay.selector||e);aw=aw||[];(ay||t(e,au))(at,ax,!am,aw,!ax||ax);return aw};ac.sortStable=ak.split("").sort(x).join("")===ak;ac.detectDuplicates=!!r;u();ac.sortDetached=X(function(e){return e.compareDocumentPosition(o.createElement("fieldset"))&1});if(!X(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){y("type|href|height|width",function(at,e){return at.getAttribute(e,e.toLowerCase()==="type"?1:2)})}if(!ac.attributes||!X(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){y("value",function(at,e){if(at.nodeName.toLowerCase()==="input"){return at.defaultValue}})}if(!X(function(e){return e.getAttribute("disabled")==null})){y(ae,function(at,e){var au;return at[e]===true?e.toLowerCase():(au=at.getAttributeNode(e))&&au.specified?au.value:null})}s.support=ac;s.all=ad})(dynamsoft.lib);(function(m){var aa=Array.prototype,w=aa.slice,U=aa.push,s=m.makeArray,h=document,f=h.documentElement;function K(ah,ai,ag){var af=this;if(!(af instanceof K)){return new K(ah,ai,ag)}if(!ah){return af}if(typeof ah==="string"){m.error("Err 4001.");return af}if(m.isArray(ah)||ah.isNodeList){U.apply(af,s(ah));return af}af[0]=ah;af.length=1;return af}var G;G=K.prototype={isNodeList:true,length:0,item:function(ag){var af=this;if(m.isNumber(ag)){if(ag>=af.length){return null}else{return new K(af[ag])}}else{return new K(ag)}},slice:function(){return new K(w.apply(this,arguments))},getDOMNodes:function(){return w.call(this)},each:function(ah,ag){var af=this;m.each(af,function(aj,ai){aj=new K(aj);return ah.call(ag||aj,aj,ai,af)});return af},getEL:function(){return this[0]},all:function(af){var ah,ag=this;if(ag.length>0){ah=K.all(af,ag)}else{ah=new K}return ah},one:function(af){var ag=this,ai=ag.all(af),ah=ai.length?ai.slice(0,1):null;return ah}};m.mix(K,{all:function(af,ah){var ag=ah;if(ag&&ag.isNodeList){ag=ah.getEL()}if(typeof af==="string"){if((af=m.trim(af))&&af.length>=3&&m.startsWith(af,"<")&&m.endsWith(af,">")){m.err("Err 4002.")}return new K(m.all(af,ag))}if(af.isNodeList){return af}return new K(af)},one:function(af,ag){var ah=K.all(af,ag);return ah.length?ah.slice(0,1):null}});m.one=K.one;var N=m.support,R=m.all;var d,S,V,J,u,n,M=document.createElement("div"),Y=document.createElement("div");if(!Y.style){return}Y.style.cssText="float:left;opacity:.5";N.opacity=Y.style.opacity==="0.5";N.cssFloat=!!Y.style.cssFloat;Y.style.backgroundClip="content-box";Y.cloneNode(true).style.backgroundClip="";N.clearCloneStyle=Y.style.backgroundClip==="content-box";M=document.createElement("div");M.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute";Y.innerHTML="";M.appendChild(Y);N.boxSizing=Y.style.boxSizing===""||Y.style.MozBoxSizing===""||Y.style.WebkitBoxSizing==="";m.mix(N,{reliableHiddenOffsets:function(){if(d==null){r()}return J},boxSizingReliable:function(){if(d==null){r()}return V},pixelMarginRight:function(){if(d==null){r()}return S},pixelPosition:function(){if(d==null){r()}return d},reliableMarginRight:function(){if(d==null){r()}return u},reliableMarginLeft:function(){if(d==null){r()}return n}});function r(){var ag,af;f.appendChild(M);Y.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";d=V=n=false;S=u=true;if(window.getComputedStyle){af=window.getComputedStyle(Y);d=(af||{}).top!=="1%";n=(af||{}).marginLeft==="2px";V=(af||{width:"4px"}).width==="4px";Y.style.marginRight="50%";S=(af||{marginRight:"4px"}).marginRight==="4px";ag=Y.appendChild(document.createElement("div"));ag.style.cssText=Y.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";ag.style.marginRight=ag.style.width="0";Y.style.width="1px";u=!parseFloat((window.getComputedStyle(ag)||{}).marginRight);Y.removeChild(ag)}Y.style.display="none";J=Y.getClientRects().length===0;if(J){Y.style.display="";Y.innerHTML="<table><tr><td></td><td>t</td></tr></table>";Y.childNodes[0].style.borderCollapse="separate";ag=Y.getElementsByTagName("td");ag[0].style.cssText="margin:0;border:0;padding:0;display:none";J=ag[0].offsetHeight===0;if(J){ag[0].style.display="";ag[1].style.display="none";J=ag[0].offsetHeight===0}}f.removeChild(M)}var l,j,t=/^(top|right|bottom|left)$/;if(window.getComputedStyle){l=function(ah){var ag,af;ag=m.isFunction(ah.getEL)?ah.getEL():ah;af=ag.ownerDocument.defaultView;if(!af||!af.opener){af=window}return af.getComputedStyle(ag)};j=function(am,ag,al){var aj,ai,ak,af,ah=am.style;al=al||l(am);af=al?al.getPropertyValue(ag)||al[ag]:undefined;if((af===""||af===undefined)&&!y.contains(am.ownerDocument,am)){af=y.style(am,ag)}if(al){if(!N.pixelMarginRight()&&L.test(af)&&rmargin.test(ag)){aj=ah.width;ai=ah.minWidth;ak=ah.maxWidth;ah.minWidth=ah.maxWidth=ah.width=af;af=al.width;ah.width=aj;ah.minWidth=ai;ah.maxWidth=ak}}return af===undefined?af:af+""}}else{if(f.currentStyle){l=function(af){return af.currentStyle};j=function(al,ai,ak){var am,ag,af,ah,aj=al.style;ak=ak||l(al);ah=ak?ak[ai]:undefined;if(ah==null&&aj&&aj[ai]){ah=aj[ai]}if(L.test(ah)&&!t.test(ai)){am=aj.left;ag=al.runtimeStyle;af=ag&&ag.left;if(af){ag.left=al.currentStyle.left}aj.left=ai==="fontSize"?"1em":ah;ah=aj.pixelLeft+"px";aj.left=am;if(af){ag.left=af}}return ah===undefined?ah:ah+""||"auto"}}}var g=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,q=/<([\w:-]+)/,e=/^\s+/,x=/<|&#?\w+;/,H=/^-ms-/,A=/-([\da-z])/gi,B=/^(none|table(?!-c[ea]).+)/,P=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/;var b=["Top","Right","Bottom","Left"];var T={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:N.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};var D,Z=["Webkit","O","Moz","ms"],I="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";var Y=document.createElement("div");if(!Y.style){return}D=Y.style;N.cssFloat=!!Y.style.cssFloat;var C=function(af,ag){return ag.toUpperCase()};var y={type:function(af){if(af==null){return af+""}return typeof af==="object"||typeof af==="function"?class2type[toString.call(af)]||"object":typeof af},cssHooks:{},htmlPrefilter:function(af){return af.replace(g,"<$1></$2>")},nodeName:function(ag,af){return ag.nodeName&&ag.nodeName.toLowerCase()===af.toLowerCase()},merge:function(aj,ah){var af=+ah.length,ag=0,ai=aj.length;while(ag<af){aj[ai++]=ah[ag++]}if(af!==af){while(ah[ag]!==undefined){aj[ai++]=ah[ag++]}}aj.length=ai;return aj},camelCase:function(af){return af.replace(H,"ms-").replace(A,C)},cssProps:{float:N.cssFloat?"cssFloat":"styleFloat"},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true}};function O(af){if(af in D){return af}var ah=af.charAt(0).toUpperCase()+af.slice(1),ag=Z.length;while(ag--){af=Z[ag]+ah;if(af in D){return af}}}function p(ai,af){var ag,aj,ah=0,ak=typeof ai.getElementsByTagName!=="undefined"?ai.getElementsByTagName(af||"*"):typeof ai.querySelectorAll!=="undefined"?ai.querySelectorAll(af||"*"):undefined;if(!ak){for(ak=[],ag=ai.childNodes||ai;(aj=ag[ah])!=null;ah++){if(!af||y.nodeName(aj,af)){ak.push(aj)}else{y.merge(ak,p(aj,af))}}}return af===undefined||af&&y.nodeName(ai,af)?y.merge([ai],ak):ak}function k(ag,ai){var an,ak,am,ap,ar,aq,ah,al=ag.length,aj=W(ai),af=[],ao=0;for(;ao<al;ao++){ak=ag[ao];if(ak||ak===0){if(m.type(ak)==="object"){y.merge(af,ak.nodeType?[ak]:ak)}else{if(!x.test(ak)){af.push(ai.createTextNode(ak))}else{ap=ap||aj.appendChild(ai.createElement("div"));ar=(q.exec(ak)||["",""])[1].toLowerCase();ah=T[ar]||T._default;ap.innerHTML=ah[1]+y.htmlPrefilter(ak)+ah[2];an=ah[0];while(an--){ap=ap.lastChild}if(!N.leadingWhitespace&&e.test(ak)){af.push(ai.createTextNode(e.exec(ak)[0]))}if(!N.tbody){ak=ar==="table"&&!rtbody.test(ak)?ap.firstChild:ah[1]==="<table>"&&!rtbody.test(ak)?ap:0;an=ak&&ak.childNodes.length;while(an--){if(y.nodeName(aq=ak.childNodes[an],"tbody")&&!aq.childNodes.length){ak.removeChild(aq)}}}y.merge(af,ap.childNodes);ap.textContent="";while(ap.firstChild){ap.removeChild(ap.firstChild)}ap=aj.lastChild}}}}if(ap){aj.removeChild(ap)}ao=0;while(ak=af[ao++]){am=R.contains(ak.ownerDocument,ak);ap=p(aj.appendChild(ak),"script");if(am){setGlobalEval(ap)}}ap=null;return aj}function W(ah){var ag=I.split("|"),af=ah.createDocumentFragment();if(af.createElement){while(ag.length){af.createElement(ag.pop())}}return af}var F=function(ak,aj,al,ai){var ah,ag,af={};for(ag in aj){af[ag]=ak.style[ag];ak.style[ag]=aj[ag]}ah=al.apply(ak,ai||[]);for(ag in aj){ak.style[ag]=af[ag]}return ah};var X=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var L=new RegExp("^("+X+")(?!px)[a-z%]+$","i");function ad(aj,ag,af){var ai=true,ak=ag==="width"?aj.offsetWidth:aj.offsetHeight,ah=l(aj),al=N.boxSizing&&y.css(aj,"boxSizing",false,ah)==="border-box";if(ak<=0||ak==null){ak=j(aj,ag,ah);if(ak<0||ak==null){ak=aj.style[ag]}if(L.test(ak)){return ak}ai=al&&(N.boxSizingReliable()||ak===aj.style[ag]);ak=parseFloat(ak)||0}return ak+v(aj,ag,af||(al?"border":"content"),ai,ah)}function v(aj,ag,af,al,ai){var ah=af===(al?"border":"content")?4:ag==="width"?1:0,ak=0;for(;ah<4;ah+=2){if(af==="margin"){ak+=y.css(aj,af+b[ah],true,ai)}if(al){if(af==="content"){ak-=y.css(aj,"padding"+b[ah],true,ai)}if(af!=="margin"){ak-=y.css(aj,"border"+b[ah]+"Width",true,ai)}}else{ak+=y.css(aj,"padding"+b[ah],true,ai);if(af!=="padding"){ak+=y.css(aj,"border"+b[ah]+"Width",true,ai)}}}return ak}function Q(af){return new RegExp("^(?:([+-])=|)("+af+")([a-z%]*)$","i")}function z(af,ah,ai){var ag=Q(ah);return ag?Math.max(0,ag[2]-(ai||0))+(ag[3]||"px"):ah}function o(ag,af,aj,ao){var ap,ah=1,al=20,an=ao?function(){return ao.cur()}:function(){return y.css(ag,af,"")},ak=an(),am=aj&&aj[3]||(y.cssNumber[af]?"":"px"),ai=(y.cssNumber[af]||am!=="px"&&+ak)&&Q(y.css(ag,af));if(ai&&ai[3]!==am){am=am||ai[3];aj=aj||[];ai=+ak||1;do{ah=ah||".5";ai=ai/ah;y.style(ag,af,ai+am)}while(ah!==(ah=an()/ak)&&ah!==1&&--al)}if(aj){ai=+ai||+ak||0;ap=aj[1]?ai+(aj[1]+1)*aj[2]:+aj[2];if(ao){ao.unit=am;ao.start=ai;ao.end=ap}}return ap}m.each(["height","width"],function(af,ag){y.cssHooks[af]={get:function(aj,ai,ah){if(ai){return B.test(y.css(aj,"display"))&&aj.offsetWidth===0?F(aj,cssShow,function(){return ad(aj,af,ah)}):ad(aj,af,ah)}},set:function(aj,ak,ah){var ai=ah&&l(aj);return z(aj,ak,ah?v(aj,af,ah,N.boxSizing&&y.css(aj,"boxSizing",false,ai)==="border-box",ai):0)}}});m.style=y.style=function(ah,ag,am,ai){if(!ah||ah.nodeType===3||ah.nodeType===8||!ah.style){return}var ak,al,an,aj=y.camelCase(ag),af=ah.style;ag=y.cssProps[aj]||(y.cssProps[aj]=O(aj)||aj);an=y.cssHooks[ag]||y.cssHooks[aj];if(am!==undefined){al=typeof am;if(al==="string"&&(ak=Q(am))&&ak[1]){am=o(ah,ag,ak);al="number"}if(am==null||am!==am){return}if(al==="number"){am+=ak&&ak[3]||(y.cssNumber[aj]?"":"px")}if(!N.clearCloneStyle&&am===""&&ag.indexOf("background")===0){af[ag]="inherit"}if(!an||!("set"in an)||(am=an.set(ah,am,ai))!==undefined){af[ag]=am}}else{if(an&&"get"in an&&(ak=an.get(ah,false,ai))!==undefined){return ak}return af[ag]}};m.css=y.css=function(al,aj,ag,ak){var ai,am,af,ah=y.camelCase(aj);aj=y.cssProps[ah]||(y.cssProps[ah]=O(ah)||ah);af=y.cssHooks[aj]||y.cssHooks[ah];if(af&&"get"in af){am=af.get(al,true,ag)}if(am===undefined){am=j(al,aj,ak)}if(am==="normal"&&aj in cssNormalTransform){am=cssNormalTransform[aj]}if(ag===""||ag){ai=parseFloat(am);return ag===true||isFinite(ai)?ai||0:am}return am};var a=" ",ae=/[\n\t\r]/g,ac=function(af){return(a+af+a).replace(ae,a)},ab=function(aj,al){var ai=aj.className,af,ag=al.length,ak,ah;if(ai){af=ac(ai);ak=ai;ah=0;for(;ah<ag;ah++){if(af.indexOf(a+al[ah]+a)<0){ak+=a+al[ah]}}ak=m.trim(ak)}else{ak=al.join(" ")}aj.className=ak},E=function(aj,al){var ah=aj.className,ai,af=al.length,ag,ak;if(ah&&af){ai=ac(ah);ag=0;for(;ag<af;ag++){ak=a+al[ag]+a;while(ai.indexOf(ak)>=0){ai=ai.replace(ak,a)}}aj.className=m.trim(ai)}};m.mix(G,{before:function(ag){var ah=this.getEL(),af=ag;if(typeof ag==="string"&&(ag=m.trim(ag))&&ag.length>=3&&m.startsWith(ag,"<")&&m.endsWith(ag,">")){af=m.parseHTML(ag)[0]}ah.insertBefore(af,ah.childNodes[0])},append:function(ag){var ah=this.getEL(),af=ag;if(typeof ag==="string"&&(ag=m.trim(ag))&&ag.length>=3&&m.startsWith(ag,"<")&&m.endsWith(ag,">")){af=m.parseHTML(ag)[0]}ah.appendChild(af)},html:function(af){this.getEL().innerHTML=af},attr:function(ah,af){var ag=this.getEL();if(ah=="class"){ag.className=af}else{ag[ah]=af}},style:function(ah,af){var ag=this.getEL();y.style(ag,ah,af)},css:function(af){var ag=this.getEL();m.each(af,function(ah,ai){y.style(ag,ai,ah)})},addClass:function(af){var ag=this.getEL();ab(ag,af.split(a))},removeClass:function(af){var ag=this.getEL();E(ag,af.split(a))},parent:function(){var af=this.getEL();return new K(af.parentNode)},remove:function(){var af=this.getEL();af.parentNode.removeChild(af)}});m.parseHTML=function(ah,ag){if(!ah||typeof ah!=="string"){return null}if(typeof ag==="boolean"){ag=false}ag=ag||document;var af=P.exec(ah);if(af){return[ag.createElement(af[1])]}af=k([ah],ag);return y.merge([],af.childNodes)}})(dynamsoft.lib);(function(d){var b=Array.prototype,a=Function.prototype;if(!d.isFunction(b.indexOf)){b.indexOf=function(g,h){var f;if(this==null){return-1}var j=Object(this);var e=j.length>>>0;if(e===0){return-1}var l=+h||0;if(Math.abs(l)===Infinity){l=0}if(l>=e){return-1}f=Math.max(l>=0?l:e-Math.abs(l),0);while(f<e){if(f in j&&j[f]===g){return f}f++}return-1}}if(!d.isFunction(a.bind)){a.bind=function(g){var f=this;if(1<arguments.length){var e=b.slice.call(arguments,1);return function(){return f.apply(g,arguments.length?e.concat(b.slice.call(arguments)):e)}}return function(){return arguments.length?f.apply(g,arguments):f.call(g)}}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}})(dynamsoft.lib);(function(a){var g=a.lib,d=a.navInfo,f=window.document,b,e;e=function(j){var h=j;if(h=="mousewheel"){h=d.bGecko?"DOMMouseScroll":"mousewheel"}return h};b={addEventListener:f.addEventListener?function(j,l,k){var h=e(l);if(j){j.addEventListener(h,k,false)}}:function(j,l,k){var h=e(l);if(j){j.attachEvent("on"+h,k)}},removeEventListener:f.removeEventListener?function(j,l,k){var h=e(l);if(j){j.removeEventListener(h,k,false)}}:function(j,l,k){var h=e(l);if(j){j.detachEvent("on"+h,k)}},getWheelDelta:function(h){h=h||window.event;var l,k=h.wheelDelta,j=h.detail;if(k){l=k/120}if(j){l=-(j%3===0?j/3:j)}return l}};g.mix(g,b)})(dynamsoft);(function(a){a.Events={registedClass:[],registedObjs:[]};var b=function(f){f=f||window.event;var d=true;a.each(a.Events.registedObjs,function(e){a.each(a.Events.registedClass,function(g){if(e instanceof g){if(e.bFocus&&e.handlerKeyDown){d=e.handlerKeyDown(f);if(!d){return false}}}})});return d};a.addEventListener(document.documentElement,"keydown",b)})(dynamsoft.lib);(function(a){a.stopPropagation=function(b){var d=b||window.event;if(d.preventDefault){d.preventDefault()}if(d.stopPropagation){d.stopPropagation()}d.returnValue=false;d.cancelBubble=true}})(dynamsoft.lib);(function(b){var a={LEFT:0,MIDDLE:1,RIGHT:2};b.EnumMouseButton=a;b.detectButton=function(d){d=d||window.event;if(d.which==null){return d.button<2?a.LEFT:d.button==4?a.MIDDLE:a.RIGHT}else{return d.which<2?a.LEFT:d.which==2?a.MIDDLE:a.RIGHT}};b.fireEvent=function(d,e){var f;if(doc.createEvent){f=doc.createEvent("HTMLEvents");f.initEvent(d,TRUE,TRUE);if(e.dispatchEvent){e.dispatchEvent(f)}}else{if(doc.createEventObject){f=doc.createEventObject();f.bubbles=TRUE;f.cancelable=TRUE;e.fireEvent(d,f)}else{f=new Event(d);if(e.dispatchEvent){e.dispatchEvent(f)}}}}})(dynamsoft.lib);(function(t,e,p){var m=window,h=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,G=200,b=204,g=300,u=304,o=404,f=1223,v=500,D=-1022,F="The local service (Dynamsoft Service) is disconnected.",y="open error: ",w="send error: ",j=new t.Uri(location.href),C=j&&h.test(j.getScheme()),E=false,k=function(){try{return new m.XMLHttpRequest}catch(I){}return p},x=function(){try{var I=false;t.each(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],function(K){try{return I=new m.ActiveXObject(K)}catch(L){t.error("new xhr error: "+L.message)}});return I}catch(J){}return p},s=!C&&m.XMLHttpRequest?"withCredentials"in(k()||[]):false,B=m.ActiveXObject?function(I){if(e.bIE&&parseInt(e.strBrowserVersion)<=9){return x()}if(!s&&I&&E){return new E}return!C&&k()||x()}:k,q=function(I){return E&&I instanceof E},z={url:false,onSuccess:false,onError:false,onComplete:false,method:"GET",async:true,xhrFields:false,mimeType:false,username:false,password:false,data:false,dataType:"text",headers:false,contentType:"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:false,afterSend:false,timeout:0,crossDomain:false},n=/^(?:GET|HEAD)$/,a=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,H={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},A=t.nil,l,d;if(e.bIE&&parseInt(e.strBrowserVersion)<=10){A=t.noop}l={setRequestHeader:function(J,K){var I=this;I.headers[J]=K;return I},getAllResponseHeaders:function(){var I=this;return I.state===2?I.responseHeadersString:null},getNativeXhr:function(){var I=this;return I.nativeXhr},getResponseHeader:function(K){var J,I=this,L;K=K.toLowerCase();if(I.state===2){if(!(L=I.responseHeaders)){L=I.responseHeaders={};while(J=a.exec(I.responseHeadersString)){L[J[1].toLowerCase()]=J[2]}}J=L[K]}return J===p?null:J},overrideMimeType:function(J){var I=this;if(!I.state){I.mimeType=J}return I},abort:function(J){var I=this;J=J||"abort";if(I.nativeXhr){I.nativeXhr.abort()}I._ioReady(0,J);return I},_ioReady:function(M,K){var S=this,J;if(S.state===2){return}S.state=2;S.readyState=4;if(M>=G&&M<g||M===u){if(M===u){K="not modified";J=true}else{K="success";J=true}}else{if(M<0){M=0}}try{if(M>=G){S.handleResponseData()}}catch(O){t.error(O.stack||O,"error");K=O.message||"parser error"}S.status=M;S.statusText=K;var L=S,P;if(P=S.timeoutTimer){clearTimeout(P);S.timeoutTimer=0}var R=J?"onSuccess":"onError",N,Q=[S.responseData,K,S],I=L.context;N=L[R];if(t.isFunction(N)){N.apply(I,Q)}N=L.onComplete;if(t.isFunction(N)){N.apply(I,Q)}},handleResponseData:function(){var K=this,I,J=K.dataType,M=K.nativeXhr;if(J==="blob"||J==="arraybuffer"){I=!!m.Blob?M.response:M.responseBody}else{if(J=="json"){if(M.responseType&&M.responseType.toLowerCase()=="json"){I=M.response}else{I=M.responseText?m.JSON&&m.JSON.parse?m.JSON.parse(M.responseText):t.parse(M.responseText):{}}}else{if(J==="user-defined"){I=M.response!==p?M.response:M.responseText}else{K.responseText=I=M.responseText||"";try{var L=M.responseXML;if(L&&L.documentElement){K.responseXML=L}}catch(N){}}}}K.responseData=I},sendInternal:function(){var T=this,X=T,P,J,K,W,U,V,L,Q,O,N;J=T.method;K=T.url;W=T.dataType;L=T.mimeType;if(!t.isString(K)){return}X.nativeXhr=U=B(T.crossDomain);if(!U){return}try{X.state=1;if(T.username){U.open(J,K,T.async,T.username,T.password)}else{U.open(J,K,T.async)}if((T.async||e.bIE)&&W&&W!="user-defined"&&"responseType"in U){try{U.responseType=W}catch(R){}}}catch(S){if(X.state<2){t.error(S.stack||S,"error");X._ioReady(-1,y+(t.isNumber(S.number)?"("+S.number+")":"")+(S.message||""))}else{t.error(S)}return}V=T.xhrFields||{};if("withCredentials"in V){if(!s){delete V.withCredentials}}for(P in V){try{U[P]=V[P]}catch(R){t.error(R)}}if(L&&U.overrideMimeType){U.overrideMimeType(L)}Q=T.headers||{};var M=Q["X-Requested-With"];if(M===false){delete Q["X-Requested-With"]}if(typeof U.setRequestHeader!=="undefined"){if(T.contentType){U.setRequestHeader("Content-Type",T.contentType)}U.setRequestHeader("Accept",W&&H[W]?H[W]+(W==="*"?"":", */*; q=0.01"):H["*"]);for(P in Q){U.setRequestHeader(P,Q[P])}}O=!n.test(T.method);N=O&&T.data||null;if(O&&e.bIE&&parseInt(e.strBrowserVersion)<10){N=T.data}if(T.async&&T.timeout>0){X.timeoutTimer=setTimeout(function(){X.abort("timeout")},T.timeout*1e3)}try{X.state=1;if(t.isFunction(X.beforeSend)){var I=X.beforeSend(U,X);if(I===false){X.abort("cancel");return}}U.send(N);if(t.isFunction(X.afterSend)){X.afterSend(X)}}catch(R){if(X.state<2){t.error(R.stack||R,"error");X._ioReady(-1,w+(R.message||""))}else{t.error(R)}}if(!T.async||U.readyState===4){X._callback()}else{if(q(U)){U.onload=function(){U.readyState=4;U.status=G;X._callback()};U.onerror=function(){U.readyState=4;U.status=v;X._callback()}}else{U.onreadystatechange=function(){X._callback()}}}},_callback:function(J,O){var K=this,L=K.nativeXhr;try{if(L.readyState===4||O){if(q(L)){L.onerror=A;L.onload=A}else{L.onreadystatechange=A}if(O){if(L.readyState!==4){L.abort()}}else{if(!q(L)){K.responseHeadersString=L.getAllResponseHeaders()}var I=L.status,N;try{N=L.statusText}catch(M){t.error("xhr statusText error: ");t.error(M);N=""}K._ioReady(I,N)}}}catch(M){t.error(M.stack||M,"error");if(M.errorCode===D){throw{errorCode:D,errorString:F,toString:function(){return this.errorCode+": "+this.errorString}}}L.onreadystatechange=A;if(!O){K._ioReady(-1,M.message||"process error")}}},_setupCfg:function(M){var J=this,I,L,O,K,N;K=M.url;if(t.startsWith(K,"http://")||t.startsWith(K,"https://")){N=new t.Uri(K)}else{if(t.startsWith(K,"//")){M.url=K="http:"+K}N=j.resolve(K)}if(!M.dataType){I="text"}else{I=M.dataType.toLowerCase()}M.dataType=I;if(!M.method){M.method="GET"}else{M.method=M.method.toUpperCase()}if(!("crossDomain"in M)){M.crossDomain=!N.isSameOriginAs(j)}O=M.headers;for(L in O){if(t.isUndefined(O[L])){delete O[L]}}t.mix(J,M);J.state=1}};function r(J){var I=this;if(!J||!t.isString(J.url)){t.log("the url is error.");return}if(!(I instanceof r)){return new r(J)}t.mix(I,z);t.mix(I,l);if(J instanceof r){J=J.config}I.config=J;I.config.context=I;I._setupCfg(J);I.sendInternal()}r._strOpenErr=y;r._strSendErr=w;r._strConnectionToServiceLostString=F;d={ajax:r,io:{get:function(J,K,L,I){return new r({method:"GET",url:J,onSuccess:K,onError:L,dataType:I})},post:function(J,L,K,M,I){return new r({method:"POST",data:L,url:J,onSuccess:K,onError:M,dataType:I})},put:function(J,L,K,M,I){return new r({method:"PUT",data:L,url:J,onSuccess:K,onError:M,dataType:I})}}};t.mix(t,d)})(dynamsoft.lib,dynamsoft.navInfo);(function(j){var m=function(){var q={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t",'"':'\\"'},p={},r=/["\b\f\n\r\t\x00-\x1f]/g,o=/\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\"|\\u[0-9a-zA-Z]{4}/g;j.each(q,function(s,t){p[s]=t});p["\\/"]="/";p["\\\\"]="\\";return{quote:function(s){return'"'+s.replace(r,function(t){var u;if(!(u=q[t])){u="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(0-4)}return u})+'"'},unQuote:function(s){return s.slice(1,s.length-1).replace(o,function(t){var u;if(!(u=p[t])){u=String.fromCharCode(parseInt(t.slice(2),16))}return u})}}}();function b(o){return o<10?"0"+o:o}function k(r,q,u,s,v,p,o){var t=q[r];if(t&&typeof t==="object"){if(typeof t.toJSON==="function"){t=t.toJSON(r)}else{if(t instanceof Date){t=isFinite(t.valueOf())?t.getUTCFullYear()+"-"+b(t.getUTCMonth()+1)+"-"+b(t.getUTCDate())+"T"+b(t.getUTCHours())+":"+b(t.getUTCMinutes())+":"+b(t.getUTCSeconds())+"Z":null}else{
if(t instanceof String||t instanceof Number||t instanceof Boolean){t=t.valueOf()}}}}if(u!==undefined){t=u.call(q,r,t)}switch(typeof t){case"number":return isFinite(t)?String(t):"null";case"string":return m.quote(t);case"boolean":return String(t);case"object":if(!t){return"null"}if(j.isArray(t)){return n(t,u,s,v,p,o)}return g(t,u,s,v,p,o)}return undefined}function g(F,z,r,E,D,t){var u=t;t+=E;var v,q,x,s;if(r!==undefined){v=r}else{v=j.keys(F)}var C=[];for(x=0,q=v.length;x<q;x++){s=v[x];var o=k(s,F,z,r,E,D,t);if(o!==undefined){var w=m.quote(s);w+=":";if(E){w+=" "}w+=o;C[C.length]=w}}var A;if(!C.length){A="{}"}else{if(!E){A="{"+C.join(",")+"}"}else{var y=",\n"+t;var B=C.join(y);A="{\n"+t+B+"\n"+u+"}"}}return A}function n(B,t,p,A,z,q){var r=q;q+=A;var y=[];var v=B.length;var u=0;while(u<v){var o=k(String(u),B,t,p,A,z,q);if(o===undefined){y[y.length]="null"}else{y[y.length]=o}++u}var w;if(!y.length){w="[]"}else{if(!A){w="["+y.join(",")+"]"}else{var s="\n,"+q;var x=y.join(s);w="[\n"+q+x+"\n"+r+"]"}}return w}j.stringify=function(r,o,q){var t="";var p,s;if(o){if(typeof o==="function"){s=o}else{if(j.isArray(o)){p=o}}}if(typeof q==="number"){q=Math.min(10,q);t=new Array(q+1).join(" ")}else{if(typeof q==="string"){t=q.slice(0,10)}}return k("",{"":r},s,p,t,[],"")};var d={},e={SHIFT_TYPE:1,REDUCE_TYPE:2,ACCEPT_TYPE:0,TYPE_INDEX:0,PRODUCTION_INDEX:1,TO_INDEX:2},a;d.yy={unQuote:m.unQuote};a=function(o){var p=this;p.rules=[];j.mix(p,o);p.resetInput(p.input)};a.prototype={constructor:function(o){var p=this;p.rules=[];j.mix(p,o);p.resetInput(p.input)},resetInput:function(o){j.mix(this,{input:o,matched:"",stateStack:[a.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var o=this,p=o.stateStack[o.stateStack.length-1],q=[];p=o.mapState(p);j.each(o.rules,function(s){var t=s.state||s[3];if(!t){if(p==a.STATIC.INITIAL){q.push(s)}}else{if(j.inArray(p,t)){q.push(s)}}});return q},pushState:function(o){this.stateStack.push(o)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var q=this,s=a.STATIC.DEBUG_CONTEXT_LIMIT,o=q.matched,r=q.match,p=q.input;o=o.slice(0,o.length-r.length);var u=(o.length>s?"...":"")+o.slice(-s).replace(/\n/," "),t=r+p;t=t.slice(0,s)+(t.length>s?"...":"");return u+t+"\n"+new Array(u.length+1).join("-")+"^"},mapSymbol:function(q){var o=this,p=o.symbolMap;if(!p){return q}return p[q]||(p[q]=++o.symbolId)},mapReverseSymbol:function(p){var o=this,r=o.symbolMap,q,s=o.reverseSymbolMap;if(!s&&r){s=o.reverseSymbolMap={};for(q in r){s[r[q]]=q}}if(s){return s[p]}else{return p}},mapState:function(q){var o=this,p=o.stateMap;if(!p){return q}return p[q]||(p[q]=++o.stateId)},lex:function(){var y=this,w=y.input,r,v,o,t,z,x=y.getCurrentRules();y.match=y.text="";if(!w){return y.mapSymbol(a.STATIC.END_TAG)}for(r=0;r<x.length;r++){v=x[r];var u=v.regexp||v[1],p=v.token||v[0],q=v.action||v[2]||undefined;if(o=w.match(u)){z=o[0].match(/\n.*/g);if(z){y.lineNumber+=z.length}j.mix(y,{firstLine:y.lastLine,lastLine:y.lineNumber+1,firstColumn:y.lastColumn,lastColumn:z?z[z.length-1].length-1:y.lastColumn+o[0].length});var s;s=y.match=o[0];y.matches=o;y.text=s;y.matched+=s;t=q&&q.call(y);if(t===undefined){t=p}else{t=y.mapSymbol(t)}w=w.slice(s.length);y.input=w;if(t){return t}else{return y.lex()}}}j.error("lex error at line "+y.lineNumber+":\n"+y.showDebugInfo());return undefined}};a.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var f=new a({rules:[[2,/^"(\\"|\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\u[0-9a-zA-Z]{4}|[^\\"\x00-\x1f])*"/,0],[0,/^[\t\r\n\x20]/,0],[3,/^,/,0],[4,/^:/,0],[5,/^\[/,0],[6,/^\]/,0],[7,/^\{/,0],[8,/^\}/,0],[9,/^-?\d+(?:\.\d+)?(?:e-?\d+)?/i,0],[10,/^true|false/,0],[11,/^null/,0],[12,/^./,0]]});d.lexer=f;f.symbolMap={$EOF:1,STRING:2,COMMA:3,COLON:4,LEFT_BRACKET:5,RIGHT_BRACKET:6,LEFT_BRACE:7,RIGHT_BRACE:8,NUMBER:9,BOOLEAN:10,NULL:11,INVALID:12,$START:13,json:14,value:15,object:16,array:17,elementList:18,member:19,memberList:20};d.productions=[[13,[14]],[14,[15],function(){return this.$1}],[15,[2],function(){return this.yy.unQuote(this.$1)}],[15,[9],function(){return parseFloat(this.$1)}],[15,[16],function(){return this.$1}],[15,[17],function(){return this.$1}],[15,[10],function(){return this.$1==="true"}],[15,[11],function(){return null}],[18,[15],function(){return[this.$1]}],[18,[18,3,15],function(){this.$1[this.$1.length]=this.$3;return this.$1}],[17,[5,6],function(){return[]}],[17,[5,18,6],function(){return this.$2}],[19,[2,4,15],function(){return{key:this.yy.unQuote(this.$1),value:this.$3}}],[20,[19],function(){var o={};o[this.$1.key]=this.$1.value;return o}],[20,[20,3,19],function(){this.$1[this.$3.key]=this.$3.value;return this.$1}],[16,[7,8],function(){return{}}],[16,[7,20,8],function(){return this.$2}]];d.table={gotos:{0:{14:7,15:8,16:9,17:10},2:{15:12,16:9,17:10,18:13},3:{19:16,20:17},18:{15:23,16:9,17:10},20:{15:24,16:9,17:10},21:{19:25}},action:{0:{2:[1,0,1],5:[1,0,2],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},1:{1:[2,2,0],3:[2,2,0],6:[2,2,0],8:[2,2,0]},2:{2:[1,0,1],5:[1,0,2],6:[1,0,11],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},3:{2:[1,0,14],8:[1,0,15]},4:{1:[2,3,0],3:[2,3,0],6:[2,3,0],8:[2,3,0]},5:{1:[2,6,0],3:[2,6,0],6:[2,6,0],8:[2,6,0]},6:{1:[2,7,0],3:[2,7,0],6:[2,7,0],8:[2,7,0]},7:{1:[0,0,0]},8:{1:[2,1,0]},9:{1:[2,4,0],3:[2,4,0],6:[2,4,0],8:[2,4,0]},10:{1:[2,5,0],3:[2,5,0],6:[2,5,0],8:[2,5,0]},11:{1:[2,10,0],3:[2,10,0],6:[2,10,0],8:[2,10,0]},12:{3:[2,8,0],6:[2,8,0]},13:{3:[1,0,18],6:[1,0,19]},14:{4:[1,0,20]},15:{1:[2,15,0],3:[2,15,0],6:[2,15,0],8:[2,15,0]},16:{3:[2,13,0],8:[2,13,0]},17:{3:[1,0,21],8:[1,0,22]},18:{2:[1,0,1],5:[1,0,2],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},19:{1:[2,11,0],3:[2,11,0],6:[2,11,0],8:[2,11,0]},20:{2:[1,0,1],5:[1,0,2],7:[1,0,3],9:[1,0,4],10:[1,0,5],11:[1,0,6]},21:{2:[1,0,14]},22:{1:[2,16,0],3:[2,16,0],6:[2,16,0],8:[2,16,0]},23:{3:[2,9,0],6:[2,9,0]},24:{3:[2,12,0],8:[2,12,0]},25:{3:[2,14,0],8:[2,14,0]}}};d.parse=function h(y){var A=this,o=A.lexer,t,F,E,I=A.table,B=I.gotos,s=I.action,r=A.productions,u=[null],v=[0];o.resetInput(y);while(1){t=v[v.length-1];if(!F){F=o.lex()}if(!F){j.log("it is not a valid input: "+y,"error");return false}E=s[t]&&s[t][F];if(!E){var w=[],D;if(s[t]){j.each(s[t],function(L,M){w.push(A.lexer.mapReverseSymbol(M))})}D="Syntax error at line "+o.lineNumber+":\n"+o.showDebugInfo()+"\nexpect "+w.join(", ");j.log(D);return false}switch(E[e.TYPE_INDEX]){case e.SHIFT_TYPE:v.push(F);u.push(o.text);v.push(E[e.TO_INDEX]);F=null;break;case e.REDUCE_TYPE:var J=r[E[e.PRODUCTION_INDEX]],z=J.symbol||J[0],q=J.action||J[2],C=J.rhs||J[1],H=C.length,G=0,K,x=u[u.length-H];A.$$=x;K=undefined;for(;G<H;G++){A["$"+(H-G)]=u[u.length-1-G]}if(q){K=q.call(A)}if(K!==undefined){x=K}else{x=A.$$}if(H){v=v.slice(0,-1*H*2);u=u.slice(0,-1*H)}v.push(z);u.push(x);var p=B[v[v.length-2]][v[v.length-1]];v.push(p);break;case e.ACCEPT_TYPE:return x}}return undefined};j.parser=d;function l(w,o,x){var s=w[o],t,v,u;if(typeof s==="object"){if(j.isArray(s)){t=0;v=s.length;var r=[];while(t<v){u=l(s,String(t),x);if(u!==undefined){r[r.length]=u}}s=r}else{var y=j.keys(s);for(t=0,v=y.length;t<v;t++){var q=y[t];u=l(s,q,x);if(u===undefined){delete s[q]}else{s[q]=u}}}}return x.call(w,o,s)}j.parse=function(s,o){var r=window,q=r.JSON;if(q&&q.parse){return q.parse(String(s))}var p=d.parse(String(s));if(o){return l({"":p},"",o)}else{return p}}})(dynamsoft.lib);(function(n,m){var j=window,p=document,e=!0,l=!1,q={},k=m.bIE&&m.IEMode<8,r=k&&m.IEMode<7,s=5e5,f=1e3,b=function(t){var w,v,u;w=p.body.scrollTop||p.documentElement.scrollTop;if(j.innerHeight){u=j.innerHeight}else{u=p.documentElement.clientHeight}v=w+(u-t.offsetHeight)/2;t.style.top=v+"px";t._dlgInfo.isTopOverridden=e},o=function(t,v){for(var u=0;u<t.length;++u){if(t[u]==v){return e}}return l},d=function(w){for(var x=0;x<p.styleSheets.length;++x){var C=p.styleSheets[x],z=l,u=l,B,D;try{z=C.cssRules;u=p.querySelectorAll}catch(y){}if(z&&u){for(var v=0;v<z.length;++v){B=z[v];D=l;try{D=u(B.selectorText)}catch(y){}if(D&&o(D,w)){var t=B.style.getPropertyValue("top"),A=B.style.getPropertyValue("bottom");if(t&&t!="auto"||A&&A!="auto"){return e}}}}}return l},a=function(u){var t=l;if(j.getComputedStyle){t=j.getComputedStyle(u)}else{if(u.currentStyle){t=u.currentStyle}}if(t&&t.position!="absolute"){return l}if(u.style.top!="auto"&&u.style.top!=""||u.style.bottom!="auto"&&u.style.bottom!=""){return l}return!d(u)};q.showDialog=function(y){var z=this,v;if(z.open){n.error("showDialog called on open dialog.");return}z.open=e;z.setAttribute("open","open");if(k){v=r?p.body:p.documentElement;z._dlgInfo.docOverflow=v.style.overflow;v.style.overflow="hidden"}if(a(z)){b(z)}if(y){z._dlgInfo.modal=e;q.dm.pushDialog(z);if(k){var u,t,x=l,w=l;u=z.currentStyle.left;t=z.currentStyle.top;if(u==="auto"){if(r){z.style.textAlign="center"}u=(v.clientWidth-z.currentStyle.width)/2}else{if(u.indexOf("%")>0){x=u;u=Number(u.replace("%","")*v.clientWidth/100)}else{u=Number(u.replace("px",""))}}if(!(u>0)){u=0}if(t==="auto"){t=(v.clientHeight-z.currentStyle.height)/2}else{if(t.indexOf("%")>0){w=t;t=Number(t.replace("%","")*v.clientHeight/100)}else{t=Number(t.replace("px",""))}}if(!(t>0)){t=0}setTimeout(function(){var B=z.style,A=z._dlgInfo.mask;A.style.backgroundColor="#000";A.style.filter="alpha(opacity=30)";B.position="absolute";B.left=u+"px";B.top=t+"px"},0);z._scrollFn=function(){var B=v.scrollTop+"px",E=v.scrollLeft+"px",A=q.dm.overlay,D=z._dlgInfo.mask,C=z.style;if(t+v.scrollTop+v.clientHeight<v.scrollHeight){C.top=t+v.scrollTop+"px"}else{C.top=B}if(A){A.style.top=B}if(D){D.style.top=B}C.left=E;if(A){A.style.left=E}if(D){D.style.left=E}setTimeout(function(){z._resizeFn()},100)};z._resizeFn=function(){var E=r?p.body:p.documentElement,C=E.clientWidth+"px",D=E.clientHeight+"px",A=q.dm.overlay,B=z._dlgInfo.mask;A.style.width=C;if(B){B.style.width=C}A.style.height=D;if(B){B.style.height=D}setTimeout(function(){var G,I,F=z.style,H=r?p.body:p.documentElement;if(x){G=Number(x.replace("%","")*H.clientWidth/100);F.left=G+"px"}if(w){I=Number(w.replace("%","")*H.clientHeight/100);F.top=I+"px"}},0)};z._scrollFn();j.attachEvent("onscroll",z._scrollFn);j.attachEvent("onresize",z._resizeFn)}}};q.closeDialog=function(t){var v=this;if(!v.open){n.error("closeDialog called on closed dialog.")}v.open=l;v.removeAttribute("open");if(k){var u=r?p.body:p.documentElement;u.style.overflow=v._dlgInfo.docOverflow}if(typeof t!="undefined"){v.returnValue=t}if(v._dlgInfo.isTopOverridden){v.style.top="auto"}if(v._dlgInfo.modal){if(k){j.detachEvent("onscroll",v._scrollFn);j.detachEvent("onresize",v._resizeFn)}q.dm.removeDialog(this)}return v.returnValue};q.createMouseEvent=function(u){var t=p.createEvent("MouseEvents");t.initMouseEvent(u.type,u.bubbles,u.cancelable,j,u.detail,u.screenX,u.screenY,u.clientX,u.clientY,u.ctrlKey,u.altKey,u.shiftKey,u.metaKey,u.button,u.relatedTarget);return t};q.setup=function(t){var u=this;t.show=u.showDialog.bind(t,l);t.showModal=u.showDialog.bind(t,e);t.close=u.closeDialog.bind(t);t._dlgInfo={}};var h=function(){var u=this,t;u.pendingDialogStack=[];u.overlay=p.createElement(k?"iframe":"div");t=u.overlay.style;t.position=k?"absolute":"fixed";t.display="block";t.left=t.top=t.margin=t.padding=0;t.backgroundColor="#000";t.filter="alpha(opacity=30)";t.opacity=t.MozOpacity=.3;t.zIndex=s;t.width="100%";if(k&&p.documentElement.clientHeight>0){t.height=p.documentElement.clientHeight+"px"}else{t.height="100%"}if(p.createEvent){n.addEventListener(u.overlay,"click",function(v){var w=q.createMouseEvent(v);p.body.dispatchEvent(w)})}},g=h.prototype;g._blockDocument=function(){if(!p.body.contains(this.overlay)){p.body.appendChild(this.overlay)}};g._unblockDocument=function(){p.body.removeChild(this.overlay)};g._updateStacking=function(){var x=this,t,v,u,w;v=x.pendingDialogStack;if(v.length==0){x._unblockDocument();return}x._blockDocument();w=s;n.each(v,function(y){w++;y._dlgInfo.mask.style.zIndex=w++;y.style.zIndex=w})};g.pushDialog=function(u){var v=this,t;if(v.pendingDialogStack.length>=f){n.error("Too many modal dialogs.");return}t=p.createElement("div");t.className="dynamsoft-backdrop";if(k){t.style.position="absolute"}if(p.createEvent){n.addEventListener(t,"click",function(w){if(u.dispatchEvent){var x=q.createMouseEvent(w);u.dispatchEvent(x)}})}u.parentNode.insertBefore(t,u.nextSibling);u._dlgInfo.mask=t;v.pendingDialogStack.push(u);v._updateStacking()};g.removeDialog=function(v){var w=this,u,t;u=n.isArray(w.pendingDialogStack)?w.pendingDialogStack.indexOf(v):-1;if(u==-1){return}w.pendingDialogStack.splice(u,1);t=v._dlgInfo.mask;t.parentNode.removeChild(t);v._dlgInfo.mask=null;w._updateStacking()};q.dm=new h;n.dialog=q})(dynamsoft.lib,dynamsoft.navInfo);(function(d,e){d.navInfo=dynamsoft.navInfo;d._uiMaxSize=1e5;d.resourcesPath=d.resourcesPath||"DCSResources";d._dwsObjClientIdPrefix="dwsObject_";d._imgViewerClientIdPrefix="imageViewer_";d._dcoEditorClientIdPrefix="documentEditor_";d._getInstallPackageUrl=function(){if(d.navInfo.bWin){return d.resourcesPath+"/DynamsoftServiceSetup.exe"}else{if(d.navInfo.bMac){return d.resourcesPath+"/DynamsoftServiceSetup.pkg"}}return""};d._getProductKey=function(){return e.isString(d.productKey)?d.productKey:""};var a="6, 0, 0, 0718";var b=4;d._getFrontendSdkVersion=function(){return a};d._getFrontendSdkVersionWithDot=function(){var f=a;f=f.split(",").join(".");return f.split(" ").join("")};d._getFrontendSdkVersionWithoutComma=function(){var f=a;f=f.split(",").join("");return f.split(" ").join("")};d._getVersionStrForCommand=function(){var f=d._getFrontendSdkVersionWithoutComma();return["dcs/dcs_",d.bTrial?"trial_":"",f].join("")};d._enumSdkVersionComparisonResult={Unknown:0,Equal:1,FrontendHigher:2,BackendHigher:3,FrontendMiniVersionHigher:4,BackendMiniVersionHigher:5};d._getVersionInfoAry=function(f){if(!e.isString(f)){return null}var h=",";var j=f.split(h);if(isNaN(parseInt(j[0]))){return null}for(var g=0;g<b;g++){j[g]=parseInt(j[g]);if(isNaN(j[g])){j[g]=0}}return j};d._getSdkVersionComparisonResult=function(h){var k=d._enumSdkVersionComparisonResult,j=d._getVersionInfoAry(d._getFrontendSdkVersion()),l=d._getVersionInfoAry(h),f=k.Unknown;if(j===null||l===null){return f}if(j[0]>l[0]){f=k.FrontendHigher}else{if(j[0]<l[0]){f=k.BackendHigher}else{for(var g=1;g<b;g++){if(j[g]>l[g]){f=k.FrontendMiniVersionHigher;break}else{if(j[g]<l[g]){f=k.BackendMiniVersionHigher;break}}}}}if(f===k.Unknown){f=k.Equal}return f}})(dynamsoft.dcsEnv,dynamsoft.lib);dynamsoft.lib.ready(function(){dynamsoft.lib.install={_divInstallBody:"dwt-InstallBody",_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:false,bNeedUpgrade:false};dynamsoft.lib.install._strDynamsoftWithClose=['<div style="height:40px;width:350px;position:relative;">','<span><div class="DYNLogo" ','alt="Dynamsoft Corporation" border="0"></div>',"</span>",'<div style="height:30px;padding-left:205px; position:absolute; top:0; left:120px">','<a href="javascript: void(0)" style="text-decoration:none; padding:15px" class="ClosetblCanNotScan">X</a>',"</div></div>"].join("");dynamsoft.lib.install._strNonInstallDIV=['<div style="border:1px solid #CCCCCC;text-align:center;" id="',dynamsoft.lib.install._divDWTNonInstallContainerID,'"></div>'].join("")});function dynamsoft_onClickInstallButton(){var a=dynamsoft.lib.get("dwt-btn-install");if(a){a.style.display="none"}}dynamsoft.dcsEnv.showInstallDialog=function(b){var a;if(!b){a=['<div class="dwt-box-title"></div>','<div style="font-size: 14px;">',"This page is using a newer version of Dynamsoft Camera SDK than your local copy. Please download and upgrade now.","</div>",'<a id="dwt-btn-install" target="_blank" href="',dynamsoft.dcsEnv._getInstallPackageUrl(),'" onclick="dynamsoft_onClickInstallButton()"><div class="dwt-button"></div></a>','<div style="text-align:center"><i>* Please manually install it</i></div><p></p>']}else{a=['<div class="dwt-box-title">',"Dynamsoft Camera SDK ",parseInt(dynamsoft.dcsEnv._getFrontendSdkVersion())," is not installed</div>",'<div style="margin:20px;text-align:center"><a id="dwt-btn-install" target="_blank" href="',dynamsoft.dcsEnv._getInstallPackageUrl(),"",'" onclick="dynamsoft_onClickInstallButton()"><div class="dwt-button"></div></a>',"<i>* Please manually install it</i></div>"]}a.push("<div>");a.push("If you still see the dialog after the installation,<br />");a.push('please check <a target="_blank" href="http://developer.dynamsoft.com/dws/why-is-the-browser-prompting-me-to-install-dynamsoft-webcam-service-repeatedly">this article</a> for troubleshooting.');a.push("</div>");if(dynamsoft.dcsEnv.navInfo.bFirefox&&dynamsoft.dcsEnv.navInfo.bSSL){a.push('<div class="dwt-red" style="padding-top: 10px;">After installation, please RESTART your browser.</div>')}dynamsoft.dcsEnv.ShowDialog(392,230,a.join(""))};dynamsoft.dcsEnv.ShowDialog=function(e,g,h,a){var k,j=dynamsoft.lib.get("J_waiting");if(j){j.parentNode.removeChild(j)}var b=document.createElement("div");b.className="ds-dialog-wrap";b.style.width="100%";if(a){k=['<div id="J_waiting" class="ds-dialog" style="width:455px;">','<div class="ks-dialog-header"></div>','<div class="ks-dialog-body">','<div class="ks-dialog-content"><div id="',dynamsoft.lib.install._divInstallBody,'"></div></div></div>','<div class="ks-dialog-footer"></div>',"</div>"]}else{k=['<div id="J_waiting" class="ds-dialog">','<div class="ks-dialog-header"></div>','<div class="ks-dialog-body">','<div class="ks-dialog-content"><div id="',dynamsoft.lib.install._divInstallBody,'"></div></div></div>','<div class="ks-dialog-footer"></div>',"</div>"]}b.innerHTML=k.join("");if(a){var d=dynamsoft.lib.one(".D_ImageUIEditor")[0].parentNode;d.appendChild(b)}else{document.body.appendChild(b)}dynamsoft.lib.install._dlgFromImageEditor=a;dynamsoft.lib.install._dlgInstall=b;dynamsoft.lib.dialog.setup(dynamsoft.lib.install._dlgInstall);if(h===false){return}if(a){dynamsoft.lib.get(dynamsoft.lib.install._divInstallBody).innerHTML=['<div class="ds-dialog-body" style="height:'+g+"px;width:"+e+'px">',h,"</div>"].join("")}else{dynamsoft.lib.get(dynamsoft.lib.install._divInstallBody).innerHTML=['<div class="ds-dialog-body" style="height:'+g+'px">',dynamsoft.lib.install._strDynamsoftWithClose,h,"</div>"].join("")}j=dynamsoft.lib.get("J_waiting");j.style.width=e;dynamsoft.lib.install._dlgInstall.showModal();for(var f=0;f<document.links.length;f++){if(document.links[f].className=="ClosetblCanNotScan"){document.links[f].onclick=Dynamsoft__OnclickCloseInstallEx}}};dynamsoft.dcsEnv.OnDwsPreExecute=function(){dynamsoft.lib.detect.OnDwsPreExecute()};dynamsoft.dcsEnv.OnDwsPostExecute=function(){dynamsoft.lib.detect.OnDwsPostExecute()};function Dynamsoft__OnclickCloseInstallEx(a){var g=a||window.event;if(g){dynamsoft.lib.stopPropagation(g)}if(!dynamsoft.lib.install){return}var f=dynamsoft.lib.install._dlgInstall;if(f){f.close();if(dynamsoft.lib.install._dlgFromImageEditor){var d=dynamsoft.lib.one(".D_ImageUIEditor")[0].parentNode;d.removeChild(f)}else{document.body.removeChild(f)}dynamsoft.lib.install._dlgInstall=false}dynamsoft.lib.install.bNeedUpgrade=false;var b=dynamsoft.lib.get(dynamsoft.lib.install._divDWTNonInstallContainerID);if(b){b.parentNode.removeChild(b)}}(function(){dynamsoft.lib.mix(dynamsoft.lib.detect,{global_dlg:false,__dialog:false});dynamsoft.lib.detect.showMask=function(){if(!dynamsoft.dcsEnv.ScanDirectly){if(dynamsoft.lib.isFunction(OnDwsPreExecuteCallback)){OnDwsPreExecuteCallback()}else{dynamsoft.lib.detect.OnDwsPreExecute()}}};dynamsoft.lib.detect.OnDwsPreExecute=function(){if(dynamsoft.lib.detect.__dialog){return}var d=[dynamsoft.dcsEnv.resourcesPath,"/reference/loading.gif"].join(""),b=['<div style="margin:0 auto;width:100px;line-height:300px"><img src="',d,'" /></div>'].join("");var a=document.createElement("div");a.className="ds-dialog-wrap";a.innerHTML=b;document.body.appendChild(a);dynamsoft.lib.detect.__dialog=a;dynamsoft.lib.dialog.setup(dynamsoft.lib.detect.__dialog);dynamsoft.lib.detect.__dialog.showModal()};dynamsoft.lib.detect.hideMask=function(){if(!dynamsoft.dcsEnv.ScanDirectly){if(dynamsoft.lib.isFunction(OnDwsPostExecuteCallback)){OnDwsPostExecuteCallback()}else{dynamsoft.lib.detect.OnDwsPostExecute()}}};dynamsoft.lib.detect.OnDwsPostExecute=function(){var a=dynamsoft.lib.detect.__dialog;if(a){a.close();document.body.removeChild(a);dynamsoft.lib.detect.__dialog=false}}})();(function(e){if(dynamsoft.dcp){return}var d=dynamsoft.navInfo,b,a={bConnected:false,curPortIndex:0,bTrial:true,bConnectNumLimited:true,IMAXCONNECTCOUNT:2};dynamsoft.dcp=b={ip:"127.0.0.1",ports:[[18625,18626],[18993,18994]],sdkVersion:[13,0,0,"0404"],detect:a,versionInfo:function(k){var j=0,g=function(o,m){var l=[b._getPreUrl(a.curPortIndex),b._getModuleName(),b._getModuleVer(),"/VersionInfo?ts=",e.now()].join(""),n=e.stringify({id:"1",method:"VersionInfo",version:"dwasm_"+b.sdkVersion.join(""),parameter:[]});e.ajax({method:"POST",url:l,data:n,onSuccess:o,onError:m})},h=function(l,m){++j;a.curPortIndex=j%b.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&j>=a.IMAXCONNECTCOUNT){if(e.isFunction(k)){setTimeout(function(){k(l,m)},0)}return}setTimeout(function(){g(f,h)},1e3)},f=function(n){var m=b._getJSON(n);if(m&&"result"in m){m=m.result;if(e.isArray(m)&&m.length>1&&m[0]&&m[1]){var l=m[0].split(","),o=m[1].toLowerCase();if(b._isCompitable(l,b.sdkVersion)){a.bTrial=o.indexOf("trial")>=0;a.curPort=b.ports[j%b.ports.length];a.bConnected=true;if(e.isFunction(k)){setTimeout(k,0);return}}}}setTimeout(h,1e3)};g(f,h)},loadZip:function(f,j,h,k){var g=[b._getPreUrl(a.curPortIndex),b._getModuleName(),b._getModuleVer(),"/LoadZipFromBytes?ts=",e.now()].join("");new e.ajax({method:"POST",url:g,async:true,data:f,mimeType:"text/plain; charset=x-user-defined",onSuccess:h,onError:k})},_getPreUrl:function(h){var f,g;if(d.bSSL){g="https://";f=b.ports[h][1]}else{g="http://";f=b.ports[h][0]}return[g,b.ip,":",f,"/"].join("")},_isCompitable:function(g,f){return g.length>3&&g[0]==f[0]&&g[1]==f[1]},_getJSON:function(f){return f?e.parse(f):!1},_getModuleName:function(){return"dcp/dwasm_"},_getModuleVer:function(){return b.sdkVersion.join("")}}})(dynamsoft.lib);(function(e,a,d){a.IE_PERMISSION_DENIED_Err_Code=-2146828218;a.IE_Unknown_Err_Code=-2147024891;a.IP="127.0.0.1";a.IMAXCONNECTCOUNT=6;a.bConnectNumLimited=true;a.sdkVersionComparisonResult=d._enumSdkVersionComparisonResult.Unknown;a.isFullVersion=!1;a.portInfo={nonSslPorts:[18646,18987],sslPorts:[18647,18988]};a.orgPortInfo={nonSslPorts:[18620,18991],sslPorts:[18621,18992]};a.preUrl=[d.navInfo.bSSL?"https":"http","://",a.IP,":"].join("");a.sendCommand=function(n,l,h,m,j,f,g,k){n=n||"POST";l=l||null;h=h||[a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",e.now()].join("");m=m||function(){};j=j||function(){};f=f||"json",k=k||0;e.ajax({method:n,data:l,url:h,onSuccess:m,onError:j,dataType:f,async:g,timeout:k})};a.asyncGetServiceInfo=function(g,h,n,f){var p=0,j=0,m=d.navInfo.bSSL?a.portInfo.sslPorts:a.portInfo.nonSslPorts;f=e.isNumber(f)?f:a.IMAXCONNECTCOUNT;var k=function(r){if(a.isValidResponseValue(r)&&e.isArray(r.result)){var q=r.result[0];a.sdkVersionComparisonResult=d._getSdkVersionComparisonResult(q);if(a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.Equal){a.portInfo.curPort=m[p%m.length];a.bConnected=true;a.isFullVersion=!!r.result[1];if(e.isFunction(g)){setTimeout(function(){g()},0)}return}else{a.bConnected=false;if(e.isFunction(h)){setTimeout(function(){h()},0)}return}}else{o()}},o=function(){++p;a.bConnected=false;if(a.bConnectNumLimited&&p>=f){if(e.isFunction(h)){setTimeout(function(){h()},0)}return}j=p%m.length;setTimeout(function(){l([a.preUrl,m[j],"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join(""),k,o)},n&&e.isNumber(n)?n:0)},l=function(q,s,r){a.sendCommand("GET",null,q,s,r,"json",!0,.5)};l([a.preUrl,m[j],"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join(""),k,o)};a.getSessionIdSync=function(){if(e.isString(a.sessionId)){return a.sessionId}var g={method:"GetSessionId",parameter:[a.getSessionTimeout()]},f=function(j){if(a.isValidResponseValue(j)&&e.isArray(j.result)&&e.isString(j.result[0])){a.sessionId=j.result[0]}else{a.sessionId=null}},h=function(){a.sessionId=null};a.sendCommand("POST",e.stringify(g),[a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",(new Date).getTime()].join(""),f,h,"json",!1);return a.sessionId};a.checkServiceConnection=function(f,p){var m=d.navInfo.bSSL?a.portInfo.sslPorts:a.portInfo.nonSslPorts,k=a.bConnected&&a.portInfo.curPort?a.portInfo.curPort:m[0],q=m.indexOf(k)+1,g=[a.preUrl,k,"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join(""),o=false,n=function(s){if(a.isValidResponseValue(s)&&e.isArray(s.result)){var r=s.result[0];a.sdkVersionComparisonResult=d._getSdkVersionComparisonResult(r);if(a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.Equal||a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.FrontendMiniVersionHigher||a.sdkVersionComparisonResult===d._enumSdkVersionComparisonResult.BackendMiniVersionHigher){a.isFullVersion=!!s.result[1];a.portInfo.curPort=k;if(!e.isString(a.sessionId)){a.sessionId=a.getSessionIdSync()}if(e.isString(a.sessionId)){o=true}else{j()}}else{j()}}else{j()}},h=function(r,s){j();if(p&&d.navInfo.bIE&&parseInt(d.navInfo.strBrowserVersion)<=9&&e.isString(s)&&(s.toLowerCase().indexOf("denied")!==-1||s.toLowerCase().indexOf(a.IE_PERMISSION_DENIED_Err_Code)!==-1||s.toLowerCase().indexOf(a.IE_Unknown_Err_Code)!==-1)){p.bNeedAddToLocalIntranet=true}},j=function(){a.isFullVersion=false;a.portInfo.curPort=undefined;o=false};f=e.isNumber(f)&&f>0?f:1;for(var l=0;l<f;l++){a.sendCommand("GET",null,g,n,h,"json",!1,.5);if(o){break}else{k=m[(q+l)%m.length];g=[a.preUrl,k,"/",d._getVersionStrForCommand(),"/GetServiceInfo?ts=",e.now()].join("")}}return o};a.getInitInfo=function(k,h){var f=undefined,j=function(l){f=l},g=function(l,n,m){a.sendCommand("GET",null,l,n,m,"json",!1)};if(!a.bConnected||!a.portInfo.curPort||!a.sessionId){return f}else{g([a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/init?session=",a.sessionId,"&object=",k,"&imageviewer=",h,"&lang=",d._lang,"&ts=",e.now()].join(""),j,j)}return f};a.postSyncCommand=function(p,k,n,l,h){var g=!1,f="POST",o="json",j=!1,m=function(s,r){if(a.isValidResponseValue(s)){if(e.errorInfo.isUnknownCode(s.exception)){s.description=e.errorInfo.getUnknownString(s.exception,s.description);s.exception=EnumDCS_ErrorCode.Unknown}if((s.exception===EnumDCS_ErrorCode.ConnectionToServiceReset||s.exception===EnumDCS_ErrorCode.CameraOccupied)&&e.isString(s.description)){s.description=s.description.replace("Webcam","Camera")}if(s.exception==0){if(e.isFunction(n)){n(s)}g=!0}else{if(p instanceof e.sdk.DcsObject){if(s.exception===e.errorInfo.getLicenseVerificationFailedCode()&&s.result){p._setErrCodeErrString(s.exception,s.result[1]);if(!a.isFullVersion&&s.result[0]!==1&&e.isFunction(n)){n(s)}}else{p._setErrCodeErrString(s.exception,s.description)}}if(!(s.exception===e.errorInfo.getLicenseVerificationFailedCode()&&!a.isFullVersion&&s.result&&s.result[0]!==1)&&e.isFunction(l)){l()}g=!1}}else{if(e.isString(r)&&p instanceof e.sdk.DcsObject&&(r.toLowerCase()==="maximum call stack size exceeded"||r.toLowerCase()==="out of memory")){p._setErrCodeErrString(e.errorInfo.getConversionFailedCode(),e.errorInfo.getConversionFailedString());g=!1}}},q=function(r,s){if(p instanceof e.sdk.DcsObject){if(d.navInfo.bIE&&parseInt(d.navInfo.strBrowserVersion)<=9&&e.isString(s)&&(s.toLowerCase().indexOf("denied")!==-1||s.toLowerCase().indexOf(a.IE_PERMISSION_DENIED_Err_Code)!==-1||s.toLowerCase().indexOf(a.IE_Unknown_Err_Code)!==-1)){p._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString())}else{a.throwServiceNotConnectException(p)}}if(e.isFunction(l)){l()}g=!1};h=h||[a.preUrl,a.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",e.now()].join("");k=k||null;a.sendCommand(f,k,h,m,q,o,j);return g};a.sendRemoveObjectCommand=function(g){var f={session:a.sessionId,object:g,method:"RemoveObject"};a.sendCommand("POST",e.stringify(f),null,null,null,"json",!0)};a.bIsSendingHeartBeat=false;var b=0;a.sendHeartBeatCommand=function(f){if(a.getSessionTimeout()==0){return}if(a.bIsSendingHeartBeat&&f){return}if(!a.bConnected){a.bIsSendingHeartBeat=false;return}if(!e.isString(a.sessionId)){a.bIsSendingHeartBeat=false;return}var g={session:a.sessionId,method:"HeartBeat"};a.bIsSendingHeartBeat=true;a.sendCommand("POST",e.stringify(g),null,function(){setTimeout(a.sendHeartBeatCommand,1e3);b=0},function(){b+=1;if(b<a.IMAXCONNECTCOUNT){setTimeout(a.sendHeartBeatCommand,1e3)}else{a.bIsSendingHeartBeat=false}},null,true)};a.isValidResponseValue=function(f){if(!f||!e.isObject(f)||!e.isNumber(f.exception)||!e.isString(f.description)){return false}return true};a.setServiceNotConnectErroInfo=function(f){a.bConnected=false;if(f instanceof e.sdk.DcsObject){f._setErrCodeErrString(e.errorInfo.getConnectionToServiceLostCode(),e.errorInfo.getConnectionToServiceLostString())}};a.throwServiceNotConnectException=function(f){a.setServiceNotConnectErroInfo(f);throw{errorCode:e.errorInfo.getConnectionToServiceLostCode(),errorString:e.errorInfo.getConnectionToServiceLostString(),toString:function(){return this.errorCode+": "+this.errorString}}};a.handleImageLoadingError=function(h,g){if(!h||!e.isString(g)){return}var f=function(k){if(a.isValidResponseValue(k)){h._setErrCodeErrString(k.exception,k.description)}},j=function(){a.setServiceNotConnectErroInfo(h)};a.sendCommand("GET",null,g,f,j,"json",!1)};a.getSessionTimeout=function(){var h=dynamsoft.dcsEnv.sessionTimeout,f=((0|1<<31)>>>0)-1,g=5;if(!e.isNumber(h)){h=20*60}h=Math.round(h);if(h>f){h=f}if(h>0&&h<g){h=g}if(h<0){h=0}return h};a.enumDownloadDcsModuleStatus={idle:0,downloading:1,success:2,fail:3};a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.idle;a.dcsModuleBinary=null;a.downloadDcsModule=function(g,f){var h=function(){var n;if(d.navInfo.bMac){n="MacDCS_"}else{n="WinDCS_"}var m=[d.resourcesPath,"/",n,d._getFrontendSdkVersionWithDot(),".zip","?ts=",e.now()].join(""),l=function(p){a.dcsModuleBinary=p;a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.success},o=function(){a.dcsModuleBinary=null;a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.fail};a.downloadDcsModuleStatus=a.enumDownloadDcsModuleStatus.downloading;var k={method:"GET",url:m,dataType:"blob",onSuccess:l,onError:o,async:true};if(d.navInfo.bIE&&parseInt(d.navInfo.strBrowserVersion)<10){k.contentType="text/plain; charset=x-user-defined";k.mimeType="text/plain; charset=x-user-defined";k.headers={"Accept-Charset":"x-user-defined"}}else{k.xhrFields={responseType:d.navInfo.bSafari?"arraybuffer":"blob"}}e.ajax(k)},j=function(){var k=setInterval(function(){if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.success){clearInterval(k);if(e.isFunction(g)){g()}}else{if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.fail){clearInterval(k);if(e.isFunction(f)){f()}}}},1e3)};if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.idle||a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.fail){h();j()}else{if(a.downloadDcsModuleStatus===a.enumDownloadDcsModuleStatus.downloading){j()}else{if(e.isFunction(g)){g()}}}};a.checkOrgServiceConnection=function(f,l){var j=1,n=d.navInfo.bSSL?a.orgPortInfo.sslPorts:a.orgPortInfo.nonSslPorts,g=[a.preUrl,n[0],"/GetServiceInfo?ts=",e.now()].join(""),h=function(){if(e.isFunction(f)){f()}},m=function(){j++;if(j>n.length){if(e.isFunction(l)){l()}}else{setTimeout(function(){k([a.preUrl,n[1],"/GetServiceInfo?ts=",e.now()].join(""),h,m)},500)}},k=function(p,q,o){a.sendCommand("GET",null,p,q,o,"json",!0,.5)};k(g,h,m)};a.asyncConnDcpUnitlReady=function(f){dynamsoft.dcp.versionInfo(function(){if(dynamsoft.dcp.detect.bConnected){if(e.isFunction(f)){setTimeout(f,0);return}}else{a.asyncConnDcpUnitlReady(f)}})}})(dynamsoft.lib,dynamsoft.lib.detect,dynamsoft.dcsEnv);
var EnumDCS_ErrorCode={OK:0,ParameterNumberUnmatched:-1001,TypeNotValid:-1002,ObjectNotExist:-1018,ContainerTypeNotValid:-1013,ContainerIdNotValid:-1014,ObjectOccupied:-1020,ValueOutOfRange:-1003,ValueNotValid:-1008,BufferIsFull:-1017,OperationSequenceError:-1024,ConnectionToServiceLost:-1022,AccessDenied:-1021,CameraNotFound:-1004,StateNotCorrect:-1005,CameraOccupied:-1006,OperationNotSupported:-1007,CameraNotAuthorized:-1009,MultipageNotSupported:-1010,AsyncTaskNotCompleted:-1011,HttpError:-1012,LicenseVerificationFailed:-1015,OperationOutOfMemory:-1016,ObjectExists:-1019,ConnectionToServiceReset:-1023,DataFormatInvalid:-1025,JPEGCompressionError:-1026,OperationCancelled:-1027,SessionNotFound:-2597,CameraDisconnected:-2792,ConversionFailed:-1028,Unknown:-3001,DownloadDcsModuleFailed:-4001,SendDcsModuleFailed:-4002,ConnectDcsModuleFailed:-4003,DocumentNotExist:-1028,DocumentUndetected:-1029};(function(a){var b={isUnknownCode:function(d){if(d===EnumDCS_ErrorCode.Unknown){return true}for(var e in EnumDCS_ErrorCode){if(EnumDCS_ErrorCode[e]===d){return false}}return true},getOkCode:function(){return EnumDCS_ErrorCode.OK},getOkString:function(){return"Successful."},getParameterNumberUnmatchedCode:function(){return EnumDCS_ErrorCode.ParameterNumberUnmatched},getParameterNumberUnmatchedString:function(d){return d?"One or more parameters are missing.":"There are too many parameters."},getTypeNotValidCode:function(){return EnumDCS_ErrorCode.TypeNotValid},getTypeNotValidString:function(e,d){return["The type of ",d?"event ":"parameter ",e," is invalid."].join("")},getObjectNotExistCode:function(){return EnumDCS_ErrorCode.ObjectNotExist},getObjectNotExistString:function(d){return["The object ",d," does not exist."].join("")},getContainerTypeNotValidCode:function(){return EnumDCS_ErrorCode.ContainerTypeNotValid},getContainerTypeNotValidString:function(d){return["The ",d?d=="document"?"document editor":"image viewer":"video stream"," container must be a DIV element."].join("")},getContainerIdNotValidCode:function(){return EnumDCS_ErrorCode.ContainerIdNotValid},getContainerIdNotValidString:function(){return"The IDs for the video stream container and the image viewer container can not be the same."},getObjectOccupiedCode:function(){return EnumDCS_ErrorCode.ObjectOccupied},getObjectOccupiedString:function(d){return["The object ",d," is occupied."].join("")},getValueOutOfRangeCode:function(){return EnumDCS_ErrorCode.ValueOutOfRange},getValueOutOfRangeString:function(d){return["The value of parameter ",d," is out of range."].join("")},getValueNotValidCode:function(){return EnumDCS_ErrorCode.ValueNotValid},getValueNotValidString:function(d){return["The value of parameter ",d," is invalid."].join("")},getBufferIsFullCode:function(){return EnumDCS_ErrorCode.BufferIsFull},getBufferIsFullString:function(d){return["The ",d?d=="document"?"document":"image":"image"," buffer is full."].join("")},getOperationSequenceErrorCode:function(){return EnumDCS_ErrorCode.OperationSequenceError},getOperationSequenceErrorString:function(){return"Operation out of expected sequence."},getConnectionToServiceLostCode:function(){return EnumDCS_ErrorCode.ConnectionToServiceLost},getConnectionToServiceLostString:function(){return"The local service (Dynamsoft Service) is disconnected."},getAccessDeniedCode:function(){return EnumDCS_ErrorCode.AccessDenied},getAccessDeniedString:function(e,g,d){var f=arguments.length;if(f==3&&d==true){return"The document is being edited now."}else{if(f==2&&g=="Document"){return["The access to document editor "+e+" is denied"].join("")}else{return["The access to image viewer "+e+" is denied"].join("")}}},getCameraNotFoundCode:function(){return EnumDCS_ErrorCode.CameraNotFound},getCameraNotFoundString:function(){return"There is no camera found on the machine."},getStateNotCorrectCode:function(){return EnumDCS_ErrorCode.StateNotCorrect},getStateNotCorrectString:function(){return"The camera capability [capability] can not be set because it is automatically adjusted."},getCameraOccupiedCode:function(){return EnumDCS_ErrorCode.CameraOccupied},getCameraOccupiedString:function(){return"The camera you are trying to access is currently occupied by another Dynamsoft Camera process"},getOperationNotSupportedCode:function(){return EnumDCS_ErrorCode.OperationNotSupported},getOperationNotSupportedString:function(d){return d?d=="Image"?"This operation is only supported under document mode.":d=="Document"?"This operation is only supported under image mode.":d=="HTML5"?"Your browser doesn't support HTML5, please use a modern browser like Chrome, Firefox, etc.":"Dynamsoft Camera JS library cannot be used in current Internet options settings.":"Dynamsoft Camera JS library cannot be used in current Internet options settings."},getCameraNotAuthorizedCode:function(){return EnumDCS_ErrorCode.CameraNotAuthorized},getCameraNotAuthorizedString:function(){return"You have disallowed access to the local cameras out of security concerns."},getMultipageNotSupportedCode:function(){return EnumDCS_ErrorCode.MultipageNotSupported},getMultipageNotSupportedString:function(){return"The formats BMP, JPEG, PNG only allow one page per file."},getAsyncTaskNotCompletedCode:function(){return EnumDCS_ErrorCode.AsyncTaskNotCompleted},getAsyncTaskNotCompletedString:function(d){return["The asynchronous task ",d," is not completed yet."].join("")},getHttpErrorCode:function(){return EnumDCS_ErrorCode.HttpError},getHttpErrorString:function(d){return["The server returned the error code ",d,"."].join("")},getLicenseVerificationFailedCode:function(){return EnumDCS_ErrorCode.LicenseVerificationFailed},getLicenseVerificationFailedString:function(){return""},getOperationOutOfMemoryCode:function(){return EnumDCS_ErrorCode.OperationOutOfMemory},getOperationOutOfMemoryString:function(d){return["There is not enough memory for the operation ",d,"."].join("")},getObjectExistsCode:function(){return EnumDCS_ErrorCode.ObjectExists},getObjectExistsString:function(d){return["The object ",d," already exists."].join("")},getConnectionToServiceResetCode:function(){return EnumDCS_ErrorCode.ConnectionToServiceReset},getConnectionToServiceResetString:function(){return"The connection to the local service (Dynamsoft Service) has been reset."},getDataFormatInvalidCode:function(){return EnumDCS_ErrorCode.DataFormatInvalid},getDataFormatInvalidString:function(d){return d?"The format of the image you are trying to download is invalid.":"The format of the image loaded from system clipboard must be DIB (Windows OS) or NSImage (MAC OS)."},getJPEGCompressionErrorCode:function(){return EnumDCS_ErrorCode.JPEGCompressionError},getJPEGCompressionErrorString:function(){return"Only 24-bit true color bmp and 8-bit gray-scaled image are supported for JPEG compression."},getOperationCancelledCode:function(){return EnumDCS_ErrorCode.OperationCancelled},getOperationCancelledString:function(d){return d?"The document cannot be edited when another document is being edited in the document editor.":"User cancelled the operation."},getSessionNotFoundCode:function(){return EnumDCS_ErrorCode.SessionNotFound},getSessionNotFoundString:function(){return"The specified session is not found."},getCameraDisconnectedCode:function(){return EnumDCS_ErrorCode.CameraDisconnected},getCameraDisconnectedString:function(){return"The camera is disconnected, please check."},getConversionFailedCode:function(){return EnumDCS_ErrorCode.ConversionFailed},getConversionFailedString:function(){return"The conversion to base64 string failed."},getUnknownCode:function(){return EnumDCS_ErrorCode.Unknown},getUnknownString:function(d,e){return["(",d,")",e].join("")},getDownloadDcsModuleFailedCode:function(){return EnumDCS_ErrorCode.DownloadDcsModuleFailed},getDownloadDcsModuleFailedString:function(){return"Failed to download the DCS module. Please check the network connection and try again later."},getSendDcsModuleFailedCode:function(){return EnumDCS_ErrorCode.SendDcsModuleFailed},getSendDcsModuleFailedString:function(){return"Failed to send the DCS module to Dynamsoft Service. Please check the network connection and try again later."},getConnectDcsModuleFailedCode:function(){return EnumDCS_ErrorCode.ConnectDcsModuleFailed},getConnectDcsModuleFailedString:function(){return"Failed to connect to the DCS module. Please check the network connection and try again later."},getDocumentNotExistCode:function(){return EnumDCS_ErrorCode.DocumentNotExist},getDocumentNotExistString:function(){return"There is no document in the document editor."},getDocumentUndetectedCode:function(){return EnumDCS_ErrorCode.DocumentUndetected},getDocumentUndetectedString:function(){return"There is no document detected."}};a.errorInfo=a.errorInfo||{};a.mix(a.errorInfo,b)})(dynamsoft.lib);dynamsoft.lib.sdk=dynamsoft.lib.sdk||{};(function(e,b,d){function a(f,h,k,g){var j=this;j._dwsObjectId=k;j._errorCode=0;j._errorString="";j.camera=new b.Camera(j);j.videoviewer=new b.VideoViewer(j,f);d._videoViewerDic[f]={dwsObject:j,videoViewer:j.videoviewer};j._imageViewerManager=new e.sdk.ImageViewerManager(j);j._imageViewerManager.addImageViewer(h,g);j._documentEditorManager=new e.sdk.DocumentEditorManager(j);j._bDestoryed=false}a.prototype._validateParamNum=function(g,f){if(g.length!=f){this._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(g.length<f));return false}this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true};e.each(["Number","Boolean","String","Array"],function(f){a.prototype["_validate"+f+"Type"]=function(g,h){if(!e["is"+f](h)){this._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString(g));return false}if(f=="Number"&&e.isNaN(h)){this._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString(g));return false}this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true}});a.prototype._validateValue=function(j,k,g,h){var l=this;if(h&&g.length==2){if(k>Math.max(g[0],g[1])||k<Math.min(g[0],g[1])){l._setErrCodeErrString(e.errorInfo.getValueOutOfRangeCode(),e.errorInfo.getValueOutOfRangeString(j));return false}l._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true}if(!h){for(var f=0;f<g.length;f++){if(k==g[f]){l._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true}}l._setErrCodeErrString(e.errorInfo.getValueNotValidCode(),e.errorInfo.getValueNotValidString(j));return false}};a.prototype._validateElExist=function(g,f){var h;try{h=!!e.one("#"+g).getEL()}catch(j){h=false}if(h){if(!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}}else{this._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString(g))}return h};a.prototype._validateDivDom=function(g,j,f){if(!this._validateElExist(g,f)){return false}var h=e.one("#"+g).getEL();if(h.nodeName.toUpperCase()!="DIV"){this._setErrCodeErrString(e.errorInfo.getContainerTypeNotValidCode(),e.errorInfo.getContainerTypeNotValidString(j));return false}else{if(!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}return true}};a.prototype._validateImgViewerExist=function(j,f){var h=d._imageViewerDic[j],g=h&&h.dwsObject===this;if(g&&!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}else{this._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("image viewer"))}return g&&!f};a.prototype._validateDocEditorExist=function(g,f){var j=d._documentEditorDic[g],h=j&&j.dwsObject===this;if(h&&!f){this._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString())}else{this._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("document editor"))}return h&&!f};a.prototype._setErrCodeErrString=function(g,f){this._errorCode=g;this._errorString=f};a.prototype.getErrorCode=function(){if(this._bDestoryed){return false}return this._errorCode};a.prototype.getErrorString=function(){if(this._bDestoryed){return false}return this._errorString};a.prototype.getImageViewer=function(f){var j=this,h=null;if(j._bDestoryed){return false}if(!j._validateParamNum(arguments,1)||!j._validateStringType("imageContainerId",f)){return h}if(!j._validateDivDom(f,!0)){return h}var g=d._imageViewerDic[f];if(!g){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("image viewer"));return h}if(!j._validateDivDom(f,!0)){delete d._imageViewerDic[f];return h}if(g.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(f));return h}h=g.imageViewer;return h};a.prototype.getAllImageViewers=function(){var h=this,g=[],f;if(h._bDestoryed){return false}if(!h._validateParamNum(arguments,0)){return null}for(i in d._imageViewerDic){f=d._imageViewerDic[i];if(f.dwsObject!==h){continue}g.push(f.imageViewer)}g.sort(function(k,j){return k._innerIndex-j._innerIndex});g.at=function(j){return this[j]};return g};a.prototype.addImageViewer=function(j){var l=this;if(l._bDestoryed){return false}if(!l._validateParamNum(arguments,1)||!l._validateStringType("imageContainerId",j)){return null}if(!l._validateDivDom(j,!0)){return null}var h=d._imageViewerDic[j];var g=d._documentEditorDic[j];var f=d._videoViewerDic[j];if(h){if(h.dwsObject===l){l._setErrCodeErrString(e.errorInfo.getObjectExistsCode(),e.errorInfo.getObjectExistsString(j))}else{l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(j))}return null}if(g||f){l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(j));return null}var k=l._imageViewerManager.addImageViewer(j);return k?d._imageViewerDic[j].imageViewer:null};a.prototype.removeImageViewer=function(g){var j=this,f=false;if(j._bDestoryed){return f}if(!j._validateParamNum(arguments,1)||!j._validateStringType("imageContainerId",g)){return f}if(!j._validateDivDom(g,!0)){return f}var h=d._imageViewerDic[g];if(!h){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("image viewer"));return f}if(h.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(g));return f}if(h.imageViewer.io._validateImgIsHandlingAsyncOperation()){return f}f=j._imageViewerManager.removeImageViewer(g);return f};a.prototype.getDocumentEditor=function(f){var j=this,g=null;if(j._bDestoryed){return false}if(!j._validateParamNum(arguments,1)||!j._validateStringType("documentEditorContainerId",f)){return g}if(!j._validateDivDom(f,"document")){return g}var h=d._documentEditorDic[f];if(!h){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("document editor"));return g}if(!j._validateDivDom(f,!0)){delete d._documentEditorDic[f];return g}if(h.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(f,"Document"));return g}g=h.documentEditor;return g};a.prototype.getAllDocumentEditors=function(){var h=this,g=[],f;if(h._bDestoryed){return false}if(!h._validateParamNum(arguments,0)){return null}for(i in d._documentEditorDic){f=d._documentEditorDic[i];if(f.dwsObject!==h){continue}g.push(f.documentEditor)}g.sort(function(k,j){return k._innerIndex-j._innerIndex});g.at=function(j){return this[j]};return g};a.prototype.addDocumentEditor=function(h){var l=this;if(l._bDestoryed){return false}if(!l._validateParamNum(arguments,1)||!l._validateStringType("documentEditorContainerId",h)){return null}if(!l._validateDivDom(h,"document")){return null}var g=d._documentEditorDic[h];var k=d._imageViewerDic[h];var f=d._videoViewerDic[h];if(g){if(g.dwsObject===l){l._setErrCodeErrString(e.errorInfo.getObjectExistsCode(),e.errorInfo.getObjectExistsString(h))}else{l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(h))}return null}if(k||f){l._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(h));return null}if(d.navInfo.bEdge){if(!window.applicationCache){l._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("HTML5"));return false}}else{if(!d.navInfo.bHTML5Edition){l._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("HTML5"));return false}}var j=l._documentEditorManager.addDocumentEditor(h);return j?d._documentEditorDic[h].documentEditor:null};a.prototype.removeDocumentEditor=function(g){var j=this,f=false;if(j._bDestoryed){return f}if(!j._validateParamNum(arguments,1)||!j._validateStringType("documentEditorContainerId",g)){return f}if(!j._validateDivDom(g,"document")){return f}var h=d._documentEditorDic[g];if(!h){j._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("document editor"));return f}if(h.dwsObject!==j){j._setErrCodeErrString(e.errorInfo.getAccessDeniedCode(),e.errorInfo.getAccessDeniedString(g,"Document"));return f}f=j._documentEditorManager.removeDocumentEditor(g);return f};a.prototype.destroy=function(){var l=this,j;if(l._bDestoryed){return false}var f=!1;if(!l._validateParamNum(arguments,0)){return f}var g,k,p,m,n;for(j in d._imageViewerDic){k=d._imageViewerDic[j];if(!k||k.dwsObject!==l||!k.imageViewer){continue}p=k.imageViewer;if(p.io._isHandlingAsyncOperation()){l._setErrCodeErrString(e.errorInfo.getAsyncTaskNotCompletedCode(),e.errorInfo.getAsyncTaskNotCompletedString(p.io._isHandlingAsyncDownloadOperation()?"httpDownloadAsync":"httpUploadAsync"));return f}}var h={session:e.detect.sessionId,object:l._dwsObjectId,method:"Destroy"},o=function(r){if(e.detect.isValidResponseValue(r)){if(r.exception==0){f=!0}else{l._setErrCodeErrString(r.exception,r.description);f=!1}}},q=function(){e.detect.throwServiceNotConnectException(l);f=!1};e.detect.sendCommand("POST",e.stringify(h),null,o,q,"json",!1);if(f){e.detect.sendRemoveObjectCommand(l._dwsObjectId);for(j in d._videoViewerDic){g=d._videoViewerDic[j];if(!g||g.dwsObject!==l){continue}l.camera._destory();l.videoviewer._destory();delete d._videoViewerDic[j];break}for(j in d._imageViewerDic){k=d._imageViewerDic[j];if(!k||k.dwsObject!==l||!k.imageViewer){continue}p=k.imageViewer;p.ui._destory();p.image._destory();p.io._destory();delete d._imageViewerDic[j]}for(j in d._documentEditorDic){m=d._documentEditorDic[j];if(!m||m.dwsObject!==l||!m.documentEditor){continue}n=m.documentEditor;n.ui._destory();n.document._destory();delete d._documentEditorDic[j]}l._bDestoryed=true}return f};b.DcsObject=a})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv);(function(e,d,b){function a(f){var g=this;g._dwsObject=f;g._bDestoryed=false;e.sdk.ktCamera.apply(g)}a.prototype.playVideo=function(){var j=this;if(j._bDestoryed){return false}var g=!1;if(!j._dwsObject._validateParamNum(arguments,0)){return g}if(!j._dwsObject._validateDivDom(j._dwsObject.videoviewer._getVideoViewerId(),!1)){return g}var h={session:dynamsoft.lib.detect.sessionId,object:j._dwsObject._dwsObjectId,method:"PlayVideo",parameter:[d._getProductKey()]},f=function(){var k=j._dwsObject.getErrorCode(),l=j._dwsObject.getErrorString();j._dwsObject.videoviewer._showStream();j._dwsObject._setErrCodeErrString(k,l);j._dwsObject.videoviewer._documentDetected=true};g=e.detect.postSyncCommand(j._dwsObject,e.stringify(h),f,null);return g};a.prototype.captureImage=function(m){var n=this,g=!1;if(n._bDestoryed){return g}if(n._dwsObject.videoviewer._mode=="Document"){n._dwsObject._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("Document"));return g}if(!n._dwsObject._validateParamNum(arguments,1)||!n._dwsObject._validateStringType("imageViewer",m)){return g}if(!n._dwsObject._validateDivDom(n._dwsObject.videoviewer._getVideoViewerId(),!1)){return g}var k;try{k=e.one("#"+m).getEL()}catch(j){k=false}if(!k){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString(m));return g}if(k.nodeName.toUpperCase()!="DIV"){n._dwsObject._setErrCodeErrString(e.errorInfo.getContainerTypeNotValidCode(),e.errorInfo.getContainerTypeNotValidString(true));return g}if(!d._imageViewerDic[m]){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("imageViewer"));return g}if(d._imageViewerDic[m].dwsObject!==n._dwsObject){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(m));return g}var l=d._imageViewerDic[m].imageViewer;if(l.image.getCount()==l.image.getCapacity()){n._dwsObject._setErrCodeErrString(e.errorInfo.getBufferIsFullCode(),e.errorInfo.getBufferIsFullString());return g}if(l.io._validateImgIsHandlingAsyncOperation()){return g}var h={session:dynamsoft.lib.detect.sessionId,object:n._dwsObject._dwsObjectId,method:"CaptureImage",parameter:[d._getProductKey(),l._imgViewerId]},f=function(){var o=n._dwsObject.getErrorCode(),p=n._dwsObject.getErrorString();l.ui._addImageControl();n._dwsObject._setErrCodeErrString(o,p)};g=e.detect.postSyncCommand(n._dwsObject,e.stringify(h),f,null);return g};a.prototype.captureDocument=function(m){var n=this,g=!1;if(n._bDestoryed){return g}if(n._dwsObject.videoviewer._mode=="Image"){n._dwsObject._setErrCodeErrString(e.errorInfo.getOperationNotSupportedCode(),e.errorInfo.getOperationNotSupportedString("Image"));return g}if(!n._dwsObject._validateParamNum(arguments,1)||!n._dwsObject._validateStringType("imageViewer",m)){return g}if(!n._dwsObject._validateDivDom(n._dwsObject.videoviewer._getVideoViewerId(),!1)){return g}var k;try{k=e.one("#"+m).getEL()}catch(j){k=false}if(!k){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString(m));return g}if(k.nodeName.toUpperCase()!="DIV"){n._dwsObject._setErrCodeErrString(e.errorInfo.getContainerTypeNotValidCode(),e.errorInfo.getContainerTypeNotValidString(true));return g}if(!d._imageViewerDic[m]){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("imageViewer"));return g}if(d._imageViewerDic[m].dwsObject!==n._dwsObject){n._dwsObject._setErrCodeErrString(e.errorInfo.getObjectOccupiedCode(),e.errorInfo.getObjectOccupiedString(m));return g}var l=d._imageViewerDic[m].imageViewer;if(l.image.getCount()==l.image.getCapacity()){n._dwsObject._setErrCodeErrString(e.errorInfo.getBufferIsFullCode(),e.errorInfo.getBufferIsFullString());return g}if(l.io._validateImgIsHandlingAsyncOperation()){return g}var h={session:dynamsoft.lib.detect.sessionId,object:n._dwsObject._dwsObjectId,method:"CaptureDocument",parameter:[d._getProductKey(),l._imgViewerId,n._dwsObject.videoviewer._bAllow]},f=function(){var o=n._dwsObject.getErrorCode(),p=n._dwsObject.getErrorString();l.ui._addImageControl();n._dwsObject._setErrCodeErrString(o,p)};g=e.detect.postSyncCommand(n._dwsObject,e.stringify(h),f,null);return g};a.prototype.takeCameraOwnership=function(g){var k=this,h=!1;if(k._bDestoryed){return h}if(!k._dwsObject._validateParamNum(arguments,1)||!k._dwsObject._validateStringType("cameraName",g)){return h}if(g.length===0||g.length>64){k._dwsObject._setErrCodeErrString(e.errorInfo.getValueNotValidCode(),e.errorInfo.getValueNotValidString("cameraName"));return h}var j={session:dynamsoft.lib.detect.sessionId,object:k._dwsObject._dwsObjectId,method:"TakeCameraOwnership",parameter:[g]},f=function(l){k._dwsObject._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());if(!l.result[1]){k._dwsObject.videoviewer._StopStream()}};h=e.detect.postSyncCommand(k._dwsObject,e.stringify(j),f,null);return h};a.prototype._destory=function(){this._bDestoryed=true};e.sdk.Camera=a})(dynamsoft.lib,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(b,e,d){b.Camera._CameraProp=function(g,f){this.parent=g;this._camera=g;this._dwsObject=g._dwsObject;this.strProp=f};b.Camera._CameraProp.prototype.getCurrent=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetCurrent",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraProp.prototype.setCurrent=function(g){if(!this.parent._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof g!="number"){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("iValue"));return false}if(g<-2147483648||g>2147483647){this._dwsObject._setErrCodeErrString(e.errorInfo.getValueOutOfRangeCode(),e.errorInfo.getValueOutOfRangeString("iValue"));return false}var f=this.parent._communicateWithService("SetCurrent",[this.strProp,g]);if(!f){if(this._dwsObject.getErrorCode()==-1003){this._dwsObject._setErrCodeErrString(-1003,e.errorInfo.getValueOutOfRangeString("iValue"))}return false}return f.result[0]};b.Camera._CameraResolution=dynamsoft.lib.extend(dynamsoft.lib.sdk.Camera._CameraProp);b.Camera._CameraResolution.prototype.getCurrent=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetResolutionCurrent");if(!f){return null}return new b.Camera.prototype.Resolution(f.result[0],f.result[1])};b.Camera._CameraResolution.prototype.setCurrent=function(g){if(!this.parent._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof g.width!="number"||typeof g.width!="number"){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("resolution"));return false}if(g.width<0||g.width>2147483647||g.height<0||g.height>2147483647){this._dwsObject._setErrCodeErrString(e.errorInfo.getValueOutOfRangeCode(),e.errorInfo.getValueOutOfRangeString("resolution"));return false}var f=this.parent._communicateWithService("SetResolutionCurrent",[g.width,g.height]);if(!f){if(this._dwsObject.getErrorCode()==-1003){this._dwsObject._setErrCodeErrString(-1003,e.errorInfo.getValueOutOfRangeString("resolution"))}else{if(this._dwsObject.getErrorCode()==-1002){this._dwsObject._setErrCodeErrString(-1002,e.errorInfo.getTypeNotValidString("resolution"))}else{if(this._dwsObject.getErrorCode()==-1008){this._dwsObject._setErrCodeErrString(-1008,e.errorInfo.getValueNotValidString("resolution"))}}}return false}this._dwsObject.videoviewer._setObjImgSize(g.width,g.height);return f.result[0]};var a=function(g,f){return g.width-f.width};b.Camera._CameraResolution.prototype.getAllowedValues=function(){if(!this.parent._check()){return[]}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return[]}var h=this.parent._communicateWithService("GetResolutionAllowedValues");if(!h){return[]}var g=[];for(var f=0;f<h.result.length/2;++f){g[f]=new b.Camera.prototype.Resolution(h.result[2*f],h.result[2*f+1])}g=g.sort(a);g.at=function(j){return this[j]};return g};b.Camera._CameraUnautoProp=dynamsoft.lib.extend(dynamsoft.lib.sdk.Camera._CameraProp);b.Camera._CameraUnautoProp.prototype.getDefault=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetDefault",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraUnautoProp.prototype.getMin=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetMin",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraUnautoProp.prototype.getMax=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetMax",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraAutoProp=dynamsoft.lib.extend(dynamsoft.lib.sdk.Camera._CameraUnautoProp);b.Camera._CameraAutoProp.prototype.getIfAuto=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetIfAuto",[this.strProp]);if(!f){return null}return f.result[0]};b.Camera._CameraAutoProp.prototype.setIfAuto=function(g){if(!this.parent._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof g!=="boolean"){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("auto"));return false}var f=this.parent._communicateWithService("SetIfAuto",[this.strProp,g]);if(!f){return false}return f.result[0]};b.Camera._CameraAutoProp.prototype.getIfDefaultAuto=function(){if(!this.parent._check()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this.parent._communicateWithService("GetIfDefaultAuto",[this.strProp]);if(!f){return null}return f.result[0]};b.ktCamera=function(){this.resolution=new dynamsoft.lib.sdk.Camera._CameraResolution(this,"resolution");this.exposure=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"exposureTime");this.iris=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"iris");this.focus=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"focus");this.zoom=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"zoom");this.pan=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"pan");this.tilt=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"tilt");this.roll=new dynamsoft.lib.sdk.Camera._CameraUnautoProp(this,"roll");this.backlightCompensation=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"backlightCompensation");this.brightness=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"brightness");this.gain=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"gain");this.saturation=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"saturation");this.sharpness=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"sharpness");this.gamma=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"gamma");this.whiteBalanceTemperature=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"whiteBalanceTemperature");this.contrast=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"contrast");this.hue=new dynamsoft.lib.sdk.Camera._CameraAutoProp(this,"hue")};b.Camera.prototype.Resolution=function(g,f){this.width=g;this.height=f};b.Camera.prototype._checkBeforeSelect=function(){this._dwsObject._setErrCodeErrString(e.errorInfo.getOkCode(),e.errorInfo.getOkString());return true};b.Camera.prototype._check=function(){if(!this._checkBeforeSelect()){return false}if(!e.one("#"+this._dwsObject.videoviewer._videoContainerId)||!e.one("#"+this._dwsObject.videoviewer._videoContainerId).getEL()){
this._dwsObject._setErrCodeErrString(e.errorInfo.getObjectNotExistCode(),e.errorInfo.getObjectNotExistString("video viewer"));return false}return true};b.Camera.prototype._communicateWithService=function(l,k){var f={session:e.detect.sessionId,object:this._dwsObject._dwsObjectId,method:l,parameter:k?k:[]};var h=e.stringify(f);var g;var j=this;e.ajax({method:"POST",data:h,url:[e.detect.preUrl,e.detect.portInfo.curPort,"/",d._getVersionStrForCommand(),"/ts=",e.now()].join(""),onSuccess:function(m){g=m},onError:function(m){dynamsoft.lib.detect.throwServiceNotConnectException(j._dwsObject)},dataType:"json",async:false});if(!g){return null}if(g.exception!=0){switch(g.exception){case EnumDCS_ErrorCode.CameraOccupied:case EnumDCS_ErrorCode.ConnectionToServiceReset:if(e.isString(g.description)){g.description=g.description.replace("Webcam","Camera")}break;case-1002:g.exception=e.errorInfo.getTypeNotValidCode();g.description=e.errorInfo.getTypeNotValidString("iValue");break;case-1008:g.exception=e.errorInfo.getValueNotValidCode();g.description=e.errorInfo.getValueNotValidString("iValue");break;default:if(e.errorInfo.isUnknownCode(g.exception)){g.description=e.errorInfo.getUnknownString(g.exception,g.description);g.exception=EnumDCS_ErrorCode.Unknown}break}this._dwsObject._setErrCodeErrString(g.exception,g.description);return null}return g};b.Camera.prototype.getCameraList=function(){if(!this._checkBeforeSelect()){return null}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return null}var f=this._communicateWithService("GetCameraList");if(!f){return null}return f.result?f.result:[]};b.Camera.prototype.selectCamera=function(h){if(!this._checkBeforeSelect()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof h!=="string"){this._dwsObject._setErrCodeErrString(e.errorInfo.getTypeNotValidCode(),e.errorInfo.getTypeNotValidString("CameraName"));return false}var g=this._communicateWithService("SelectCamera",[h]);if(!g){if(this._dwsObject.getErrorCode()==-1008){this._dwsObject._setErrCodeErrString(-1008,e.errorInfo.getValueNotValidString("CameraName"))}return false}var f=g.result[0];if(f&&!g.result[1]){this._dwsObject.videoviewer._StopStream()}return f};b.Camera.prototype.closeCamera=function(){if(!this._check()){return false}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return false}var g=this._communicateWithService("CloseCamera");if(!g){return false}var f=g.result[0];if(f){this._dwsObject.videoviewer._StopStream()}return f};b.Camera.prototype.stopVideo=function(){if(!this._check()){return false}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return false}var g=this._communicateWithService("StopVideo");if(!g){return false}var f=g.result[0];if(f){this._dwsObject.videoviewer._StopStream()}return f};b.Camera.prototype.pauseVideo=function(){if(!this._check()){return false}if(arguments.length!=0){this._dwsObject._setErrCodeErrString(e.errorInfo.getParameterNumberUnmatchedCode(),e.errorInfo.getParameterNumberUnmatchedString(arguments.length<0));return false}var g=this._communicateWithService("PauseVideo");if(!g){return false}var f=g.result[0];if(f){this._dwsObject.videoviewer._pauseStream()}this._dwsObject.videoviewer._documentDetected=false;this._dwsObject.videoviewer._objImage.src=this._dwsObject.videoviewer._getFrameUrl(true);return f}})(dynamsoft.lib.sdk,dynamsoft.lib,dynamsoft.dcsEnv);(function(f,a,e){var d=1e3/35;function b(h,g){var k=this;k._dwsObject=h;k._videoContainerId=g;k._userVideoContainer=f.one("#"+g).getEL();f.empty(k._userVideoContainer);var j=f.getElDimensions(k._userVideoContainer,false);k._userVideoContainerWidth=j?j.clientWidth:k._userVideoContainer.clientWidth;k._userVideoContainerHeight=j?j.clientHeight:k._userVideoContainer.clientHeight;k._userVideoContainer.innerHTML='<div class="ds-dws-video-viewer-wrapper" oncontextmenu="return false;"></div>';k._videoContainerWrapper=f.one(".ds-dws-video-viewer-wrapper",k._userVideoContainer).getEL();k._videoContainerWrapper.style.width=k._userVideoContainerWidth+"px";k._videoContainerWrapper.style.height=k._userVideoContainerHeight+"px";k._initObjImg();k._objImgWidth=NaN;k._objImgHeight=NaN;k._bStreamStopped=false;k._bStreamPaused=false;k._bDestoryed=false;k._MAXLOADINGIMGCOUNT=4;k._curLoadingImgCount=0;k.EnumMode={Image:0,Document:1};k._mode="Image";k.pollDocument=null;k._documentDetected=false;k._MINCOLOR=0;k._MAXCOLOR=4294967295;k._documentBoundaryColor=1589110015;k._bAllow=false;k._documentBoundaryThickness=2;k._bIe9_10=e.navInfo.bIE&&(parseInt(e.navInfo.strBrowserVersion)===9||parseInt(e.navInfo.strBrowserVersion)===10);f.sdk.ktVideoViewer.apply(k)}b.prototype.ondocumentboundarydetected=null;b.prototype.setMode=function(h){var j=this;if(j._dwsObject._bDestoryed){return false}if(j._bDestoryed){j._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+j._videoContainerId)||!f.one("#"+j._videoContainerId).getEL()){j._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!j._dwsObject._validateParamNum(arguments,1)||!j._dwsObject._validateNumberType("mode",h)){return false}if(h!=0&&h!==1){j._dwsObject._setErrCodeErrString(f.errorInfo.getValueNotValidCode(),f.errorInfo.getValueNotValidString(h));return false}for(var g in j.EnumMode){if(h==j.EnumMode[g]){j._mode=g}}if(j._mode=="Document"){j._documentDetected=true}return true};b.prototype.getMode=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return g._mode};b.prototype.setAllowCaptureUndetectedDocument=function(g){var h=this;if(h._dwsObject._bDestoryed){return false}if(h._bDestoryed){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+h._videoContainerId)||!f.one("#"+h._videoContainerId).getEL()){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!h._dwsObject._validateParamNum(arguments,1)||!h._dwsObject._validateBooleanType("bAllow",g)){return false}if(g==true||g==false){h._bAllow=g}else{h._dwsObject._setErrCodeErrString(f.errorInfo.getValueNotValidCode(),f.errorInfo.getValueNotValidString(g))}return true};b.prototype.getAllowCaptureUndetectedDocument=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return this._bAllow};b.prototype.setDocumentBoundaryThickness=function(g){var h=this;if(h._dwsObject._bDestoryed){return false}if(h._bDestoryed){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+h._videoContainerId)||!f.one("#"+h._videoContainerId).getEL()){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!h._dwsObject._validateParamNum(arguments,1)||!h._dwsObject._validateNumberType("thickness",g)||!h._dwsObject._validateValue("thickness",g,[0,1e5],true)){return false}h._documentBoundaryThickness=Math.round(g);return true};b.prototype.getDocumentBoundaryThickness=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return g._documentBoundaryThickness};b.prototype.setDocumentBoundaryColor=function(g){var h=this;if(h._dwsObject._bDestoryed){return false}if(h._bDestoryed){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!f.one("#"+h._videoContainerId)||!f.one("#"+h._videoContainerId).getEL()){h._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return false}if(!h._dwsObject._validateParamNum(arguments,1)||!h._dwsObject._validateNumberType("color",g)||!h._dwsObject._validateValue("color",g,[h._MINCOLOR,h._MAXCOLOR],true)){return false}h._documentBoundaryColor=g;return true};b.prototype.getDocumentBoundaryColor=function(){var g=this;if(g._dwsObject._bDestoryed){return null}if(g._bDestoryed){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!f.one("#"+g._videoContainerId)||!f.one("#"+g._videoContainerId).getEL()){g._dwsObject._setErrCodeErrString(f.errorInfo.getObjectNotExistCode(),f.errorInfo.getObjectNotExistString("video viewer"));return null}if(!g._dwsObject._validateParamNum(arguments,0)){return null}return g._documentBoundaryColor};b.prototype._initObjImg=function(){var g=this;g._objImage=new Image;g._objImage.className="ds-dws-img-obj";g._makeImgObjUndragable(g._objImage)};b.prototype._getVideoViewerId=function(){return this._videoContainerId};b.prototype._getVideoViewerEl=function(){try{return f.one("#"+this._videoContainerId).getEL()}catch(g){return false}};b.prototype._attachImage=function(){var h=this;if(!h._dwsObject._validateDivDom(h._getVideoViewerId(),!1,!0)){h._clearStreamProp();return}if(h._bStreamPaused){h._objImage.style.display="block"}if(h._bStreamStopped){h._objImage.style.display="none"}if(h._bStreamPaused&&h._objImage.parentNode||h._bStreamStopped){return}h._objImage.onload="";h._objImage.onerror="";var g=f.now();h._curLoadingImgCount=0;h._objImage.onload=function(){var m=this;h._objImage.onload="";h._objImage.onerror="";h._positionImgObj(isNaN(h._objImgWidth)?h._bIe9_10&&m.naturalWidth?m.naturalWidth:m.width:h._objImgWidth,isNaN(h._objImgHeight)?h._bIe9_10&&m.naturalHeight?m.naturalHeight:m.height:h._objImgHeight);if(h._bStreamStopped){h._objImage.style.display="none"}h._curLoadingImgCount=0;var j=f.now();if(!h._bStreamPaused&&!h._bStreamStopped){var l=parseInt(j-g),k=parseInt(d-l);setTimeout(function(){h._getFrame()},f.isNaN(k)||k<=0?0:k)}};h._objImage.onerror=function(){var j=this;++h._curLoadingImgCount;f.log("Stream "+j.src+" error.");j.style.display="none";if(h._curLoadingImgCount>=h._MAXLOADINGIMGCOUNT){h._clearStreamProp();a.handleImageLoadingError(h._dwsObject,j.src)}else{j.src=h._getFrameUrl(true)}};h._objImage.src=h._getFrameUrl(true)};b.prototype._repositionImgObj=function(){var g=this;if(g._bStreamPaused&&g._objImage&&g._objImage.width>0&&g._objImage.height>0){g._positionImgObj(g._objImage.width,g._objImage.height)}};b.prototype._positionImgObj=function(j,l,k){var m=this,h=0,g=0;k=k||m._objImage;if(!k){return}if(j/m._userVideoContainerWidth>l/m._userVideoContainerHeight){h=m._userVideoContainerWidth;g=l*m._userVideoContainerWidth/j}else{g=m._userVideoContainerHeight;h=j*m._userVideoContainerHeight/l}if(h<=0||isNaN(h)||g<=0||isNaN(g)){k.style.display="none";return}k.style.position="absolute";k.style.top=(m._userVideoContainerHeight-g)/2+"px";k.style.left=(m._userVideoContainerWidth-h)/2+"px";k.style.width=h+"px";k.style.height=g+"px";k.style.display="block";if(!k.parentNode){m._videoContainerWrapper.appendChild(k)}};b.prototype._showStream=function(){var g=this;g._bStreamStopped=false;g._bStreamPaused=false;if(e.navInfo.bIE){if(g._objImage&&g._objImage.parentNode){g._objImage.setAttribute("onmousedown","");g._objImage.setAttribute("unselectable","");g._objImage.setAttribute("draggable","");g._objImage.parentNode.removeChild(g._objImage)}g._initObjImg()}if(g._objImage){g._objImage.style.display="none"}g._objImgWidth=NaN;g._objImgHeight=NaN;g._getFrame(true);g._ifDocumentDetected()};b.prototype._ifDocumentDetected=function(){var g=this;g.pollDocument=setInterval(function(){if(g._bStreamStopped||g._bStreamPaused||g._bDestoryed){return false}if(g._dwsObject.getErrorCode()==-1022){return false}if(!f.isFunction(g.ondocumentboundarydetected)){return false}if(!g._documentDetected){return false}var h=g._GetDocBoundaryInfoFromVideo();if(h.length&&h.length==10&&g._mode=="Document"){g.ondocumentboundarydetected()}},500)};b.prototype._GetDocBoundaryInfoFromVideo=function(){var k=this,h;var j={session:a.sessionId,object:k._dwsObject._dwsObjectId,method:"GetDocBoundaryInfo"},g=function(l){h=l.result};f.detect.postSyncCommand(k._dwsObject,f.stringify(j),g,null);return h};b.prototype._getFrameUrl=function(h){var g=this;return[a.preUrl,a.portInfo.curPort,"/",e._getVersionStrForCommand(),"/stream?session=",a.sessionId,"&object=",g._dwsObject._dwsObjectId,"&width=",f.isNumber(g._userVideoContainerWidth)?g._userVideoContainerWidth:0,"&height=",f.isNumber(g._userVideoContainerHeight)?g._userVideoContainerHeight:0,"&mode=",g._mode.toLowerCase(),"&documentBoundaryThickness=",g._documentBoundaryThickness,"&documentBoundaryColor=",g._documentBoundaryColor,h?"&ts="+f.now():""].join("")};b.prototype._getFrame=function(){var g=this;setTimeout(function(){g._attachImage()},0)};b.prototype._pauseStream=function(){var g=this;g._bStreamPaused=true;g._bStreamStopped=false;g._objImage.style.display="block"};b.prototype._StopStream=function(){var g=this;g._bStreamPaused=false;g._bStreamStopped=true;if(g._objImage){g._objImage.style.display="none"}};b.prototype._clearStreamProp=function(){var g=this;g._bStreamPaused=false;g._bStreamStopped=false};b.prototype._makeImgObjUndragable=function(g){g.setAttribute("onmousedown","return false;");g.setAttribute("unselectable","on");g.setAttribute("draggable","false")};b.prototype._setObjImgSize=function(h,g){this._objImgWidth=h;this._objImgHeight=g};b.prototype._destory=function(){var g=this;g._clearStreamProp();g._removeUserVideoContainerEvents();f.empty(g._videoContainerWrapper);f.empty(g._userVideoContainer);g._bDestoryed=true};f.sdk.VideoViewer=b})(dynamsoft.lib,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(a,d,b){a.ktVideoViewer=function(){var e=this;this._origDispaly="";this.onmouseclick=null;this.onmouserightclick=null;this.onmousedoubleclick=null;this.timer=null;this.isOnClickWait=false;this._onLeftclickWraper=function(f){e._onLeftclick.apply(e,[f])};d.addEventListener(this._userVideoContainer,"click",this._onLeftclickWraper);if(!dynamsoft.dcsEnv.navInfo.bHTML5Edition){d.addEventListener(this._userVideoContainer,"dblclick",this._onLeftclickWraper)}this._onRightclickWraper=function(f){e._onRightclick.apply(e,[f])};d.addEventListener(this._userVideoContainer,"contextmenu",this._onRightclickWraper)};a.VideoViewer.prototype._onLeftclick=function(e){e=d.switchEvent(e);if(e.which!=1){return}if(!this.isOnClickWait){this.isOnClickWait=true;var f=this;this.timer=setTimeout(function(){f.isOnClickWait=false;if(f.onmouseclick){f.onmouseclick.apply(f._userVideoContainer,[e])}},500)}else{this.isOnClickWait=false;clearTimeout(this.timer);if(this.onmousedoubleclick){this.onmousedoubleclick.apply(this._userVideoContainer,[e])}}};a.VideoViewer.prototype._onRightclick=function(e){e=d.switchEvent(e);if(this.onmouserightclick){this.onmouserightclick.apply(this._userVideoContainer,[e])}};a.VideoViewer.prototype._removeUserVideoContainerEvents=function(){d.removeEventListener(this._userVideoContainer,"click",this._onLeftclickWraper);d.removeEventListener(this._userVideoContainer,"contextmenu",this._onRightclickWraper)};a.VideoViewer.prototype._check=function(){this._dwsObject._setErrCodeErrString(d.errorInfo.getOkCode(),d.errorInfo.getOkString());var e=true;if(!d.one("#"+this._videoContainerId)||!d.one("#"+this._videoContainerId).getEL()){this._dwsObject._setErrCodeErrString(d.errorInfo.getObjectNotExistCode(),d.errorInfo.getObjectNotExistString("video viewer"));e=false}return e};a.VideoViewer.prototype._parseInt=function(e){return Math.round(parseFloat(e))};a.VideoViewer.prototype.getWidth=function(){if(!this._check()){return false}return this._userVideoContainer.style.width?this._parseInt(this._userVideoContainer.style.width):this._userVideoContainer.clientWidth};a.VideoViewer.prototype.setWidth=function(e){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}e=this._parseInt(e);if(!e&&e!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("width"));return false}else{if(e>b._uiMaxSize||e<1){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("width"));return false}}this._userVideoContainerWidth=e;this._userVideoContainer.style.width=e+"px";this._videoContainerWrapper.style.width=e+"px";this._repositionImgObj();return true};a.VideoViewer.prototype.getHeight=function(){if(!this._check()){return null}return this._userVideoContainer.style.height?this._parseInt(this._userVideoContainer.style.height):this._userVideoContainer.clientHeight};a.VideoViewer.prototype.setHeight=function(e){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}e=this._parseInt(e);if(!e&&e!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("height"));return false}else{if(e>b._uiMaxSize||e<1){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("height"));return false}}this._userVideoContainerHeight=e;this._userVideoContainer.style.height=e+"px";this._videoContainerWrapper.style.height=e+"px";this._repositionImgObj();return true};a.VideoViewer.prototype.getVideoQuality=function(){if(!this._check()){return null}var e={session:d.detect.sessionId,object:this._dwsObject._dwsObjectId,method:"GetVideoQuality"};var g=d.stringify(e);var f;var h=this;d.ajax({method:"POST",data:g,url:[d.detect.preUrl,d.detect.portInfo.curPort,"/",b._getVersionStrForCommand(),"/ts=",d.now()].join(""),onSuccess:function(j){f=j},onError:function(j){h._dwsObject._setErrCodeErrString(d.errorInfo.getConnectionToServiceLostCode(),d.errorInfo.getConnectionToServiceLostString())},dataType:"json",async:false});if(!f){return false}if(f.exception!=0){this._dwsObject._setErrCodeErrString(f.exception,f.description);return null}return f.result[0]};a.VideoViewer.prototype.setVideoQuality=function(h){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof h!="number"){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("quality"));return false}h=this._parseInt(h);if(!h&&h!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("quality"));return false}else{if(h>100||h<1){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("quality"));return false}}var e={session:d.detect.sessionId,object:this._dwsObject._dwsObjectId,method:"SetVideoQuality",parameter:[h]};var g=d.stringify(e);var f;var j=this;d.ajax({method:"POST",data:g,url:[d.detect.preUrl,d.detect.portInfo.curPort,"/",b._getVersionStrForCommand(),"/ts=",d.now()].join(""),onSuccess:function(k){f=k},onError:function(k){j._dwsObject._setErrCodeErrString(d.errorInfo.getConnectionToServiceLostCode(),d.errorInfo.getConnectionToServiceLostString())},dataType:"json",async:false});if(!f){return false}if(f.exception!=0){this._dwsObject._setErrCodeErrString(f.exception,f.description);return null}return f.result[0]};a.VideoViewer.prototype.getBackgroundColor=function(){if(!this._check()){return null}return d.colorStrToInt(this._userVideoContainer.style.backgroundColor?this._userVideoContainer.style.backgroundColor:d.currentStyle(this._userVideoContainer,"background-color"))};a.VideoViewer.prototype.setBackgroundColor=function(e){if(!this._check()){return false}if(arguments.length!=1){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(arguments.length<1));return false}if(typeof e!="number"){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("backgroundColor"));return false}e=this._parseInt(e);if(!e&&e!=0){this._dwsObject._setErrCodeErrString(d.errorInfo.getTypeNotValidCode(),d.errorInfo.getTypeNotValidString("backgroundColor"));return false}else{if(e>4294967295||e<0){this._dwsObject._setErrCodeErrString(d.errorInfo.getValueOutOfRangeCode(),d.errorInfo.getValueOutOfRangeString("backgroundColor"));return false}}this._userVideoContainer.style.backgroundColor=d.IntToColorStr(e);return true};a.VideoViewer.prototype.show=function(){if(!this._check()){return false}if(arguments.length>0){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(false));return false}if(this._userVideoContainer.style.display=="none"){this._userVideoContainer.style.display=this._origDispaly}else{this._origDispaly=this._userVideoContainer.style.display;if(this._origDispaly=="none"){this._origDispaly=""}}return true};a.VideoViewer.prototype.hide=function(){if(!this._check()){return false}if(arguments.length>0){this._dwsObject._setErrCodeErrString(d.errorInfo.getParameterNumberUnmatchedCode(),d.errorInfo.getParameterNumberUnmatchedString(false));return false}this._origDispaly=this._userVideoContainer.style.display;if(this._origDispaly=="none"){this._origDispaly=""}this._userVideoContainer.style.display="none";return true}})(dynamsoft.lib.sdk,dynamsoft.lib,dynamsoft.dcsEnv);(function(e,d,b){function a(f){if(f&&f._imageViewerManager){return}this._dwsObject=f}a.prototype.addImageViewer=function(g,f){var l=this,h=!0;if(!e.isString(f)||f.indexOf(d._imgViewerClientIdPrefix)==-1){f=d._imgViewerClientIdPrefix+e.getRandom();var j={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"AddImageViewer",parameter:[f]};h=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(j),null,null)}if(h){var k=new b.ImageViewer(l._dwsObject,g,f);d._imageViewerDic[g]={dwsObject:l._dwsObject,imageViewer:k,imgViewerClientId:f};k.ui.setImageViewMode(1,1)}return h};a.prototype.removeImageViewer=function(g){var l=this,f=false,k=d._imageViewerDic[g],j=k.imageViewer,h={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"RemoveImageViewer",parameter:[j._imgViewerId]};f=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(h),null,null);if(f){j.ui._destory(true);j.image._destory(true);j.io._destory(true);delete d._imageViewerDic[g]}return f};b.ImageViewerManager=a})(dynamsoft.lib,dynamsoft.dcsEnv,dynamsoft.lib.sdk);(function(d,b){function a(g,f,e){var h=this;this._innerIndex=d.guid();h._dwsObject=g;h._imgViewerId=e;h.image=new b.Image(g,h);h.ui=new b.UI(g,h,f);h.io=new b.IO(g,h)}b.ImageViewer=a})(dynamsoft.lib,dynamsoft.lib.sdk);(function(o,l,s,b){var a=[],g={None:4,FitToWindow:0},q={UP:0,DOWN:1,LEFT:2,RIGHT:3},j={ZOOMIN:0,ZOOMOUT:1};LENGTHCONSTANT=s._uiMaxSize,MINZOOM=.02,MAXZOOM=65;function f(B,w,A){var y=this;y._dwsObject=B;y._imageViewer=w;y._imageContainerId=A;y._userImageContainer=o.one("#"+A).getEL();o.empty(y._userImageContainer);var z=o.getElDimensions(y._userImageContainer,false);y._userImageViewerWidth=z?z.clientWidth:y._userImageContainer.clientWidth;y._userImageViewerHeight=z?z.clientHeight:y._userImageContainer.clientHeight;y._userImageContainer.innerHTML='<div class="ds-dws-img-viewer-wrapper" oncontextmenu="return false;"><div class="ds-dws-img-viewer-container ds-dws-display-inline-block"></div></div>';y._imageContainerWrapper=o.one(".ds-dws-img-viewer-wrapper",y._userImageContainer).getEL();y._imageContainerWrapper.style.width=y._userImageViewerWidth+"px";y._imageContainerWrapper.style.height=y._userImageViewerHeight+"px";y._imageContainerWrapper.style.position="relative";y._bFocus=false;var x=function(){y._bFocus=true};o.addEventListener(y._imageContainerWrapper,"mouseover",x);var u=function(){y._bFocus=false};o.addEventListener(y._imageContainerWrapper,"mouseout",u);var v=function(){return false};o.addEventListener(y._imageContainerWrapper,"selectstart",v);var t=function(D){D=D||window.event;if(!y._bFocus||y._bSingleMode||y._bVerticalMode){return true}var E=o.getWheelDelta(D);o.stopPropagation(D);y._imageContainerWrapper.scrollLeft-=E*120;return false};o.addEventListener(y._imageContainerWrapper,"mousewheel",t);var C=function(){if(!y._bFocus||!y._bSingleMode||!y._fitToWindowType){return true}y._calImgCtrlActualCentralPoint();return false};o.addEventListener(y._imageContainerWrapper,"scroll",C);y._onImgContainerWrapperScroll=C;f.prototype._removeImgContainerWrapperEvents=function(){o.removeEventListener(this._imageContainerWrapper,"mouseover",x);o.removeEventListener(this._imageContainerWrapper,"mouseout",u);o.removeEventListener(this._imageContainerWrapper,"selectstart",v);o.removeEventListener(this._imageContainerWrapper,"mousewheel",t);o.removeEventListener(this._imageContainerWrapper,"scroll",C)};y._imageContainerBox=o.one(".ds-dws-img-viewer-container",y._imageContainerWrapper).getEL();y._imageContainerBox.style.position="relative";y._imageMargin=-1;y._calcImageMargin=-1;y._borderWidth=1;y._selectedImageBorderWidth=1;y._calcSelectedImageBorderWidth=1;y._selectedBorderColor=2107821823;y._mouseShape=false;y.EnumFitToWindowType=g;y._fitToWindowType=g.FitToWindow;y._imagesPerRow=0;y._imagesPerColumn=0;y._bSingleMode=false;y._bVerticalMode=true;y._iControlWidth=0;y._iControlHeight=0;y._aryImageControls=[];y.imgSelector=null;y._onimageareaselected=null;y._onimageareadeselected=null;y.onmouseclick=null;y.onmouserightclick=null;y.onmousedoubleclick=null;y.onmousemove=null;y._displayMode="";y._scrollToImgCtrlIndexAfterShowed=-1;y._bAdjustNonFitToWindowImgCtrlAfterShowed=false;y._zoom=1;y._bDestoryed=false;y._bRemoved=false;y._ratio=0;a.push(y)}f.prototype._getImgViewerId=function(){return this._imageContainerId};f.prototype._getImgViewerEl=function(){try{return o.one("#"+this._imageContainerId).getEL()}catch(t){return false}};f.prototype.setSelectionRectAspectRatio=function(t){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return false}if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("value",t)||!u._dwsObject._validateValue("value",t,[0,1e4],true)){return false}u._ratio=t;return true};f.prototype.getSelectionRectAspectRatio=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._ratio};f.prototype.getMargin=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._imageMargin<1?t._calcImageMargin:t._imageMargin};f.prototype.setMargin=function(v){var w=this;if(w._bDestoryed){return false}if(!w._dwsObject._validateDivDom(w._getImgViewerId(),!0)){return false}if(!w._dwsObject._validateImgViewerExist(w._getImgViewerId(),w._bRemoved)){return false}if(!w._dwsObject._validateParamNum(arguments,1)||!w._dwsObject._validateNumberType("iValue",v)){return false}v=Math.round(v);if(v<1){w._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!w._dwsObject._validateValue("iValue",v,[1,LENGTHCONSTANT],true)){return false}if(w._imageMargin==v){return true}w._imageMargin=v;var t=w._imageContainerWrapper.scrollLeft,u=w._imageContainerWrapper.scrollTop;w._refresh();w._setScrollBarPosition(u,t);return true};f.prototype.getWidth=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._userImageViewerWidth};f.prototype.setWidth=function(u){var v=this;if(v._bDestoryed){return false}if(!v._dwsObject._validateDivDom(v._getImgViewerId(),!0)){return false}if(!v._dwsObject._validateImgViewerExist(v._getImgViewerId(),v._bRemoved)){return false}if(!v._dwsObject._validateParamNum(arguments,1)||!v._dwsObject._validateNumberType("iValue",u)){return false}u=Math.round(u);if(u<1){v._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!v._dwsObject._validateValue("iValue",u,[1,LENGTHCONSTANT],true)){return false}if(v._userImageViewerWidth==u){return true}v._userImageViewerWidth=u;var t=v._getFirstVisibleElemIndex();v._userImageContainer.style.width=u+"px";v._imageContainerWrapper.style.width=u+"px";v._refresh();v._scrollToImgCtrl(t);return true};f.prototype.getHeight=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._userImageViewerHeight};f.prototype.setHeight=function(u){var v=this;if(v._bDestoryed){return false}if(!v._dwsObject._validateDivDom(v._getImgViewerId(),!0)){return false}if(!v._dwsObject._validateImgViewerExist(v._getImgViewerId(),v._bRemoved)){return false}if(!v._dwsObject._validateParamNum(arguments,1)||!v._dwsObject._validateNumberType("iValue",u)){return false}u=Math.round(u);if(u<1){v._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!v._dwsObject._validateValue("iValue",u,[1,LENGTHCONSTANT],true)){return false}if(v._userImageViewerHeight==u){return true}v._userImageViewerHeight=u;var t=v._getFirstVisibleElemIndex();v._userImageContainer.style.height=u+"px";v._imageContainerWrapper.style.height=u+"px";v._refresh();v._scrollToImgCtrl(t);return true};f.prototype.getSelectedImageBorderWidth=function(){var t=this;if(t._bDestoryed){return null;
}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._selectedImageBorderWidth};f.prototype.setSelectedImageBorderWidth=function(v){var w=this;if(w._bDestoryed){return false}if(!w._dwsObject._validateDivDom(w._getImgViewerId(),!0)){return false}if(!w._dwsObject._validateImgViewerExist(w._getImgViewerId(),w._bRemoved)){return false}if(!w._dwsObject._validateParamNum(arguments,1)||!w._dwsObject._validateNumberType("iValue",v)){return false}v=Math.round(v);if(v<1){w._dwsObject._setErrCodeErrString(o.errorInfo.getValueOutOfRangeCode(),o.errorInfo.getValueOutOfRangeString("iValue"));return false}if(!w._dwsObject._validateValue("iValue",v,[1,LENGTHCONSTANT],true)){return false}if(w._selectedImageBorderWidth==v||w._calcSelectedImageBorderWidth==v){return true}w._selectedImageBorderWidth=v;var t=w._imageContainerWrapper.scrollLeft,u=w._imageContainerWrapper.scrollTop;w._refresh();w._setScrollBarPosition(u,t);return true};f.prototype.getMouseShape=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._mouseShape};f.prototype.setMouseShape=function(u){var v=this;if(v._bDestoryed){return false}if(!v._dwsObject._validateDivDom(v._getImgViewerId(),!0)){return false}if(!v._dwsObject._validateImgViewerExist(v._getImgViewerId(),v._bRemoved)){return false}if(!v._dwsObject._validateParamNum(arguments,1)||!v._dwsObject._validateBooleanType("iValue",u)){return false}if(v._mouseShape==u){return true}v._mouseShape=u;for(var t=0;t<v._aryImageControls.length;t++){v._aryImageControls[t].setMouseShape(u)}return true};f.prototype.getFitToWindowType=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._fitToWindowType};f.prototype.setFitToWindowType=function(t){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return false}if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("iValue",t)){return false}t=Math.round(t);if(!u._dwsObject._validateValue("iValue",t,[0,4],false)){return false}if(u._fitToWindowType==t){return true}u._fitToWindowType=t;if(u._bSingleMode){u._refresh()}return true};f.prototype.getZoom=function(){var t=this;if(t._bDestoryed){return null}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}return t._zoom};f.prototype.setZoom=function(t){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return false}if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("iValue",t)){return false}if(!u._dwsObject._validateValue("iValue",t,[MINZOOM,MAXZOOM],true)){return false}if(u._zoom==t){return true}u._zoom=t;if(!u._bSingleMode||u._fitToWindowType!=g.None){return true}u._refresh();u._bAdjustNonFitToWindowImgCtrlAfterShowed=u._bIsImageViewerHiden();return true};var e="getBackgroundColor",d="setBackgroundColor",m="getSelectedImageBorderColor",p="setSelectedImageBorderColor",n=0,h=4294967295;o.each([e,d,m,p],function(t){f.prototype[t]=function(){var u=this;if(u._bDestoryed){return false}if(!u._dwsObject._validateDivDom(u._getImgViewerId(),!0)){return t==e||t==m?undefined:false}if(!u._dwsObject._validateImgViewerExist(u._getImgViewerId(),u._bRemoved)){return t==e||t==m?undefined:false}if(t==e||t==m){if(!u._dwsObject._validateParamNum(arguments,0)){return null}}if(t==d||t==p){if(!u._dwsObject._validateParamNum(arguments,1)||!u._dwsObject._validateNumberType("iValue",arguments[0])||!u._dwsObject._validateValue("iValue",arguments[0],[n,h],true)){return false}}if(t==e){return o.colorStrToInt(u._userImageContainer.style.backgroundColor?u._userImageContainer.style.backgroundColor:o.currentStyle(u._userImageContainer,"background-color"))}if(t==d){u._userImageContainer.style.backgroundColor=o.IntToColorStr(arguments[0]);return true}if(t==m){return u._selectedBorderColor}if(t==p){u._selectedBorderColor=arguments[0];u._refresh();return true}}});o.each(["getContainerId","show","hide"],function(t){f.prototype[t]=function(){var v=this;if(v._bDestoryed){return t=="getContainerId"?null:false}var u=v._getImgViewerId();if(!v._dwsObject._validateDivDom(u,!0)){return t=="getContainerId"?null:!1}if(!v._dwsObject._validateImgViewerExist(v._getImgViewerId(),v._bRemoved)){return t=="getContainerId"?null:!1}if(!v._dwsObject._validateParamNum(arguments,0)){return t=="getContainerId"?null:!1}if(t=="getContainerId"){return u}if(t=="show"){v._displayMode=v._displayMode=="none"?"":v._displayMode;if(v._userImageContainer.style.display=="none"){v._userImageContainer.style.display=v._displayMode}else{v._displayMode=v._userImageContainer.style.display}if(v._scrollToImgCtrlIndexAfterShowed!=-1){v._scrollToImgCtrl(v._scrollToImgCtrlIndexAfterShowed)}v._scrollToImgCtrlIndexAfterShowed=-1;if(v._bAdjustNonFitToWindowImgCtrlAfterShowed&&v._bSingleMode&&v._fitToWindowType){v._showNonFitToWinImgCtrl()}v._bAdjustNonFitToWindowImgCtrlAfterShowed=false}if(t=="hide"){if(v._userImageContainer.style.display!="none"){v._displayMode=v._userImageContainer.style.display}v._userImageContainer.style.display="none";v._displayMode=v._displayMode=="none"?"":v._displayMode}return!0}});f.prototype._bIsImageViewerHiden=function(){return this._userImageContainer.style.display=="none"};f.prototype.setImageViewMode=function(v,y){var z=this;if(z._bDestoryed){return false}if(!z._dwsObject._validateDivDom(z._getImgViewerId(),!0)){return false}if(!z._dwsObject._validateImgViewerExist(z._getImgViewerId(),z._bRemoved)){return false}if(!z._dwsObject._validateParamNum(arguments,2)||!z._dwsObject._validateNumberType("column",v)||!z._dwsObject._validateNumberType("row",y)){return false}v=Math.round(v);y=Math.round(y);if(v==-1&&y!=-1||v>0&&y!=-1&&y<=0){z._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("row"));return false}if(y==-1&&v!=-1&&v<=0||y>0&&v<=0){z._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("column"));return false}if(v==0&&y==0){z._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("column"));return false}if(v<-1){z._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("column"));return false}if(y<-1){z._dwsObject._setErrCodeErrString(o.errorInfo.getValueNotValidCode(),o.errorInfo.getValueNotValidString("row"));return false}var x=z._bSingleMode,u=z._bVerticalMode,w=z._imagesPerRow,t=z._imagesPerColumn;if(v==-1&&y==-1){z._bSingleMode=true;z._bVerticalMode=false;z._imagesPerColumn=1;z._imagesPerRow=1}else{if(v>0&&y==-1){z._bSingleMode=false;z._bVerticalMode=false;z._imagesPerColumn=v;z._imagesPerRow=1}else{if(v>0&&y>0){z._bSingleMode=false;z._bVerticalMode=true;z._imagesPerColumn=v;z._imagesPerRow=y}}}if(x==z._bSingleMode&&u==z._bVerticalMode&&t==z._imagesPerColumn&&w==z._imagesPerRow){return true}z._refresh();if(!z._bSingleMode){z._scrollToImgCtrl(0)}else{z._imageViewer.image._innerSetIndexInfo(null,null,z._imageViewer.image.getIndex(),[z._imageViewer.image.getIndex()],false,false)}return true};f.prototype._addImageControl=function(u){var w=this;var t=w._imageViewer.image._innerIncCount();w._imageViewer.image._innerSetIndexInfo(null,null,t-1,[t-1],false,false);var v=new l.ImageControl(w._dwsObject,w._mouseShape,w._imageViewer);v.imageIndex=w._imageViewer.image.getIndex();v.iImageViewerWidth=w._userImageViewerWidth;v.iImageViewerHeight=w._userImageViewerHeight;v.borderWidth=w._borderWidth;v.selectionBorderWidth=w._calcSelectedImageBorderWidth;v.selectionBorderColor=w._selectedBorderColor;w._attachImgControlEventHandlers(v);w._aryImageControls.push(v);w._refresh();w._imageContainerBox.appendChild(v.outerDiv);w._scrollToImgCtrl(v.imageIndex);u=u||[b.preUrl,b.portInfo.curPort,"/",s._getVersionStrForCommand(),"/img?session=",b.sessionId,"&object=",w._dwsObject._dwsObjectId,"&imageviewer=",w._imageViewer._imgViewerId,"&index=",w._imageViewer.image.getIndex()].join("");v.attachImage(u)};f.prototype._involkeUserMouseEventHandler=function(t,v){var u=this;if(!o.isFunction(u[t])&&!o.isNull(u[t])){u._dwsObject._setErrCodeErrString(o.errorInfo.getTypeNotValidCode(),o.errorInfo.getTypeNotValidString(t,!0))}else{if(!o.isNull(u[t])){u._dwsObject._setErrCodeErrString(o.errorInfo.getOkCode(),o.errorInfo.getOkString());setTimeout(function(){u[t](v.index,v.mouseX,v.mouseY)},0)}}};f.prototype._attachImgControlEventHandlers=function(u){if(!(u instanceof o.sdk.ImageControl)){return}var t=this;u.onMouseClick=function(v){t._onMouseClick(v);t._involkeUserMouseEventHandler("onmouseclick",v)};u.onMouseDoubleClick=function(v){t._involkeUserMouseEventHandler("onmousedoubleclick",v)};u.onMouseRightClick=function(v){t._involkeUserMouseEventHandler("onmouserightclick",v)};u.onMouseMove=function(v){t._involkeUserMouseEventHandler("onmousemove",v)};u.onImageAreaSelected=function(w){var v=w.imgSelector;t.imgSelector=w.imgSelector;if(!o.isFunction(t._onimageareaselected)&&!o.isNull(t._onimageareaselected)){t._dwsObject._setErrCodeErrString(o.errorInfo.getTypeNotValidCode(),o.errorInfo.getTypeNotValidString("_onimageareaselected",!0));return}if(!o.isNull(t._onimageareaselected)){setTimeout(function(){t._onimageareaselected(v.imgCtrl.imageIndex,v.actualImgRect.left,v.actualImgRect.top,v.actualImgRect.right,v.actualImgRect.bottom)},0)}};u.onImageDraggingFinished=function(){t._calImgCtrlActualCentralPoint()};u.onImageAreaDeSelected=function(){if(!(t.imgSelector instanceof o.sdk.ImageSelector)||t.imgSelector.bDestroy||!t.imgSelector.isValidSelector()||t.imgSelector.imgCtrl.imageIndex<0||t.imgSelector.imgCtrl.imageIndex>t._imageViewer.image._getCount()-1){if(t.imgSelector){t.imgSelector.hide()}t.imgSelector=null;return}if(!o.isFunction(t._onimageareadeselected)&&!o.isNull(t._onimageareadeselected)){t._dwsObject._setErrCodeErrString(o.errorInfo.getTypeNotValidCode(),o.errorInfo.getTypeNotValidString("_onimageareadeselected",!0));t.imgSelector.hide();t.imgSelector=null;return}var v=t.imgSelector.imgCtrl.imageIndex;t.imgSelector.hide();t.imgSelector.clearRect();t.imgSelector=null;if(!o.isNull(t._onimageareadeselected)){setTimeout(function(){t._onimageareadeselected(v)},0)}};u.onImageDragging=function(v){t._setScrollBarPosition(t._imageContainerWrapper.scrollTop+v.deltaY,t._imageContainerWrapper.scrollLeft+v.deltaX)}};f.prototype._onMouseClick=function(x){var C=this;var z=0,F=0,J=x.index,u=C._imageViewer.image._getIndex(),y=C._imageViewer.image._getSelectedIndices().slice().sort(function(L,K){return L-K}),v=-1,I=C._imageViewer.image._getSelectedIndices().slice().sort(function(L,K){return L-K}),H=I.indexOf(J),t=x.e.ctrlKey,E=x.e.shiftKey,D=x.e.metaKey;var B=function(K){var L=C._aryImageControls[K];if(L&&L.imgSelector){L.imgSelector.bNeedResize=!0}};if(H==-1){if(t||E||D||I.length<1){I.push(J)}else{if(I.length==1){if(I[0]==J){B(J);return}I[0]=J}else{I=[];I.push(J)}}}else{if((t||D)&&I.length>1){I.splice(H,1)}else{if(E){I.push(J)}else{if(I.length==1&&u==J){B(J);return}I=[];I.push(J)}}}if(E){var G=I[0],A=I[I.length-1];I=[];if(A==G){I.push(parseInt(G))}else{if(A>G){F=A-G+1;for(z=0;z<F;z++){I.push(parseInt(G+z))}}else{F=G-A+1;I.push(parseInt(G));for(z=0;z<F-1;z++){I.push(parseInt(A+z))}}}}I.sort(function(L,K){return L-K});if(I.indexOf(J)!=-1){v=J}else{if(I.indexOf(u)==-1){var w=I.length;for(z=0;z<I.length;z++){if(I[z]>u){w=z;break}}v=w<I.length?I[w]:I[z-1]}else{v=u}}C._imageViewer.image._innerSetIndexInfo(u,y,v,I,true,false)};f.prototype.getImageSelectedAreaInfo=function(){var t=this;if(t._bDestoryed){return false}if(!t._dwsObject._validateDivDom(t._getImgViewerId(),!0)){return null}if(!t._dwsObject._validateImgViewerExist(t._getImgViewerId(),t._bRemoved)){return null}if(!t._dwsObject._validateParamNum(arguments,0)){return null}if(!(t.imgSelector instanceof o.sdk.ImageSelector)||t.imgSelector.bDestroy||!t.imgSelector.isValidSelector()||t.imgSelector.imgCtrl.imageIndex<0||t.imgSelector.imgCtrl.imageIndex>t._imageViewer.image._getCount()-1){return null}return new k(t.imgSelector.imgCtrl.imageIndex,t.imgSelector.actualImgRect.left,t.imgSelector.actualImgRect.top,t.imgSelector.actualImgRect.right,t.imgSelector.actualImgRect.bottom)};f.prototype._performLeftKeyOperation=function(){this._performArrowKeyOpertion(q.LEFT)};f.prototype._performRightKeyOperation=function(){this._performArrowKeyOpertion(q.RIGHT)};f.prototype._performUpKeyOperation=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performArrowKeyOpertion(q.UP)};f.prototype._performDownKeyOperaton=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performArrowKeyOpertion(q.DOWN)};f.prototype._performPageUpKeyOperation=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performPageUpDownOperation(true)};f.prototype._performPageDownKeyOperation=function(){var t=this;if(!t._bSingleMode&&!t._fitToWindowType&&!t._bVerticalMode){return}t._performPageUpDownOperation(false)};f.prototype._performHomeKeyOperation=function(){this._setScrollBarPosition(0,0)};f.prototype._performEndKeyOperation=function(){var t=this;if(t._bSingleMode){t._setScrollBarPosition(t._imageContainerWrapper.scrollHeight,t._imageContainerWrapper.scrollWidth)}else{if(t._bVerticalMode){t._setScrollBarPosition(t._imageContainerWrapper.scrollHeight,0)}else{t._setScrollBarPosition(0,t._imageContainerWrapper.scrollWidth)}}};f.prototype._performPageUpDownOperation=function(t){var w=this;if(!w._bSingleMode){var u=w._getFirstVisibleElemIndex(),v;if(t){v=u-w._imagesPerColumn*w._imagesPerRow;v=v<0?0:v}else{v=u+w._imagesPerColumn*w._imagesPerRow;v=v>w._imageViewer.image._count-1?w._imageViewer.image._count-1:v}w._scrollToImgCtrl(v)}else{if(w._fitToWindowType){if(t){w._imageContainerWrapper.scrollTop-=w._userImageViewerHeight-w._imageMargin}else{w._imageContainerWrapper.scrollTop+=w._userImageViewerHeight-w._imageMargin}}}};f.prototype._performArrowKeyOpertion=function(x){var y=this;if(!y._bSingleMode){var v=-1,t=y._imageViewer.image.getIndex(),w=y._aryImageControls[t],u;switch(x){case q.UP:v=t-y._imagesPerColumn;break;case q.DOWN:v=t+y._imagesPerColumn;break;case q.LEFT:v=t-1;break;case q.RIGHT:v=t+1;break;default:break}u=y._aryImageControls[v];if(!w||!u){return}y._imageViewer.image._innerSetIndexInfo(t,y._imageViewer.image.getSelectedIndices(),v,[v],true,true)}else{if(y._fitToWindowType){switch(x){case q.UP:y._setScrollBarPosition(y._imageContainerWrapper.scrollTop-y._imageContainerWrapper.scrollHeight*.05,undefined);break;case q.DOWN:y._setScrollBarPosition(y._imageContainerWrapper.scrollTop+y._imageContainerWrapper.scrollHeight*.05,undefined);break;case q.LEFT:y._setScrollBarPosition(undefined,y._imageContainerWrapper.scrollLeft-y._imageContainerWrapper.scrollWidth*.05);break;case q.RIGHT:y._setScrollBarPosition(undefined,y._imageContainerWrapper.scrollLeft+y._imageContainerWrapper.scrollWidth*.05);break;default:break}y._calImgCtrlActualCentralPoint()}}};f.prototype._performZoomOpertion=function(t){if(t!=j.ZOOMIN&&t!=j.ZOOMOUT){return}var v=this;if(t===j.ZOOMIN&&v._zoom===MAXZOOM||t===j.ZOOMOUT&&v._zoom===MINZOOM){return}var u=v._zoom*(t==j.ZOOMIN?1.2:.8);if(u<MINZOOM){v._zoom=MINZOOM}else{if(u>MAXZOOM){v._zoom=MAXZOOM}else{v._zoom=u}}v._refresh()};f.prototype._keydownEventHandler=function(u){var t=true,v=this;if(!v._bFocus){return t}switch(u.keyCode){case 37:t=false;v._performLeftKeyOperation();break;case 39:t=false;v._performRightKeyOperation();break;case 38:t=false;v._performUpKeyOperation();break;case 40:t=false;v._performDownKeyOperaton();break;case 33:t=false;v._performPageUpKeyOperation();break;case 34:t=false;v._performPageDownKeyOperation();break;case 35:t=false;v._performEndKeyOperation();break;case 36:t=false;v._performHomeKeyOperation();break;case 82:break;case 107:t=false;v._performZoomOpertion(j.ZOOMIN);break;case 109:t=false;v._performZoomOpertion(j.ZOOMOUT);break;default:break}if(!t){o.stopPropagation(u)}return t};var r=function(u){u=u||window.event;var t=true;o.each(a,function(v){if(v instanceof dynamsoft.lib.sdk.UI){if(v._bFocus){t=v._keydownEventHandler(u);if(!t){return false}}else{return t}}});return t};o.addEventListener(document.documentElement,"keydown",r);f.prototype._refreshIndexInfo=function(B,E,v,w,z,t){var y=this,D,x,A=[],u=y._imageContainerWrapper.scrollLeft,C=y._imageContainerWrapper.scrollTop;for(x=0;x<E.length;x++){if(w.indexOf(E[x])==-1){continue}A.push(E[x])}if(t){A=[]}for(x=0;x<E.length;x++){D=y._aryImageControls[E[x]];if(null!=D&&A.indexOf(E[x])==-1){D.bIfCurrentIndex=false;D.refresh(y._iControlWidth,y._iControlHeight);D.setSelect(false)}}for(x=0;x<w.length;x++){D=y._aryImageControls[w[x]];if(null!=D&&A.indexOf(w[x])==-1){if(w[x]==v){D.bIfCurrentIndex=true}D.refresh(y._iControlWidth-(y._calcSelectedImageBorderWidth-y._borderWidth)*2,y._iControlHeight-(y._calcSelectedImageBorderWidth-y._borderWidth)*2);D.setSelect(true)}}if(!y._bSingleMode&&y._bVerticalMode&&y._getHowManyRows()<=y._imagesPerRow||!y._bSingleMode&&!y._bVerticalMode&&y._imageViewer.image._count<=y._imagesPerColumn){y._refresh()}if(z){y._setImgCtrlVisible(v)}else{y._setScrollBarPosition(C,u)}};f.prototype._refreshWhenCountReduced=function(v){var y=this,t=y._imageViewer.image.getCount(),x=v-t,w;if(x<=0){return}for(var u=v-1;u>=t;u--){w=y._aryImageControls[u];if(w){y._aryImageControls.splice(u,1);w.destroy()}}y._refresh()};f.prototype._setScrollBarPosition=function(u,t){if(u!=undefined||u!=null){this._imageContainerWrapper.scrollTop=u}if(t!=undefined||t!=null){this._imageContainerWrapper.scrollLeft=t}};f.prototype._scrollToImgCtrl=function(t){var v=this;if(v._bSingleMode||t<0||t>=v._aryImageControls.length){return}var u=o.all(".ds-dws-img-container",v._imageContainerBox)[t];if(!u){return}if(v._bIsImageViewerHiden()){v._scrollToImgCtrlIndexAfterShowed=t}if(v._bVerticalMode){v._setScrollBarPosition(u.offsetTop-v._calcImageMargin,undefined)}else{v._setScrollBarPosition(undefined,u.offsetLeft-v._calcImageMargin)}};f.prototype._setImgCtrlVisible=function(t){var w=this;if(w._bSingleMode||t<0||t>=w._aryImageControls.length){return}var u=w._getVisibleElemIndices();if(u.length==0){return}if(u.indexOf(t)==-1){if(t<u[u.length-1]){w._scrollToImgCtrl(t)}else{var v=w._bVerticalMode?(parseInt((t+w._imagesPerColumn)/w._imagesPerColumn)-w._imagesPerRow)*w._imagesPerColumn:(parseInt((t+w._imagesPerRow)/w._imagesPerRow)-w._imagesPerColumn)*w._imagesPerRow;v=v<0?0:v;v=v>=w._aryImageControls.length?w._aryImageControls.length-1:v;w._scrollToImgCtrl(v)}}else{w._scrollToImgCtrl(u[0])}};f.prototype._getFirstVisibleElemIndex=function(){var z=this;if(z._imageViewer.image._count==0){return-1}if(z._bSingleMode){return z._imageViewer.image.getIndex()}else{if(z._bVerticalMode){var x=z._imageContainerWrapper.scrollHeight,w=z._imageContainerWrapper.scrollTop,v;if(w<=0||x<=0){return 0}v=Math.round(w*z._getHowManyRows()/x);return v*z._imagesPerColumn}else{var t=z._imageContainerWrapper.scrollWidth,u=z._imageContainerWrapper.scrollLeft,y;if(u<=0||t<=0){return 0}y=Math.round(u*z._getHowManyCols()/t);return y*z._imagesPerRow}}};f.prototype._getVisibleElemIndices=function(){var t=this._getFirstVisibleElemIndex(),v=[];for(var u=0;u<this._imagesPerRow*this._imagesPerColumn;u++){v.push(t+u)}return v};f.prototype._getHowManyRows=function(){return parseInt((this._imageViewer.image._count+this._imagesPerColumn-1)/this._imagesPerColumn)};f.prototype._getHowManyCols=function(){return parseInt((this._imageViewer.image._count+this._imagesPerRow-1)/this._imagesPerRow)};f.prototype._getScrollBarWidth=function(){if(s.navInfo.scrollBarWidth){return s.navInfo.scrollBarWidth}var v=document.createElement("p");v.style.width="100%";v.style.height="200px";var w=document.createElement("div");w.style.position="absolute";w.style.top="0px";w.style.left="0px";w.style.visibility="hidden";w.style.width="200px";w.style.height="150px";w.style.overflow="hidden";w.appendChild(v);document.body.appendChild(w);var u=v.offsetWidth;w.style.overflow="scroll";var t=v.offsetWidth;if(u==t){t=w.clientWidth}document.body.removeChild(w);s.navInfo.scrollBarWidth=u-t;return s.navInfo.scrollBarWidth};f.prototype._calcControlsSize=function(){var z=this;if(z._imageMargin!=-1){z._calcImageMargin=z._imageMargin}if(!z._bSingleMode){var x=z._getScrollBarWidth();if(z._bVerticalMode){if(z._getHowManyRows()<=z._imagesPerRow){x=0}if(z._imageMargin==-1){var w=parseInt(z._userImageViewerHeight/(z._imagesPerRow*10));var y=parseInt((z._userImageViewerWidth-x)/(z._imagesPerColumn*10));var v=Math.min(w,y);if(z._calcImageMargin<=0){z._calcImageMargin=parseInt(v)}else{z._calcImageMargin=parseInt(z._calcImageMargin<v?z._calcImageMargin:v)}}}else{if(z._imageViewer.image._count<=z._imagesPerColumn){x=0}if(z._imageMargin==-1){var w=parseInt((z._userImageViewerHeight-x)/(z._imagesPerRow*10));var y=parseInt(z._userImageViewerWidth/(z._imagesPerColumn*10));var v=w<y?w:y;if(z._calcImageMargin<=0){z._calcImageMargin=parseInt(v)}else{z._calcImageMargin=parseInt(z._calcImageMargin<v?z._calcImageMargin:v)}}}if(z._imagesPerColumn==z._imagesPerRow&&z._imagesPerRow==1){z._calcImageMargin=0}var t=0;var u=0;if(z._bVerticalMode==true){t=z._userImageViewerHeight-z._calcImageMargin;u=z._userImageViewerWidth-x-z._calcImageMargin}else{t=z._userImageViewerHeight-x-z._calcImageMargin;u=z._userImageViewerWidth-z._calcImageMargin}z._iControlWidth=parseInt(u/z._imagesPerColumn-z._calcImageMargin)-2*z._borderWidth;z._iControlHeight=parseInt(t/z._imagesPerRow-z._calcImageMargin)-2*z._borderWidth;if(z._iControlWidth<0||z._iControlHeight<0){if(z._iControlWidth<z._iControlHeight){z._iControlWidth=0;z._calcImageMargin=parseInt((z._userImageViewerWidth-(z._bVerticalMode?x:0)-2*z._borderWidth*z._imagesPerColumn)/(z._imagesPerColumn+1));t=z._userImageViewerHeight-(z._bVerticalMode?0:x)-z._calcImageMargin;z._iControlHeight=parseInt(t/z._imagesPerRow-z._calcImageMargin)-2*z._borderWidth}else{z._iControlHeight=0;z._calcImageMargin=parseInt((z._userImageViewerHeight-(z._bVerticalMode?0:x)-2*z._borderWidth*z._imagesPerRow)/(z._imagesPerRow+1));u=z._userImageViewerWidth-(z._bVerticalMode?x:0)-z._calcImageMargin;z._iControlWidth=parseInt(u/z._imagesPerColumn-z._calcImageMargin)-2*z._borderWidth}}}else{z._calcImageMargin=0;z._iControlWidth=z._userImageViewerWidth-2*z._borderWidth;z._iControlHeight=z._userImageViewerHeight-2*z._borderWidth}z._iControlWidth=z._iControlWidth<0?0:z._iControlWidth;z._iControlHeight=z._iControlHeight<0?0:z._iControlHeight};f.prototype._getImgCtrlWithCurIndex=function(){return this._aryImageControls[this._imageViewer.image._index]};f.prototype._calImgCtrlActualCentralPoint=function(){var x=this,v=x._getImgCtrlWithCurIndex();if(!(v instanceof l.ImageControl)){return}if(!(v.bSingleMode&&!v.bIfFitWindow&&v.bIfCurrentIndex)){return}var u={x:0,y:0},t=v.curImageWidth>x._userImageViewerWidth?x._getScrollBarWidth():0,w=v.curImageHeight>x._userImageViewerHeight?x._getScrollBarWidth():0;u.x=x._imageContainerWrapper.scrollLeft+(x._userImageViewerWidth-t)/2;u.y=x._imageContainerWrapper.scrollTop+(x._userImageViewerHeight-w)/2;v.actaulCentralPoint.x=u.x/v.curImageWidth*v.origImageWidth;v.actaulCentralPoint.y=u.y/v.curImageHeight*v.origImageHeight;if(v.curImageWidth<=x._userImageViewerWidth){v.actaulCentralPoint.x=v.origImageWidth/2}if(v.curImageHeight<=x._userImageViewerHeight){v.actaulCentralPoint.y=v.origImageHeight/2}if(v.actaulCentralPoint.x<0||v.actaulCentralPoint.x>v.origImageWidth){v.actaulCentralPoint.x=0}if(v.actaulCentralPoint.y<0||v.actaulCentralPoint.y>v.origImageHeight){v.actaulCentralPoint.y=0}};f.prototype._showImgCtrlAfterZoom=function(){var z=this,w=z._getImgCtrlWithCurIndex();if(!(w instanceof l.ImageControl)){return}if(!(w.bSingleMode&&!w.bIfFitWindow&&w.bIfCurrentIndex)||w.actaulCentralPoint.x==-1||w.actaulCentralPoint.y==-1){return}var u={},x,v,t=w.curImageWidth>z._userImageViewerWidth?z._getScrollBarWidth():0,y=w.curImageHeight>z._userImageViewerHeight?z._getScrollBarWidth():0;u.x=w.actaulCentralPoint.x/w.origImageWidth*w.curImageWidth;u.y=w.actaulCentralPoint.y/w.origImageHeight*w.curImageHeight;x=u.x-(z._userImageViewerWidth-t)/2;v=u.y-(z._userImageViewerHeight-y)/2;z._setScrollBarPosition(v,x);if(w.curImageWidth<=z._userImageViewerWidth){w.actaulCentralPoint.x=w.origImageWidth/2}if(w.curImageHeight<=z._userImageViewerHeight){w.actaulCentralPoint.y=w.origImageHeight/2}};f.prototype._showNonFitToWinImgCtrl=function(t,v){var u=this;o.removeEventListener(u._imageContainerWrapper,"scroll",u._onImgContainerWrapperScroll);if(t){u._calImgCtrlActualCentralPoint()}u._showImgCtrlAfterZoom();if(o.isFunction(v)){v()}u._imageContainerWrapper.style.overflow="hidden";setTimeout(function(){u._imageContainerWrapper.style.overflow="auto";setTimeout(function(){o.addEventListener(u._imageContainerWrapper,"scroll",u._onImgContainerWrapperScroll)},100)},50)};f.prototype._refresh=function(){var y=this;y._calcControlsSize();var A=y._imagesPerColumn*6>y._iControlWidth/3?y._iControlWidth/3:y._imagesPerColumn*6;if(y._bSingleMode){y._imageContainerBox.style.padding="0px";y._imageContainerBox.style.width="";y._imageContainerBox.style.height="";y._imageContainerBox.style.whiteSpace="";y._imageContainerWrapper.style.overflowX=!y._fitToWindowType?"hidden":"auto";y._imageContainerWrapper.style.overflowY=!y._fitToWindowType?"hidden":"auto"}else{y._imageContainerWrapper.style.overflow="hidden";y._imageContainerBox.style.padding=y._calcImageMargin/2+"px";if(y._bVerticalMode){y._imageContainerBox.style.width=y._userImageViewerWidth+A-y._calcImageMargin+"px";y._imageContainerBox.style.height="";y._imageContainerBox.style.whiteSpace="";y._imageContainerWrapper.scrollLeft=0}else{y._imageContainerBox.style.width="";y._imageContainerBox.style.height=y._userImageViewerHeight-y._calcImageMargin+"px";y._imageContainerBox.style.whiteSpace="nowrap";y._setScrollBarPosition(0)}}var u=Math.min(y._iControlWidth,y._iControlHeight),B;y._calcSelectedImageBorderWidth=u<=2*y._selectedImageBorderWidth?u/2:y._selectedImageBorderWidth;y._calcSelectedImageBorderWidth=y._calcSelectedImageBorderWidth<1?1:y._calcSelectedImageBorderWidth;B=y._calcSelectedImageBorderWidth-y._borderWidth;for(var x=0;x<y._aryImageControls.length;x++){var z=y._aryImageControls[x],t;z.iImageControlMargin=y._calcImageMargin;z.bIfCurrentIndex=z.imageIndex==y._imageViewer.image._getIndex();z.bSingleMode=y._bSingleMode;z.bIfFitWindow=!y._fitToWindowType;z.selectionBorderWidth=y._calcSelectedImageBorderWidth;z.selectionBorderColor=y._selectedBorderColor;z.zoom=y._zoom;if(!z.bIfCurrentIndex||!y._bSingleMode||!y._fitToWindowType){z.actaulCentralPoint.x=-1;z.actaulCentralPoint.y=-1}t=y._imageViewer.image._selectedIndices.indexOf(z.imageIndex)!=-1;z.refresh(y._iControlWidth-(t?B*2:0),y._iControlHeight-(t?B*2:0));z.setSelect(t);if(!y._bSingleMode){y._imageContainerWrapper.style.overflowX="hidden";y._imageContainerWrapper.style.overflowY="hidden";if(y._bVerticalMode){var w=parseInt((x+y._imagesPerColumn)/y._imagesPerColumn)>y._imagesPerRow;if(w){y._imageContainerWrapper.style.overflowY="auto";y._imageContainerBox.style.width=y._userImageViewerWidth+A-y._calcImageMargin-y._getScrollBarWidth()+"px"}}else{var v=parseInt((x+y._imagesPerRow)/y._imagesPerRow)>y._imagesPerColumn;if(v){y._imageContainerWrapper.style.overflowX="auto";y._imageContainerBox.style.height=y._userImageViewerHeight-y._calcImageMargin-y._getScrollBarWidth()+"px"}}}}};f.prototype._destory=function(t){var w=this;for(var v=0;v<w._aryImageControls.length;v++){w._aryImageControls[v].destroy()}w._removeImgContainerWrapperEvents();var u=a.indexOf(w);if(u!=-1){a.splice(u,1)}o.empty(w._userImageContainer);if(!t){w._bDestoryed=true}else{w._bRemoved=true}};function k(u,x,w,v,t){this.index=u;this.left=x;this.top=w;this.right=v;this.bottom=t}f.prototype.ImageSelectedAreaInfo=k;l.ImageSelectedAreaInfo=k;l.UI=f})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(h,f,d){var g={NEARESTNEIGHBOUR:1,BILINEAR:2,BICUBIC:3};function e(k,j){var l=this;l._dwsObject=k;l._imageViewer=j;l._capacity=1023;l._count=0;l._index=-1;l._selectedIndices=[];l._bEdit=false;l.EnumInterpolationMethod=g;l._bDestoryed=false;l._bRemoved=false}e.prototype.editDocument=function(p,m){var l=this;if(l._bDestoryed){return false}if(l._dwsObject._bDestoryed){return false}if(!l._dwsObject._validateParamNum(arguments,2)||!l._dwsObject._validateStringType("documentEditorContainerId",p)||!l._dwsObject._validateNumberType("index",m)){return false}if(m<0||m>l._getCount()-1){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return false}if(!l._dwsObject._validateDivDom(p,"document")){return false}var j=l._dwsObject.getDocumentEditor(p);if(!j||!l._dwsObject._validateDocEditorExist(p,j.ui._bRemoved)){return false}if(l._imageViewer.io._validateImgIsHandlingAsyncOperation()){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"EditDocument",parameter:[j._docEditorId,l._imageViewer._imgViewerId,m,l._bEdit]},n=function(s){j.documentCtrl.attachDocument()},q=function(s){};var r=h.detect.postSyncCommand(l._dwsObject,h.stringify(k),n,q);if(r){l._bEdit=false;j.imageViewer=l._imageViewer;return true}else{if(l._dwsObject.getErrorCode()==-3001){var o;if(h.isFunction(j.document.ondiscardmodified)){o=j.document.ondiscardmodified()}else{o=j.document.ondiscardmodified}if(o==true){l._dwsObject._setErrCodeErrString(h.errorInfo.getOperationCancelledCode(),h.errorInfo.getOperationCancelledString());return false}else{l._bEdit=true;l.editDocument(p,m);return true}}else{return false}}};e.prototype.getCapacity=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._capacity};e.prototype._getCapacity=function(){return this._capacity};e.prototype.setCapacity=function(m){var n=this;if(n._bDestoryed){return false}if(!n._dwsObject._validateDivDom(n._imageViewer.ui._getImgViewerId(),!0)){return false}if(!n._dwsObject._validateImgViewerExist(n._imageViewer.ui._getImgViewerId(),n._bRemoved)){return false}if(!n._dwsObject._validateParamNum(arguments,1)||!n._dwsObject._validateNumberType("iValue",m)){return false}var k=((0|1<<31)>>>0)-1;m=Math.round(m);if(!n._dwsObject._validateValue("iValue",m,[1,k],true)){return false}var l={session:d.sessionId,object:n._dwsObject._dwsObjectId,method:"SetCapacity",parameter:[n._imageViewer._imgViewerId,m]};var j=h.detect.postSyncCommand(n._dwsObject,h.stringify(l),null,null);if(j){n._innerSetCapacity(m)}return j};e.prototype.getCount=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._count};e.prototype._getCount=function(){return this._count};e.prototype.getIndex=function(){
var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._index};e.prototype._getIndex=function(){return this._index};e.prototype.setIndex=function(j){var k=this;if(k._bDestoryed){return false}if(!k._dwsObject._validateDivDom(k._imageViewer.ui._getImgViewerId(),!0)){return false}if(!k._dwsObject._validateImgViewerExist(k._imageViewer.ui._getImgViewerId(),k._bRemoved)){return false}if(!k._dwsObject._validateParamNum(arguments,1)||!k._dwsObject._validateNumberType("iValue",j)){return false}j=Math.round(j);if(!k._count){return k._dwsObject._validateValue("iValue",j,[-1],false)}else{if(j<0||j>=k._count){k._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("iValue"));return false}k._innerSetIndexInfo(k._index,k._selectedIndices,j,[j],true,true);k._dwsObject._setErrCodeErrString(h.errorInfo.getOkCode(),h.errorInfo.getOkString());return true}};e.prototype.getSelectedIndices=function(){var j=this;if(j._bDestoryed){return null}if(!j._dwsObject._validateDivDom(j._imageViewer.ui._getImgViewerId(),!0)){return null}if(!j._dwsObject._validateImgViewerExist(j._imageViewer.ui._getImgViewerId(),j._bRemoved)){return null}if(!j._dwsObject._validateParamNum(arguments,0)){return null}return j._selectedIndices};e.prototype._getSelectedIndices=function(){return this._selectedIndices};e.prototype.setSelectedIndices=function(n){var p=this;if(p._bDestoryed){return false}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return false}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return false}if(!p._dwsObject._validateParamNum(arguments,1)||!p._dwsObject._validateArrayType("iValue",n)){return false}if(p._count==0&&n.length>0||p._count>0&&n.length==0){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("iValue"));return false}for(var m=0;m<n.length;m++){if(!h.isNumber(n[m])){p._dwsObject._setErrCodeErrString(h.errorInfo.getTypeNotValidCode(),h.errorInfo.getTypeNotValidString("iValue"));return false}n[m]=Math.round(n[m]);if(n[m]<0||n[m]>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("iValue"));return false}}var o=n[n.length-1];var k=[];for(var l=0;l<n.length;l++){if(k.indexOf(n[l])===-1){k.push(n[l])}}p._innerSetIndexInfo(p._index,p._selectedIndices,o,k,true,true);return true};e.prototype.getImageInfo=function(j){var l=this,k=null;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._imageViewer.ui._getImgViewerId(),!0)){return k}if(!l._dwsObject._validateImgViewerExist(l._imageViewer.ui._getImgViewerId(),l._bRemoved)){return k}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("index",j)){return k}j=Math.round(j);if(j<0||j>l._count-1){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return k}k=l._getImageInfo(j);return k};e.prototype._getImageInfo=function(j){var n=this,m=null,k={session:d.sessionId,object:n._dwsObject._dwsObjectId,method:"GetImageInfo",parameter:[n._imageViewer._imgViewerId,j]},l=function(o){if(h.isArray(o.result)&&o.result.length>=2){m=new f.ImageInfo(n,o.result[0],o.result[1])}else{m=new f.ImageInfo(n,-1,-1)}};h.detect.postSyncCommand(n._dwsObject,h.stringify(k),l,null);return m};e.prototype.getImagePartUrl=function(j){var l=this,k=null;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._imageViewer.ui._getImgViewerId(),!0)){return k}if(!l._dwsObject._validateImgViewerExist(l._imageViewer.ui._getImgViewerId(),l._bRemoved)){return k}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("index",j)){return k}j=Math.round(j);if(j<0||j>l._count-1){l._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return k}k=["dcs://dcs_",dynamsoft.dcsEnv.bTrial?"trial_":"",dynamsoft.dcsEnv._getFrontendSdkVersionWithoutComma(),"/img?session=",d.sessionId,"&object=",l._dwsObject._dwsObjectId,"&imageviewer=",l._imageViewer._imgViewerId,"&index=",j,"&ts=",h.now()].join("");return k};e.prototype.remove=function(w){var q=this,x=!1,p;if(q._bDestoryed){return x}if(!q._dwsObject._validateDivDom(q._imageViewer.ui._getImgViewerId(),!0)){return x}if(!q._dwsObject._validateImgViewerExist(q._imageViewer.ui._getImgViewerId(),q._bRemoved)){return x}if(q._imageViewer.io._validateImgIsHandlingAsyncOperation()){return x}if(!q._dwsObject._validateParamNum(arguments,1)||!q._dwsObject._validateArrayType("indices",w)){return x}if(w.length===0){return!0}for(p=0;p<w.length;p++){if(!h.isNumber(w[p])){q._dwsObject._setErrCodeErrString(h.errorInfo.getTypeNotValidCode(),h.errorInfo.getTypeNotValidString("indices"));return x}w[p]=Math.round(w[p]);if(w[p]<0||w[p]>q._count-1){q._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("indices"));return x}}w.sort(function(y,j){return y-j});for(var n=0;n<w.length;n++){if(w[n+1]===w[n]){q._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("indices"));return x}}var o={session:d.sessionId,object:q._dwsObject._dwsObjectId,method:"ImageRemove",parameter:[q._imageViewer._imgViewerId,w]};x=h.detect.postSyncCommand(q._dwsObject,h.stringify(o),null,null);if(x){var k=q._index,l=q._selectedIndices.slice().sort(function(y,j){return y-j}),t,m,v,r,u=q._imageViewer.ui,s;for(t=w.length-1;t>=0;t--){v=w[t];s=u._aryImageControls[v];s.destroy();u._aryImageControls.splice(v,1);for(m=l.length-1;m>=0;m--){r=l[m];if(r>v){l[m]-=1}else{if(r===v){l.splice(m,1)}else{break}}}q._count-=1;if(k===v){if(k>q._count-1){k-=1}}else{if(k>v){k-=1}}}if(k<0){k=-1;l=[]}else{for(p=0;p<u._aryImageControls.length;p++){s=u._aryImageControls[p];s.imageIndex=p;s.bIfCurrentIndex=p===k}if(l.length===0){l=[k]}}q._innerSetIndexInfo(q._index,q._selectedIndices,k,l,true,false,true)}return x};var b=["rotateLeft","rotateRight","flip","mirror"];h.each(b,function(j){e.prototype[j]=function(){var p=this,k=!1;if(p._bDestoryed){return k}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return k}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return k}if(p._imageViewer.io._validateImgIsHandlingAsyncOperation()){return k}var m=arguments[0];if(!p._dwsObject._validateParamNum(arguments,1)||!p._dwsObject._validateNumberType("index",m)){return k}m=Math.round(m);if(m<0||m>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return k}var n={session:d.sessionId,object:p._dwsObject._dwsObjectId,method:h.upperCaseFirst(j),parameter:[p._imageViewer._imgViewerId,m]};k=h.detect.postSyncCommand(p._dwsObject,h.stringify(n),null,null);if(k){var o=p._imageViewer.ui._aryImageControls[m];o.imgSelector.calcActualImgRectAfterRotate(j==="rotateLeft"?h._enumImgEditType.RotateLeft:j==="rotateRight"?h._enumImgEditType.RotateRight:j==="flip"?h._enumImgEditType.Flip:j==="mirror"?h._enumImgEditType.Mirror:h._enumImgEditType.None);var l=p._getRefreshedImgUrl(m);o.attachImage(l)}return k}});h.each(["crop","cut"],function(j){e.prototype[j]=function(){var o=this,w=!1;if(o._bDestoryed){return w}if(!o._dwsObject._validateDivDom(o._imageViewer.ui._getImgViewerId(),!0)){return w}if(!o._dwsObject._validateImgViewerExist(o._imageViewer.ui._getImgViewerId(),o._bRemoved)){return w}if(o._imageViewer.io._validateImgIsHandlingAsyncOperation()){return w}var p=arguments[0],m=arguments[1],t=arguments[2],u=arguments[3],k=arguments[4];if(!o._dwsObject._validateParamNum(arguments,5)||!o._dwsObject._validateNumberType("index",p)||!o._dwsObject._validateNumberType("left",m)||!o._dwsObject._validateNumberType("top",t)||!o._dwsObject._validateNumberType("right",u)||!o._dwsObject._validateNumberType("bottom",k)){return w}p=Math.round(p);if(p<0||p>o._count-1){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return w}if(u<=0){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("right"));return w}if(k<=0){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("bottom"));return w}var v=o._getImageInfo(p);if(o._dwsObject.getErrorCode()!==h.errorInfo.getOkCode()){return w}var s=v?v._width:0,r=v?v._height:0;m=Math.round(m);t=Math.round(t);u=Math.round(u);k=Math.round(k);m=m<0?0:m;t=t<0?0:t;u=u>s?s:u;k=k>r?r:k;if(u<=m){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("right"));return w}if(k<=t){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("bottom"));return w}var n={session:d.sessionId,object:o._dwsObject._dwsObjectId,method:h.upperCaseFirst(j),parameter:[o._imageViewer._imgViewerId,p,m,t,u,k]};w=h.detect.postSyncCommand(o._dwsObject,h.stringify(n),null,null);if(w){var q=o._imageViewer.ui._aryImageControls[p];q.imgSelector["calcActualImgRectAfter"+dynamsoft.lib.upperCaseFirst(j)](m,t,u,k);var l=o._getRefreshedImgUrl(p);q.attachImage(l)}return w}});e.prototype.changeSize=function(p,k,r,m){var o=this,s=!1;if(o._bDestoryed){return s}if(!o._dwsObject._validateDivDom(o._imageViewer.ui._getImgViewerId(),!0)){return s}if(!o._dwsObject._validateImgViewerExist(o._imageViewer.ui._getImgViewerId(),o._bRemoved)){return s}if(o._imageViewer.io._validateImgIsHandlingAsyncOperation()){return s}if(!o._dwsObject._validateParamNum(arguments,4)||!o._dwsObject._validateNumberType("index",p)||!o._dwsObject._validateNumberType("width",k)||!o._dwsObject._validateNumberType("height",r)||!o._dwsObject._validateNumberType("interpolationMethod",m)){return s}p=Math.round(p);if(p<0||p>o._count-1){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return s}k=Math.round(k);r=Math.round(r);var l=((0|1<<31)>>>0)-1;if(k<=0||k>l){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("width"));return s}if(r<=0||r>l){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueOutOfRangeCode(),h.errorInfo.getValueOutOfRangeString("height"));return s}if(m!==g.NEARESTNEIGHBOUR&&m!==g.BILINEAR&&m!==g.BICUBIC){o._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("interpolationMethod"));return s}var n={session:d.sessionId,object:o._dwsObject._dwsObjectId,method:"ChangeSize",parameter:[o._imageViewer._imgViewerId,p,k,r,m]};s=h.detect.postSyncCommand(o._dwsObject,h.stringify(n),null,null);if(s){var q=o._imageViewer.ui._aryImageControls[p],j=o._getRefreshedImgUrl(p);q.adjustCentralPointAfterImgSizeChanged(k,r);q.imgSelector.calcActualImgRectAfterChangeSize(k,r);q.attachImage(j)}return s};e.prototype.swap=function(l,k){var p=this,s=!1;if(p._bDestoryed){return s}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return s}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return s}if(p._imageViewer.io._validateImgIsHandlingAsyncOperation()){return s}if(!p._dwsObject._validateParamNum(arguments,2)||!p._dwsObject._validateNumberType("firstIndex",l)||!p._dwsObject._validateNumberType("secondIndex",k)){return s}l=Math.round(l);k=Math.round(k);if(l<0||l>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("firstIndex"));return s}if(k<0||k>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("secondIndex"));return s}if(l===k){return!0}var m={session:d.sessionId,object:p._dwsObject._dwsObjectId,method:"Swap",parameter:[p._imageViewer._imgViewerId,l,k]};s=h.detect.postSyncCommand(p._dwsObject,h.stringify(m),null,null);if(s){var r=p._imageViewer.ui._aryImageControls[l],n=p._getRefreshedImgUrl(l),j=p._imageViewer.ui._aryImageControls[k],q=p._getRefreshedImgUrl(k),o;if(p._imageViewer.ui.imgSelector===r.imgSelector){p._imageViewer.ui.imgSelector=j.imgSelector}else{if(p._imageViewer.ui.imgSelector===j.imgSelector){p._imageViewer.ui.imgSelector=r.imgSelector}}o=r.imgSelector.actualImgRect;r.imgSelector.actualImgRect=j.imgSelector.actualImgRect;j.imgSelector.actualImgRect=o;r.imgSelector.initElem(r.outerDiv);j.imgSelector.initElem(j.outerDiv);r.attachImage(n);j.attachImage(q)}return s};e.prototype.copyToImageViewer=function(l,m){var p=this,j=!1;if(p._bDestoryed){return j}if(!p._dwsObject._validateDivDom(p._imageViewer.ui._getImgViewerId(),!0)){return j}if(!p._dwsObject._validateImgViewerExist(p._imageViewer.ui._getImgViewerId(),p._bRemoved)){return j}if(p._imageViewer.io._validateImgIsHandlingAsyncOperation()){return j}if(!p._dwsObject._validateParamNum(arguments,2)||!p._dwsObject._validateNumberType("index",l)){return j}l=Math.round(l);if(l<0||l>p._count-1){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("index"));return j}if(m===null){p._dwsObject._setErrCodeErrString(h.errorInfo.getValueNotValidCode(),h.errorInfo.getValueNotValidString("targetImageViewer"));return j}if(!(m instanceof f.ImageViewer)){p._dwsObject._setErrCodeErrString(h.errorInfo.getTypeNotValidCode(),h.errorInfo.getTypeNotValidString("targetImageViewer"));return j}var k=null;for(var n in dynamsoft.dcsEnv._imageViewerDic){if(dynamsoft.dcsEnv._imageViewerDic[n].imageViewer!==m){continue}k=dynamsoft.dcsEnv._imageViewerDic[n]}if(!k){p._dwsObject._setErrCodeErrString(h.errorInfo.getObjectNotExistCode(),h.errorInfo.getObjectNotExistString("targetImageViewer"));return false}if(k.dwsObject!==p._dwsObject){p._dwsObject._setErrCodeErrString(h.errorInfo.getAccessDeniedCode(),h.errorInfo.getAccessDeniedString("targetImageViewer"));return false}if(!p._dwsObject._validateDivDom(m.ui._getImgViewerId(),!0)){return j}if(!p._dwsObject._validateImgViewerExist(m.ui._getImgViewerId(),m.ui._bRemoved)){return j}if(m.io._validateImgIsHandlingAsyncOperation()){return j}var o={session:d.sessionId,object:p._dwsObject._dwsObjectId,method:"CopyToImageViewer",parameter:[p._imageViewer._imgViewerId,l,m._imgViewerId]};j=h.detect.postSyncCommand(p._dwsObject,h.stringify(o),null,null);if(j){m.ui._addImageControl()}return j};e.prototype._getRefreshedImgUrl=function(j){var k=this;return[d.preUrl,d.portInfo.curPort,"/",dynamsoft.dcsEnv._getVersionStrForCommand(),"/img?session=",d.sessionId,"&object=",k._dwsObject._dwsObjectId,"&imageviewer=",k._imageViewer._imgViewerId,"&index=",j].join("")};e.prototype._innerSetIndexInfo=function(j,n,p,o,m,l,k){this._index=p;this._selectedIndices=o;if(m){this._imageViewer.ui._refreshIndexInfo(j,n,p,o,l,k)}};e.prototype._innerIncCount=function(){return++this._count};e.prototype._innerDecCount=function(){return--this._count};e.prototype._innerSetCapacity=function(l){var p=this,q=p._count;p._capacity=l;if(q>l){p._count=l;p._imageViewer.ui._refreshWhenCountReduced(q);var j=p._imageViewer.image._index,m=p._imageViewer.image._selectedIndices.slice().sort(function(t,s){return t-s}),k=p._imageViewer.image._index,r=p._imageViewer.image._selectedIndices.slice().sort(function(t,s){return t-s}),o=false;if(j>p._count-1){k=p._count-1}for(var n=m.length-1;n>=0;n--){if(r[n]>p._count-1){r.splice(n,1);o=true}}if(k!=-1&&r.length==0){r=[k];o=true}if(k!=j||o){p._innerSetIndexInfo(j,m,k,r,true,true)}p._imageViewer.ui._setImgCtrlVisible(p._count-1)}};e.prototype._updatedImage=function(k){var m=this;var l=m._imageViewer.ui._aryImageControls[k];var j=m._getRefreshedImgUrl(k);l.attachImage(j)};e.prototype._destory=function(j){if(!j){this._bDestoryed=true}else{this._bRemoved=true}};function a(l,k,j){this._imgNS=l;this._width=k;this._height=j}h.each(["getWidth","getHeight"],function(j){a.prototype[j]=function(){var n=this,l=n._imgNS,k=l._dwsObject,m=l._imageViewer;if(n._bDestoryed){return null}if(!k._validateDivDom(m.ui._getImgViewerId(),!0)){return null}if(!k._validateImgViewerExist(m.ui._getImgViewerId(),l._bRemoved)){return null}if(!k._validateParamNum(arguments,0)){return null}return h.endsWith(j,"Width")?n._width:n._height}});h._enumImgEditType={None:-1,RotateLeft:0,RotateRight:1,Flip:2,Mirror:3};e.prototype.ImageInfo=a;f.Image=e;f.ImageInfo=a})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect);(function(g,e,d,f){var a=[];function b(k,j,h){var l=this;l.dwsObject=k;l.imageViewer=h;l.imageIndex=-1;l.imageUrl="";l.origImageWidth=0;l.origImageHeight=0;l.curImageWidth=0;l.curImageHeight=0;l.iImageViewerWidth=0;l.iImageViewerHeight=0;l.iImageControlWidth=0;l.iImageControlHeight=0;l.iImageControlMargin=0;l.outerDiv=false;l.hintDiv=false;l.bSelect=false;l.borderWidth=1;l.borderColor=4008636159;l.selectionBorderWidth=1;l.selectionBorderColor=2107821823;l.objImage=false;l.bIfCurrentIndex=false;l.imageIndex=-1;l.bIfFitWindow=true;l.bSingleMode=false;l.zoom=1;l.lastClick=false;l.mouseShape=null;l.imgSelector=new g.sdk.ImageSelector(l,l.imageViewer);l.bDrawing=false;l.dragPosition={x:0,y:0};l.bDragging=false;a.push(l);l.init(j);l.left=1;l.top=1;l.MAXLOACOUNT=6;l.curLoadCount=0;l.actaulCentralPoint={x:-1,y:-1};l._bIe9_10=f.navInfo.bIE&&(parseInt(f.navInfo.strBrowserVersion)===9||parseInt(f.navInfo.strBrowserVersion)===10);l.bDestroy=false}b.prototype.setHintString=function(h){if(!g.isString(h)){return}var j=this;if(j.hintDiv.innerText){j.hintDiv.innerText=h}else{if(j.hintDiv.textContent){j.hintDiv.textContent=h}else{j.hintDiv.appendChild(document.createTextNode(h))}}};b.prototype.init=function(h){var j=this;j.outerDiv=document.createElement("div");j.outerDiv.className="ds-dws-img-container ds-dws-display-inline-block";j.hintDiv=document.createElement("div");j.hintDiv.className="ds-dws-img-hint-container";j.setHintString("Loading ...");j.hintDiv.style.display="none";j.outerDiv.appendChild(j.hintDiv);j.setMouseShape(h);j.initObjImg();j.bindEvents()};b.prototype.initObjImg=function(){var h=this;h.objImage=new Image;h.objImage.className="ds-dws-img-obj";h.objImage.setAttribute("onmousedown","return false;");h.objImage.setAttribute("unselectable","on");h.objImage.setAttribute("draggable","false")};b.prototype.refresh=function(j,h){var k=this;k.outerDiv.className="ds-dws-img-container ds-dws-display-inline-block";k.outerDiv.style.left="";k.outerDiv.style.top="";k.outerDiv.style.position="relative";if(!k.bSingleMode||k.bSingleMode&&k.bIfCurrentIndex&&k.bIfFitWindow){k.iImageControlWidth=j;k.iImageControlHeight=h;k.outerDiv.style.width=j+"px";k.outerDiv.style.height=h+"px"}else{if(k.bSingleMode&&!k.bIfFitWindow&&k.bIfCurrentIndex){k.iImageControlWidth=j;k.iImageControlHeight=h}}k.outerDiv.style.margin=k.iImageControlMargin/2+"px";if(k.bSingleMode&&!k.bIfCurrentIndex){k.outerDiv.className="ds-dws-img-container ds-dws-display-none"}k.show()};b.prototype.show=function(){var m=this;m.positionHintDiv();if(m.iImageControlWidth<=0||m.iImageControlHeight<=0){if(m.objImage){m.objImage.style.width="0px"}if(m.objImage){m.objImage.style.height="0px"}return}if(m.objImage.src&&m.objImage.parentNode&&m.objImage.style.display==""){var j,h;if(!m.bSingleMode||m.bSingleMode&&m.bIfFitWindow&&m.bIfCurrentIndex){if(m.origImageWidth/m.iImageControlWidth>m.origImageHeight/m.iImageControlHeight){j=m.iImageControlWidth;h=m.origImageHeight*m.iImageControlWidth/m.origImageWidth}else{h=m.iImageControlHeight;j=m.origImageWidth*m.iImageControlHeight/m.origImageHeight}m.positionObjImg(j,h)}else{if(m.bSingleMode&&!m.bIfFitWindow&&m.bIfCurrentIndex){j=m.origImageWidth*m.zoom;h=m.origImageHeight*m.zoom;m.iImageControlWidth=(j>m.imageViewer.ui._userImageViewerWidth?j:m.imageViewer.ui._userImageViewerWidth)-2*m.borderWidth;m.iImageControlHeight=(h>m.imageViewer.ui._userImageViewerHeight?h:m.imageViewer.ui._userImageViewerHeight)-2*m.borderWidth;if(m.iImageControlWidth<0||m.iImageControlHeight<0){return}m.outerDiv.style.width=m.iImageControlWidth+"px";m.outerDiv.style.height=m.iImageControlHeight+"px";m.curImageWidth=j;m.curImageHeight=h;m.imageViewer.ui._showNonFitToWinImgCtrl(m.actaulCentralPoint.x==-1||m.actaulCentralPoint.y==-1,function(){m.positionObjImg(j,h)})}}if(m.imgSelector){var l=(m.iImageControlHeight-h)/2,k=(m.iImageControlWidth-j)/2;m.imgSelector.imgRect.top=l;m.imgSelector.imgRect.left=k;m.imgSelector.imgRect.bottom=l+h-1;m.imgSelector.imgRect.right=k+j-1;m.imgSelector.orgImgInfo.width=m.origImageWidth;m.imgSelector.orgImgInfo.height=m.origImageHeight;m.imgSelector.resizeSelector()}m.outerDiv.style.overflow="visible"}};b.prototype.positionObjImg=function(j,h){var k=this;k.objImage.style.position="absolute";k.objImage.style.top=Math.round((k.iImageControlHeight-h)/2)+"px";k.objImage.style.left=Math.round((k.iImageControlWidth-j)/2)+"px";k.objImage.style.width=parseInt(j)+"px";k.objImage.style.height=parseInt(h)+"px";k.curImageWidth=j;k.curImageHeight=h};b.prototype.attachImage=function(h){var j=this;if(j.imgSelector){j.imgSelector.hide()}j.objImage.style.display="none";j.hintDiv.style.display="block";j.setHintString("Loading ...");j.positionHintDiv();if(j.objImage){j.objImage.onload="";j.objImage.onerror="";j.objImage.src=""}if(j.objImage&&j.objImage.parentNode){j.objImage.setAttribute("onmousedown","");j.objImage.parentNode.removeChild(j.objImage)}j.initObjImg();j.objImage.onload=function(){j.origImageWidth=j.curImageWidth=j._bIe9_10&&this.naturalWidth?this.naturalWidth:this.width;j.origImageHeight=j.curImageHeight=j._bIe9_10&&this.naturalHeight?this.naturalHeight:this.height;if(!this.parentNode){j.outerDiv.appendChild(this)}this.style.display="";j.show();j.hintDiv.style.display="none";j.outerDiv.style.overflow="visible"};j.objImage.onerror=function(){++j.curLoadCount;if(j.curLoadCount>j.MAXLOACOUNT){j.setHintString("Error ocurrs");d.handleImageLoadingError(j.dwsObject,this.src);if(this.parentNode){this.parentNode.removeChild(this)}}else{this.src=[h,"&ts=",g.now()].join("")}};j.curLoadCount=1;j.imageUrl=[h,"&ts=",g.now()].join("");setTimeout(function(){j.objImage.src=[h,"&ts=",g.now()].join("")},0)};b.prototype.positionHintDiv=function(){var l=this,j=g.getElDimensions(l.outerDiv,false),q=j?j.clientWidth:l.outerDiv.clientWidth,k=j?j.clientHeight:l.outerDiv.clientHeight,m=g.getElDimensions(l.hintDiv,false),o=m?m.clientWidth:l.hintDiv.clientWidth,n=m?m.clientHeight:l.hintDiv.clientHeight;var p=(k-n)/2,h=(q-o)/2;if(p<0){p=0}if(h<0){h=0}l.hintDiv.style.top=parseInt(p)+"px";l.hintDiv.style.left=parseInt(h)+"px";l.outerDiv.style.overflow="hidden"};b.prototype.refreshBorder=function(){var h=this;if(h.bSelect){h.outerDiv.style.border=h.selectionBorderWidth+"px solid";h.outerDiv.style.borderColor=g.IntToColorStr(h.selectionBorderColor)}else{h.outerDiv.style.border=h.borderWidth+"px solid";h.outerDiv.style.borderColor=g.IntToColorStr(h.borderColor)}};b.prototype.setSelect=function(h){this.bSelect=h;this.refreshBorder()};b.prototype.setMouseShape=function(h){var j=this;if(j.mouseShape==h){return}j.mouseShape=h;j.outerDiv.style.cursor=j.mouseShape?"pointer":"crosshair"};b.prototype.fireEvent=function(h,j){if(g.isFunction(this[h])){return this[h](j)}return true};b.prototype.finishDrawing=function(){var h=this;h.bDrawing=false;h.imgSelector.calcActualImgRect();h.imgSelector.clear();if(h.imgSelector.isValidSelector()){h.fireEvent("onImageAreaSelected",{imgSelector:h.imgSelector})}};b.prototype.finishDragging=function(){var h=this;h.bDragging=false;h.dragPosition.x=0;h.dragPosition.y=0;h.fireEvent("onImageDraggingFinished")};b.prototype.bindEvents=function(){var l=this;var j=function(q){q=q||window.event;if(g.detectButton(q)!=g.EnumMouseButton.LEFT){return}var p=new Date,o,r=l.getMapMousePositionToImageCoordinate(q);if(l.lastClick){o=p.getTime()-l.lastClick.getTime()}l.lastClick=p;if(o<500){l.fireEvent("onMouseDoubleClick",{index:l.imageIndex,mouseX:r.x,mouseY:r.y});l.lastClick=false;g.log("MouseDoubleClick")}else{if(q.which?q.which==3:q.button==2){}else{l.fireEvent("onMouseClick",{e:q,index:l.imageIndex,mouseX:r.x,mouseY:r.y})}}};g.addEventListener(l.outerDiv,"click",j);if(!f.navInfo.bHTML5Edition){g.addEventListener(l.outerDiv,"dblclick",j)}var m=function(o){o=o||window.event;if(g.detectButton(o)!=g.EnumMouseButton.LEFT){return}l.left=l.outerDiv.clientLeft;l.top=l.outerDiv.clientTop;var p;if(!l.mouseShape){p=g.getOffset(o,l,l.outerDiv);l.fireEvent("onImageAreaDeSelected");l.imgSelector.clickedX=p.x;l.imgSelector.clickedY=p.y;l.imgSelector.orgImgInfo.width=l.origImageWidth;l.imgSelector.orgImgInfo.height=l.origImageHeight;l.imgSelector.imgRect.top=l.objImage.offsetTop;l.imgSelector.imgRect.left=l.objImage.offsetLeft;l.imgSelector.imgRect.bottom=l.objImage.offsetTop+l.objImage.offsetHeight-1;l.imgSelector.imgRect.right=l.objImage.offsetLeft+l.objImage.offsetWidth-1;l.bDrawing=true}if(l.mouseShape&&l.bSingleMode&&!l.bIfFitWindow){p=g.getOffset(o,l,l.imageViewer.ui._userImageContainer);l.dragPosition.x=p.x;l.dragPosition.y=p.y;l.bDragging=true}};g.addEventListener(l.outerDiv,"mousedown",m);var n=function(o){if(!l.imgSelector.elem){l.imgSelector.initElem(l.outerDiv)}l.imgSelector.curX=o.x;l.imgSelector.curY=o.y;l.imgSelector.show()};var h=function(q){var r=l.getMapMousePositionToImageCoordinate(q);l.fireEvent("onMouseMove",{index:l.imageIndex,mouseX:r.x,mouseY:r.y});if(!l.bDrawing&&!l.bDragging){return}q=q||window.event;var s;if(l.bDrawing){s=g.getOffset(q,l,l.outerDiv);n(s)}else{if(l.bDragging){s=g.getOffset(q,l,l.imageViewer.ui._userImageContainer);var p=s.x-l.dragPosition.x,o=s.y-l.dragPosition.y;l.fireEvent("onImageDragging",{deltaX:-p,deltaY:-o});l.dragPosition.x=s.x;l.dragPosition.y=s.y}}};g.addEventListener(l.outerDiv,"mousemove",h);var k=function(o){o=o||window.event;if(g.detectButton(o)==g.EnumMouseButton.RIGHT){var p=l.getMapMousePositionToImageCoordinate(o);l.fireEvent("onMouseRightClick",{index:l.imageIndex,mouseX:p.x,mouseY:p.y})}if(g.detectButton(o)!=g.EnumMouseButton.LEFT){return}if(!l.mouseShape&&l.bDrawing){var q=g.getOffset(o,l,l.outerDiv);n(q);l.finishDrawing();if(l.selectionBorderWidth==1&&!f.navInfo.bSafari&&!f.navInfo.bFirefox){l.imgSelector.bNeedResize=false}}if(l.mouseShape&&l.bDragging){l.finishDragging()}};g.addEventListener(l.outerDiv,"mouseup",k);b.prototype.removeEvents=function(){g.removeEventListener(this.outerDiv,"click",j);if(!f.navInfo.bHTML5Edition){g.removeEventListener(this.outerDiv,"dblclick",j)}g.removeEventListener(this.outerDiv,"mousedown",m);g.removeEventListener(this.outerDiv,"mousemove",h);g.removeEventListener(this.outerDiv,"mouseup",k);this.objImage.setAttribute("onmousedown","")}};b.prototype.getMapMousePositionToImageCoordinate=function(j){j=j||window.event;if(!j){return}var k=this,h=g.getOffset(j,k,k.outerDiv);return k.imgSelector.MapCurMousePosToImgCoordinate(h.x,h.y)};b.prototype.adjustCentralPointAfterImgSizeChanged=function(l,h){var m=this;if(m.actaulCentralPoint.x===-1||m.actaulCentralPoint.y===-1||!m.bIfCurrentIndex||m.bIfFitWindow||!m.bSingleMode){return}var k=l/m.origImageWidth,j=h/m.origImageHeight;m.actaulCentralPoint.x*=k;m.actaulCentralPoint.y*=j};b.prototype.destroy=function(){var j=this;j.removeEvents();j.imgSelector.destroy();if(j.hintDiv&&j.hintDiv.parentNode){j.hintDiv.parentNode.removeChild(j.hintDiv)}if(j.objImage&&j.objImage.parentNode){j.objImage.parentNode.removeChild(j.objImage)}var h=a.indexOf(j);if(h!=-1){a.splice(h,1)}if(j.outerDiv.parentNode){j.outerDiv.parentNode.removeChild(j.outerDiv)}j.bDestroy=true};b.prototype._invokeMouseUpOutside=function(h){h=h||window.event;var n=this;if(!n.mouseShape&&n.bDrawing){var m=g.getOffset(h,n,n.outerDiv);if(isNaN(m.x)||isNaN(m.y)){return}var l=g.getElDimensions(n.outerDiv,false),j=l?l.clientWidth:n.outerDiv.clientWidth,k=l?l.clientHeight:n.outerDiv.clientHeight;if(m.x>=0&&m.x<=j&&m.y>=0&&m.y<=k){return}n.finishDrawing()}if(n.mouseShape&&n.bDragging){n.finishDragging()}};g.addEventListener(document,"mouseup",function(h){h=h||window.event;for(var j=0;j<a.length;j++){a[j]._invokeMouseUpOutside(h)}});e.ImageControl=b})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(b){function a(e,d){var f=this;f.imgCtrl=e;f.imageViewer=d;f.clickedX=0;f.clickedY=0;f.curX=0;f.curY=0;f.orgImgInfo={width:0,height:0};f.imgRect={left:0,top:0,right:0,bottom:0};f.actualImgRect={left:0,top:0,right:0,bottom:0,toString:function(){return"left: "+this.left+". top: "+this.top+". right: "+this.right+". bottom: "+this.bottom}};f.userRect={left:0,top:0,right:0,bottom:0,toString:function(){return"left: "+this.left+". top: "+this.top+". right: "+this.right+". bottom: "+this.bottom}};f.intersectionRect={left:0,top:0,right:0,bottom:0,toString:function(){return"left: "+this.left+". top: "+this.top+". right: "+this.right+". bottom: "+this.bottom}};f.elem=null;f.parentElem=null;f.bNeedResize=true;f.bDestroy=false}a.prototype.initElem=function(d){var e=this;e.removeElem();e.elem=document.createElement("div");e.elem.className="ds-dws-img-selector";e.elem.style.display="none";if(d){e.parentElem=d;d.appendChild(e.elem)}};a.prototype.clear=function(){var d=this;d.clickedX=0;d.clickedY=0;d.curX=0;d.curY=0};a.prototype.clearRect=function(){var d=function(f){f.top=0;f.left=0;f.right=0;f.bottom=0},e=this;d(e.userRect);d(e.intersectionRect);d(e.actualImgRect)};a.prototype.removeElem=function(){var d=this;if(d.elem&&d.parentElem){d.parentElem.removeChild(d.elem);d.elem=null}};a.prototype.isValidSelector=function(){var h=this,e=h.intersectionRect.right-h.intersectionRect.left,g=h.intersectionRect.bottom-h.intersectionRect.top,d=h.actualImgRect.right-h.actualImgRect.left,f=h.actualImgRect.bottom-h.actualImgRect.top;return e>0&&g>0&&d>0&&f>0};a.prototype.show=function(){var d=this;d.calcUserRect();d.calcIntersectionRect();b.log("UserRect: "+d.userRect.toString());b.log("IntersectionRect: "+d.intersectionRect.toString());if(!(d.elem&&d.intersectionRect.right-d.intersectionRect.left>0&&d.intersectionRect.bottom-d.intersectionRect.top>0)){d.hide();return}d.positionSelector()};a.prototype.positionSelector=function(){var h=this;h.intersectionRect.top=h.intersectionRect.top<0?0:h.intersectionRect.top;h.intersectionRect.top=h.intersectionRect.top>h.imgRect.top?h.intersectionRect.top:h.imgRect.top;h.intersectionRect.left=h.intersectionRect.left<0?0:h.intersectionRect.left;h.intersectionRect.left=h.intersectionRect.left>h.imgRect.left?h.intersectionRect.left:h.imgRect.left;if(h.intersectionRect.right>h.imgRect.right){h.intersectionRect.right=h.imgRect.right}if(h.intersectionRect.bottom>h.imgRect.bottom){h.intersectionRect.bottom=h.imgRect.bottom}var g=h.intersectionRect.top,f=h.intersectionRect.left,e=h.intersectionRect.right-h.intersectionRect.left,d=h.intersectionRect.bottom-h.intersectionRect.top;if(!h.elem){return}if(e>0&&d>0){h.elem.style.top=g+"px";h.elem.style.left=f+"px";h.elem.style.width=e+"px";h.elem.style.height=d+"px";h.elem.style.display="block"}else{h.hide()}};a.prototype.hide=function(){if(!this.elem){return}this.elem.style.display="none"};a.prototype.calcUserRect=function(){var g=this,f=0;if(g.curX<g.clickedX){g.curX+=1}if(g.curY<g.clickedY){g.curY+=1}var e=Math.abs(g.curX-g.clickedX),d=Math.abs(g.curY-g.clickedY);g.userRect.top=g.curY<g.clickedY?g.curY:g.clickedY;g.userRect.left=g.curX<g.clickedX?g.curX:g.clickedX;g.userRect.right=g.userRect.left+e;g.userRect.bottom=g.userRect.top+d;f=g.imageViewer.ui.getSelectionRectAspectRatio();if(f!=0){var e=g.userRect.right-g.userRect.left,d;if(g.curY>g.clickedY){d=e/f;g.userRect.bottom=g.userRect.top+d}else{d=e/f;g.userRect.top=g.userRect.bottom-d}}};a.prototype.calcIntersectionRect=function(){var d=this;d.intersectionRect.left=Math.max(d.userRect.left,d.imgRect.left);d.intersectionRect.right=Math.min(d.userRect.right,d.imgRect.right);d.intersectionRect.top=Math.max(d.userRect.top,d.imgRect.top);
d.intersectionRect.bottom=Math.min(d.userRect.bottom,d.imgRect.bottom)};a.prototype.calcActualImgRect=function(){var d=this;if(d.intersectionRect.right<=d.intersectionRect.left||d.intersectionRect.bottom<=this.intersectionRect.top){d.clearRect();return}d.actualImgRect.top=(d.intersectionRect.top-d.imgRect.top+1)/(d.imgRect.bottom-d.imgRect.top+1)*d.orgImgInfo.height;if(d.intersectionRect.top===d.imgRect.top){d.actualImgRect.top=0}d.actualImgRect.top=d.actualImgRect.top<0?0:d.actualImgRect.top;d.actualImgRect.left=(d.intersectionRect.left-d.imgRect.left+1)/(d.imgRect.right-d.imgRect.left+1)*d.orgImgInfo.width;if(d.intersectionRect.left===d.imgRect.left){d.actualImgRect.left=0}d.actualImgRect.left=d.actualImgRect.left<0?0:d.actualImgRect.left;d.actualImgRect.bottom=(d.intersectionRect.bottom-d.intersectionRect.top+1)/(d.imgRect.bottom-d.imgRect.top+1)*d.orgImgInfo.height+d.actualImgRect.top;d.actualImgRect.bottom=d.actualImgRect.bottom>d.orgImgInfo.height?d.orgImgInfo.height:d.actualImgRect.bottom;d.actualImgRect.right=(d.intersectionRect.right-d.intersectionRect.left+1)/(d.imgRect.right-d.imgRect.left+1)*d.orgImgInfo.width+d.actualImgRect.left;d.actualImgRect.right=d.actualImgRect.right>d.orgImgInfo.width?d.orgImgInfo.width:d.actualImgRect.right;d.actualImgRect.top=parseInt(d.actualImgRect.top)<0?0:parseInt(d.actualImgRect.top);d.actualImgRect.left=parseInt(d.actualImgRect.left)<0?0:parseInt(d.actualImgRect.left);d.actualImgRect.bottom=parseInt(d.actualImgRect.bottom)>d.orgImgInfo.height?d.orgImgInfo.height:parseInt(d.actualImgRect.bottom);d.actualImgRect.right=parseInt(d.actualImgRect.right)>d.orgImgInfo.width?d.orgImgInfo.width:parseInt(d.actualImgRect.right)};a.prototype.calcActualImgRectAfterRotate=function(l){var k=this,d=k.actualImgRect.right-k.actualImgRect.left,g=k.actualImgRect.bottom-k.actualImgRect.top;if(d<=0||g<=0){return}var h=0,e=0,j={x:0,y:0};if(l===b._enumImgEditType.RotateLeft||l===b._enumImgEditType.RotateRight){h=k.actualImgRect.bottom-k.actualImgRect.top;e=k.actualImgRect.right-k.actualImgRect.left}else{if(l===b._enumImgEditType.Flip||l===b._enumImgEditType.Mirror){h=k.actualImgRect.right-k.actualImgRect.left;e=k.actualImgRect.bottom-k.actualImgRect.top}}switch(l){case b._enumImgEditType.RotateLeft:j.x=k.actualImgRect.right;j.y=k.actualImgRect.top;k.actualImgRect.top=k.orgImgInfo.width-j.x;k.actualImgRect.left=j.y;break;case b._enumImgEditType.RotateRight:j.x=k.actualImgRect.left;j.y=k.actualImgRect.bottom;k.actualImgRect.top=j.x;k.actualImgRect.left=k.orgImgInfo.height-j.y;break;case b._enumImgEditType.Flip:j.y=k.actualImgRect.bottom;k.actualImgRect.top=k.orgImgInfo.height-j.y;break;case b._enumImgEditType.Mirror:j.x=k.actualImgRect.right;k.actualImgRect.left=k.orgImgInfo.width-j.x;break}k.actualImgRect.bottom=k.actualImgRect.top+e;k.actualImgRect.right=k.actualImgRect.left+h;if(l===b._enumImgEditType.RotateLeft||l===b._enumImgEditType.RotateRight){var f=k.orgImgInfo.width;k.orgImgInfo.width=k.orgImgInfo.height;k.orgImgInfo.height=f}};a.prototype.isRectIntersected=function(j,f,m,k,g,d,l,h){var e={};e.left=Math.max(j,g);e.right=Math.min(m,l);e.top=Math.max(f,d);e.bottom=Math.min(k,h);return e.right-e.left>0&&e.bottom-e.top>0};a.prototype.calcActualImgRectAfterCut=function(g,f,e,d){var h=this;if(h.isRectIntersected(g,f,e,d,h.actualImgRect.left,h.actualImgRect.top,h.actualImgRect.right,h.actualImgRect.bottom)){h.actualImgRect.left=0;h.actualImgRect.right=0;h.actualImgRect.top=0;h.actualImgRect.bottom=0}};a.prototype.calcActualImgRectAfterCrop=function(g,f,e,d){var h=this;if(g<=h.actualImgRect.left&&f<=h.actualImgRect.top&&e>=h.actualImgRect.right&&d>=h.actualImgRect.bottom){h.actualImgRect.left-=g;h.actualImgRect.right-=g;h.actualImgRect.top-=f;h.actualImgRect.bottom-=f}else{h.actualImgRect.left=0;h.actualImgRect.right=0;h.actualImgRect.top=0;h.actualImgRect.bottom=0}};a.prototype.calcActualImgRectAfterChangeSize=function(g,d){var h=this,f=g/h.orgImgInfo.width,e=d/h.orgImgInfo.height;h.actualImgRect.top*=e;h.actualImgRect.bottom*=e;h.actualImgRect.left*=f;h.actualImgRect.right*=f};a.prototype.resizeSelector=function(){var d=this;if(!d.bNeedResize){d.bNeedResize=true;return}if(d.actualImgRect.right<=d.actualImgRect.left||d.actualImgRect.bottom<=this.actualImgRect.top){d.clearRect();return}d.intersectionRect.left=parseInt(d.actualImgRect.left/d.orgImgInfo.width*(d.imgRect.right-d.imgRect.left)+d.imgRect.left);d.intersectionRect.top=parseInt(d.actualImgRect.top/d.orgImgInfo.height*(d.imgRect.bottom-d.imgRect.top)+d.imgRect.top);d.intersectionRect.right=parseInt((d.actualImgRect.right-d.actualImgRect.left)/d.orgImgInfo.width*(d.imgRect.right-d.imgRect.left)+d.intersectionRect.left);d.intersectionRect.bottom=parseInt((d.actualImgRect.bottom-d.actualImgRect.top)/d.orgImgInfo.height*(d.imgRect.bottom-d.imgRect.top)+d.intersectionRect.top);d.positionSelector()};a.prototype.MapCurMousePosToImgCoordinate=function(h,g){var k=this,f={top:-1,left:-1,bottom:-1,right:-1},e={top:k.imgRect.top,left:k.imgRect.left,right:h,bottom:g},j=e.right-e.left,d=e.bottom-e.top;if(j<0||d<0||j>k.imgRect.right-k.imgRect.left||d>k.imgRect.bottom-k.imgRect.top){return{x:f.right,y:f.bottom}}f.top=(e.top-k.imgRect.top+1)/(k.imgRect.bottom-k.imgRect.top+1)*k.orgImgInfo.height;f.top=f.top<0?0:f.top;f.left=(e.left-k.imgRect.left+1)/(k.imgRect.right-k.imgRect.left+1)*k.orgImgInfo.width;f.left=f.left<0?0:f.left;f.bottom=(e.bottom-e.top+1)/(k.imgRect.bottom-k.imgRect.top+1)*k.orgImgInfo.height+f.top;if(parseInt(d)===0){f.bottom=0}f.bottom=f.bottom>k.orgImgInfo.height?k.orgImgInfo.height:f.bottom;f.right=(e.right-e.left+1)/(k.imgRect.right-k.imgRect.left+1)*k.orgImgInfo.width+f.left;if(parseInt(j)===0){f.right=0}f.right=f.right>k.orgImgInfo.width?k.orgImgInfo.width:f.right;f.bottom=parseInt(f.bottom)>k.orgImgInfo.height?k.orgImgInfo.height:parseInt(f.bottom);f.right=parseInt(f.right)>k.orgImgInfo.width?k.orgImgInfo.width:parseInt(f.right);return{x:f.right,y:f.bottom}};a.prototype.destroy=function(){this.removeElem();this.bDestroy=true};b.sdk.ImageSelector=a})(dynamsoft.lib);(function(m,l,u,x){var r={POST:0,PUT:1},b={BMP:0,JPEG:1,TIFF:2,PNG:3,PDF:4},h={BINARY:0,BASE64:1},v={AUTO:0,RLE:2,FAX3:3,T4:3,FAX4:4,T6:4,LZW:5,JPEG:7,PACKBITS:32773},j="get",w="set",s="iValue",y=["HTTPFormFields","JPEGQuality","TIFFCompressionType","HTTPResponse"],o=[],d=0,k=100;function e(A,z){var B=this;B._dwsObject=A;B._imgViewer=z;B._bRemoved=false;B._bDestoryed=false;B.EnumHttpMethod=r;B.EnumImageType=b;B.EnumUploadDataFormat=h;B.EnumTIFFCompressionType=v;B.pdfinfo=new l.PdfInfo(B);B._JPEGQuality=80;B._TIFFCompressionType=v.AUTO;B._HTTPFormFields={};B._HTTPResponse=null;B._bPropertiesChanged=!0;B._asyncDownloadErrCodeErrStrings={};B._asyncUploadErrCodeErrStrings={}}e.prototype._getPropNumInObj=function(B){var A=0;if(!B||!m.isObject(B)){return A}for(var z in B){A++}return A};e.prototype._isHandlingAsyncDownloadOperation=function(){return this._getPropNumInObj(this._asyncDownloadErrCodeErrStrings)>0};e.prototype._isHandlingAsyncOperation=function(){return this._getPropNumInObj(this._asyncDownloadErrCodeErrStrings)>0||this._getPropNumInObj(this._asyncUploadErrCodeErrStrings)>0};e.prototype._validateImgIsHandlingAsyncOperation=function(A){var z=this._dwsObject;if(this._isHandlingAsyncOperation()){z._setErrCodeErrString(m.errorInfo.getAsyncTaskNotCompletedCode(),m.errorInfo.getAsyncTaskNotCompletedString(this._isHandlingAsyncDownloadOperation()>0?"httpDownloadAsync":"httpUploadAsync"))}else{z._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString())}return this._isHandlingAsyncOperation()};m.each(y,function(z){o.push(j+z);o.push(w+z)});o.splice(o.indexOf(w+"HTTPResponse"),1);m.each(o,function(z){e.prototype[z]=function(){var F=this,A=F._dwsObject;if(F._bDestoryed){return false}if(!A._validateDivDom(F._imgViewer.ui._getImgViewerId(),!0)){return z.indexOf(j)===0?undefined:false}if(!A._validateImgViewerExist(F._imgViewer.ui._getImgViewerId(),F._bRemoved)){return z.indexOf(j)===0?undefined:false}if(z.indexOf(j)===0){if(!A._validateParamNum(arguments,0)){return null}}else{if(!A._validateParamNum(arguments,1)){return false}if(z.indexOf("JPEGQuality")!==-1){if(!A._validateNumberType(s,arguments[0])){return false}arguments[0]=Math.round(arguments[0]);if(!A._validateValue(s,arguments[0],[d,k],true)){return false}}else{if(z.indexOf("TIFFCompressionType")!==-1){if(!A._validateNumberType(s,arguments[0])||!F._isValidValueInEnum(v,arguments[0],s)){return false}}else{if(z.indexOf("HTTPFormFields")!==-1){if(!dynamsoft.lib.isObject(arguments[0])){A._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString(s));return false}var C="";try{C=m.stringify(arguments[0])}catch(E){C=false}if(!C){A._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString(s));return false}}}}}var B=-1,D="";for(B=0;B<y.length;B++){if(z.indexOf(y[B])!==-1){D=y[B];break}}A._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString());if(z.indexOf(j)===0){return F["_"+D]}else{if(z.indexOf("HTTPFormFields")===-1&&F["_"+D]!==arguments[0]){F._bPropertiesChanged=!0}F["_"+D]=arguments[0];return true}}});e.prototype._isValidValueInEnum=function(B,D,C){if(!m.isNumber(D)){this._dwsObject._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString(C));return false}var A,z=!1,E=this;for(A in B){if(B[A]===D){z=!0;break}}if(z){E._dwsObject._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString())}else{E._dwsObject._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString(C))}return z};e.prototype._getValidatedIndices=function(C){var z=null,B=this._imgViewer.image;if(!m.isArray(C)){return z}if(C.length===0){return z}for(var A=0;A<C.length;A++){if(!m.isNumber(C[A])){return z}C[A]=Math.round(C[A]);if(C[A]<0||C[A]>B._getCount()-1){return z}}z=C;return z};e.prototype._sendPropertiesToBackend=function(){var C=this,A=C._dwsObject,B={session:x.sessionId,object:A._dwsObjectId,method:"SetImageIoProperties",parameter:[C._imgViewer._imgViewerId,C._JPEGQuality,C._TIFFCompressionType,C.pdfinfo._getJsonObj()]};var z=x.postSyncCommand(A,m.stringify(B),null,null);C._bPropertiesChanged=!1;return z};e.prototype.convertToBase64=function(G,A){var D=this,F=D._dwsObject,C=null;if(D._bDestoryed){return false}if(!F._validateDivDom(D._imgViewer.ui._getImgViewerId(),!0)){return C}if(!F._validateImgViewerExist(D._imgViewer.ui._getImgViewerId(),D._bRemoved)){return C}if(D._validateImgIsHandlingAsyncOperation()){return C}if(!F._validateParamNum(arguments,2)||!F._validateArrayType("indices",G)||!F._validateNumberType("imageType",A)){return C}G=D._getValidatedIndices(G);if(G===null){D._dwsObject._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("indices"));return C}if(!D._isValidValueInEnum(b,A,"imageType")){return C}if(G.length>1&&(A!==b.TIFF&&A!=b.PDF)){D._dwsObject._setErrCodeErrString(m.errorInfo.getMultipageNotSupportedCode(),m.errorInfo.getMultipageNotSupportedString());return C}if(D._bPropertiesChanged||A==b.PDF&&(D.pdfinfo._pdfCreationDate===null||D.pdfinfo._pdfModifiedDate===null)){var z=D._sendPropertiesToBackend();if(!z){return C}}var B={session:x.sessionId,object:F._dwsObjectId,method:"ConvertToBase64",parameter:[D._imgViewer._imgViewerId,G,A]},E=function(I){if(m.isArray(I.result)&&I.result.length===1){C=I.result[0]}else{C=""}},H=!1;H=x.postSyncCommand(F,m.stringify(B),E,null);if(H){F._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString())}return C};e.prototype.copyToClipboard=function(F,B,I,K,z){var E=this,J=E._dwsObject,A=E._imgViewer.image,D=E._imgViewer.ui,M=!1;if(E._bDestoryed){return M}if(!J._validateDivDom(D._getImgViewerId(),!0)){return M}if(!J._validateImgViewerExist(D._getImgViewerId(),E._bRemoved)){return M}if(E._validateImgIsHandlingAsyncOperation()){return M}if(arguments.length<1||arguments.length>1&&arguments.length<5){J._setErrCodeErrString(m.errorInfo.getParameterNumberUnmatchedCode(),m.errorInfo.getParameterNumberUnmatchedString(!0));return M}if(arguments.length>5){J._setErrCodeErrString(m.errorInfo.getParameterNumberUnmatchedCode(),m.errorInfo.getParameterNumberUnmatchedString(!1));return M}if(!J._validateNumberType("index",F)){return M}F=Math.round(F);if(F<0||F>A._getCount()-1){J._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("index"));return M}var L=A._getImageInfo(F);if(E._dwsObject.getErrorCode()!==m.errorInfo.getOkCode()){return M}var H=L?L._width:0,G=L?L._height:0;B=B===undefined?0:B;I=I===undefined?0:I;K=K===undefined?H:K;z=z===undefined?G:z;if(!J._validateNumberType("left",B)||!J._validateNumberType("top",I)||!J._validateNumberType("right",K)||!J._validateNumberType("bottom",z)){return M}B=Math.round(B);I=Math.round(I);K=Math.round(K);z=Math.round(z);if(K<=0){J._setErrCodeErrString(m.errorInfo.getValueOutOfRangeCode(),m.errorInfo.getValueOutOfRangeString("right"));return M}if(z<=0){J._setErrCodeErrString(m.errorInfo.getValueOutOfRangeCode(),m.errorInfo.getValueOutOfRangeString("bottom"));return M}if(B<0){B=0}if(I<0){I=0}if(K>H){K=H}if(z>G){z=G}if(K<=B){J._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("right"));return M}if(z<=I){J._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("bottom"));return M}var C={session:x.sessionId,object:J._dwsObjectId,method:"CopyToClipboard",parameter:[E._imgViewer._imgViewerId,F,B,I,K,z]};M=x.postSyncCommand(J,m.stringify(C),null,null);if(M){J._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString())}return M};e.prototype.loadFromClipboard=function(){var E=this,B=E._dwsObject,C=E._imgViewer.ui,A=!1;if(E._bDestoryed){A}if(!B._validateDivDom(C._getImgViewerId(),!0)){return A}if(!B._validateImgViewerExist(C._getImgViewerId(),E._bRemoved)){return A}if(E._validateImgIsHandlingAsyncOperation()){return A}if(!B._validateParamNum(arguments,0)){return A}var D={session:x.sessionId,object:B._dwsObjectId,method:"LoadFromClipboard",parameter:[u._getProductKey(),E._imgViewer._imgViewerId]},z=function(){var F=B.getErrorCode(),G=B.getErrorString();C._addImageControl();B._setErrCodeErrString(F,G)};A=x.postSyncCommand(B,m.stringify(D),z,null);if(B.getErrorCode()===m.errorInfo.getDataFormatInvalidCode()){B._setErrCodeErrString(m.errorInfo.getDataFormatInvalidCode(),m.errorInfo.getDataFormatInvalidString(!1))}return A};var g="httpDownload",q="httpDownloadAsync";m.each([g,q],function(z){e.prototype[z]=function(){var D=this,K=D._dwsObject,E=D._imgViewer.ui,L=!1,C=m.errorInfo.getOkCode(),J=m.errorInfo.getOkString(),M=function(P,O){C=P===undefined?K.getErrorCode():P;J=O===undefined?K.getErrorString():O};if(D._bDestoryed){return!1}K._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString());if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateDivDom(E._getImgViewerId(),!0)){if(z===g){return L}else{M()}}if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateImgViewerExist(E._getImgViewerId(),D._bRemoved)){if(z===g){return L}else{M()}}if(z===g){if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateParamNum(arguments,1)){return L}}else{if(K.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length<3){C=m.errorInfo.getParameterNumberUnmatchedCode();J=m.errorInfo.getParameterNumberUnmatchedString(!0);K._setErrCodeErrString(C,J)}if(K.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length>4){C=m.errorInfo.getParameterNumberUnmatchedCode();J=m.errorInfo.getParameterNumberUnmatchedString(!1);K._setErrCodeErrString(C,J)}}var A=arguments[0],H=arguments[1],N=arguments[2],G=arguments[3]===undefined?null:arguments[3];if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateStringType("url",A)){if(z===g){return L}else{M()}}if(z===q){if(K.getErrorCode()===m.errorInfo.getOkCode()&&H!==null&&!m.isFunction(H)){K._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpDownloadSuccess"));M()}if(K.getErrorCode()===m.errorInfo.getOkCode()&&N!==null&&!m.isFunction(N)){K._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpDownloadFailure"))}if(K.getErrorCode()===m.errorInfo.getOkCode()&&G!==null&&!m.isFunction(G)){K._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpDownloading"));M()}}if(z===q&&K.getErrorCode()!==m.errorInfo.getOkCode()){if(m.isFunction(N)){setTimeout(function(){N(C,J,"")},0)}return null}if(A.trim().length===0){A="invalidUrl"}if(!m.startsWith(A,"http://")&&!m.startsWith(A,"https://")){A=(u.navInfo.bSSL?"https://":"http://")+A}var F=m.now();if(z===q){D._asyncDownloadErrCodeErrStrings[F]={ec:m.errorInfo.getOkCode(),es:m.errorInfo.getOkString()}}var B=function(Q,S,P){var T=[x.preUrl,x.portInfo.curPort,"/",u._getVersionStrForCommand(),"/appendImageFromBytes?","session=",x.sessionId,"&object=",K._dwsObjectId,"&imageviewer=",D._imgViewer._imgViewerId,"&productkey=",u._getProductKey(),"&mode=","image","&ts=",m.now()].join(""),R=function(ac,aa,ae){if(z===g){L=K.getErrorCode()===m.errorInfo.getOkCode()}else{if(D._asyncDownloadErrCodeErrStrings[F]){K._setErrCodeErrString(D._asyncDownloadErrCodeErrStrings[F].ec,D._asyncDownloadErrCodeErrStrings[F].es)}if(K.getErrorCode()===m.errorInfo.getOkCode()){if(m.isFunction(H)){setTimeout(function(){H()},0)}}else{M();if(m.isFunction(N)){setTimeout(function(){N(C,J,"")},0)}}}if(z===q){delete D._asyncDownloadErrCodeErrStrings[F]}var ab=K.getErrorCode(),V=K.getErrorString();var X=0,U,Y=D._imgViewer.image._getIndex(),Z=D._imgViewer.image._getSelectedIndices().slice();if(ac&&m.isArray(ac.result)&&m.isNumber(ac.result[2])){X=ac.result[2]}for(U=0;U<X;U++){E._addImageControl()}var W=D._imgViewer.image._getIndex(),ad=[];if(X>0&&W>Y){for(U=0;U<X;U++){ad.push(W-U)}ad.sort(function(ag,af){return ag-af});setTimeout(function(){D._imgViewer.image._innerSetIndexInfo(Y,Z,W,ad,!D._imgViewer.ui._bSingleMode,true)},200)}K._setErrCodeErrString(ab,V)},O=function(W,V,U){if(z===q&&D._asyncDownloadErrCodeErrStrings[F]&&D._asyncDownloadErrCodeErrStrings[F].ec===m.errorInfo.getDataFormatInvalidCode()||z!==q&&K.getErrorCode()===m.errorInfo.getDataFormatInvalidCode()){K._setErrCodeErrString(m.errorInfo.getDataFormatInvalidCode(),m.errorInfo.getDataFormatInvalidString(!0))}if(z===g){L=!1}else{if(D._asyncDownloadErrCodeErrStrings[F]&&D._asyncDownloadErrCodeErrStrings[F].ec!==m.errorInfo.getDataFormatInvalidCode()){K._setErrCodeErrString(D._asyncDownloadErrCodeErrStrings[F].ec,D._asyncDownloadErrCodeErrStrings[F].es)}M();if(m.isFunction(N)){setTimeout(function(){N(C,J,"")},0)}}if(z===q){delete D._asyncDownloadErrCodeErrStrings[F]}};D._HTTPResponse="";if(z===q){D._asyncDownloadErrCodeErrStrings[F]={ec:m.errorInfo.getOkCode(),es:m.errorInfo.getOkString()}}D._sendImgDataToService(T,Q,z===q,R,O,F)},I=function(R,S,P){D._HTTPResponse=R?R:"";if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<10){D._HTTPResponse=P.nativeXhr.responseText}var O=0;try{O=P.nativeXhr.status}catch(Q){O=0}if(!S||S.indexOf(m.ajax._strOpenErr)!==-1||S.indexOf(m.ajax._strSendErr)!==-1||u.navInfo.bIE&&S.toLowerCase().indexOf("unknown")!==-1){K._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("url"))}else{K._setErrCodeErrString(m.errorInfo.getHttpErrorCode(),m.errorInfo.getHttpErrorString(O))}if(z===g){L=!1}else{M();if(m.isFunction(N)){setTimeout(function(){N(C,J,D._HTTPResponse)},0)}}if(z===q){delete D._asyncDownloadErrCodeErrStrings[F]}};D._download(A,z===q,B,I,G);if(z===g){return L}}});var t="httpDownloadDocument",a="httpDownloadDocumentAsync";m.each([t,a],function(z){e.prototype[z]=function(){var D=this,K=D._dwsObject,E=D._imgViewer.ui,L=!1,C=m.errorInfo.getOkCode(),J=m.errorInfo.getOkString(),M=function(P,O){C=P===undefined?K.getErrorCode():P;J=O===undefined?K.getErrorString():O};if(D._bDestoryed){return!1}K._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString());if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateDivDom(E._getImgViewerId(),!0)){if(z===t){return L}else{M()}}if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateImgViewerExist(E._getImgViewerId(),D._bRemoved)){if(z===t){return L}else{M()}}if(z===t){if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateParamNum(arguments,1)){return L}}else{if(K.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length<3){C=m.errorInfo.getParameterNumberUnmatchedCode();J=m.errorInfo.getParameterNumberUnmatchedString(!0);K._setErrCodeErrString(C,J)}if(K.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length>4){C=m.errorInfo.getParameterNumberUnmatchedCode();J=m.errorInfo.getParameterNumberUnmatchedString(!1);K._setErrCodeErrString(C,J)}}var A=arguments[0],H=arguments[1],N=arguments[2],G=arguments[3]===undefined?null:arguments[3];if(K.getErrorCode()===m.errorInfo.getOkCode()&&!K._validateStringType("url",A)){if(z===t){return L}else{M()}}if(z===a){if(K.getErrorCode()===m.errorInfo.getOkCode()&&H!==null&&!m.isFunction(H)){K._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpDownloadSuccess"));M()}if(K.getErrorCode()===m.errorInfo.getOkCode()&&N!==null&&!m.isFunction(N)){K._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpDownloadFailure"))}if(K.getErrorCode()===m.errorInfo.getOkCode()&&G!==null&&!m.isFunction(G)){K._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpDownloading"));M()}}if(z===a&&K.getErrorCode()!==m.errorInfo.getOkCode()){if(m.isFunction(N)){setTimeout(function(){N(C,J,"")},0)}return null}if(A.trim().length===0){A="invalidUrl"}if(!m.startsWith(A,"http://")&&!m.startsWith(A,"https://")){A=(u.navInfo.bSSL?"https://":"http://")+A}var F=m.now();if(z===a){D._asyncDownloadErrCodeErrStrings[F]={ec:m.errorInfo.getOkCode(),es:m.errorInfo.getOkString()}}var B=function(Q,S,P){var T=[x.preUrl,x.portInfo.curPort,"/",u._getVersionStrForCommand(),"/appendImageFromBytes?","session=",x.sessionId,"&object=",K._dwsObjectId,"&imageviewer=",D._imgViewer._imgViewerId,"&productkey=",u._getProductKey(),"&mode=","document","&ts=",m.now()].join(""),R=function(ac,aa,ae){if(z===t){L=K.getErrorCode()===m.errorInfo.getOkCode()}else{if(D._asyncDownloadErrCodeErrStrings[F]){K._setErrCodeErrString(D._asyncDownloadErrCodeErrStrings[F].ec,D._asyncDownloadErrCodeErrStrings[F].es)}if(K.getErrorCode()===m.errorInfo.getOkCode()){if(m.isFunction(H)){setTimeout(function(){H()},0)}}else{M();if(m.isFunction(N)){setTimeout(function(){N(C,J,"")},0)}}}if(z===a){delete D._asyncDownloadErrCodeErrStrings[F]}var ab=K.getErrorCode(),V=K.getErrorString();var X=0,U,Y=D._imgViewer.image._getIndex(),Z=D._imgViewer.image._getSelectedIndices().slice();if(ac&&m.isArray(ac.result)&&m.isNumber(ac.result[2])){X=ac.result[2]}for(U=0;U<X;U++){E._addImageControl()}var W=D._imgViewer.image._getIndex(),ad=[];if(X>0&&W>Y){for(U=0;U<X;U++){ad.push(W-U)}ad.sort(function(ag,af){return ag-af});setTimeout(function(){D._imgViewer.image._innerSetIndexInfo(Y,Z,W,ad,!D._imgViewer.ui._bSingleMode,true)},200)}K._setErrCodeErrString(ab,V)},O=function(W,V,U){if(z===a&&D._asyncDownloadErrCodeErrStrings[F]&&D._asyncDownloadErrCodeErrStrings[F].ec===m.errorInfo.getDataFormatInvalidCode()||z!==a&&K.getErrorCode()===m.errorInfo.getDataFormatInvalidCode()){K._setErrCodeErrString(m.errorInfo.getDataFormatInvalidCode(),m.errorInfo.getDataFormatInvalidString(!0))}if(z===t){L=!1}else{if(D._asyncDownloadErrCodeErrStrings[F]&&D._asyncDownloadErrCodeErrStrings[F].ec!==m.errorInfo.getDataFormatInvalidCode()){K._setErrCodeErrString(D._asyncDownloadErrCodeErrStrings[F].ec,D._asyncDownloadErrCodeErrStrings[F].es)}M();if(m.isFunction(N)){setTimeout(function(){N(C,J,"")},0)}}if(z===a){delete D._asyncDownloadErrCodeErrStrings[F]}};D._HTTPResponse="";if(z===a){D._asyncDownloadErrCodeErrStrings[F]={ec:m.errorInfo.getOkCode(),es:m.errorInfo.getOkString()}}D._sendImgDataToService(T,Q,z===a,R,O,F)},I=function(R,S,P){D._HTTPResponse=R?R:"";if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<10){D._HTTPResponse=P.nativeXhr.responseText}var O=0;try{O=P.nativeXhr.status}catch(Q){O=0}if(!S||S.indexOf(m.ajax._strOpenErr)!==-1||S.indexOf(m.ajax._strSendErr)!==-1||u.navInfo.bIE&&S.toLowerCase().indexOf("unknown")!==-1){K._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("url"))}else{K._setErrCodeErrString(m.errorInfo.getHttpErrorCode(),m.errorInfo.getHttpErrorString(O))}if(z===t){L=!1}else{M();if(m.isFunction(N)){setTimeout(function(){N(C,J,D._HTTPResponse)},0)}}if(z===a){delete D._asyncDownloadErrCodeErrStrings[F]}};D._download(A,z===a,B,I,G);if(z===t){return L}}});e.prototype._download=function(A,C,G,B,D){var z=-1,F=C&&m.isFunction(D)?function(J,L){var K=J.total===0?100:Math.round(J.loaded*100/J.total),I;if(z!==K){I=D(K)}z=K;if(I===true){L.abort()}}:false,H=C&&m.isFunction(D)?function(I,J){if(!I||u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<=9){return null}m.addEventListener(I,"progress",function(K){delete K.totalSize;delete K.position;F(K,I)})}:!1,E={beforeSend:H,method:"GET",url:A,dataType:"blob",onSuccess:G,onError:B,async:C};if(C){if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<10){E.contentType="text/plain; charset=x-user-defined";E.mimeType="text/plain; charset=x-user-defined";E.headers={"Accept-Charset":"x-user-defined"}}else{E.xhrFields={responseType:u.navInfo.bSafari?"arraybuffer":"blob"};E.onError=function(M,O,J){if(u.navInfo.bSafari){var N;try{N=String.fromCharCode.apply(null,new Uint8Array(M))}catch(K){N=""}B(N,O,J)}else{var I=new window.FileReader;try{I.readAsText(M)}catch(L){B("",O,J)}I.onloadend=function(){var P=I.result;B(P,O,J)}}}}}else{if(u.navInfo.bIE&&u.navInfo.bHTML5Edition&&window.Uint8Array){E.xhrFields={responseType:"arraybuffer"};E.onSuccess=function(K,L,J){var I=null;if(K){I=new Uint8Array(K)}G(I,L,J)};E.onError=function(K,M,I){var L;try{L=String.fromCharCode.apply(null,new Uint8Array(K))}catch(J){L=""}B(L,M,I)}}else{E.contentType="text/plain; charset=x-user-defined";E.mimeType="text/plain; charset=x-user-defined";if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<10){E.headers={"Accept-Charset":"x-user-defined"}}E.onSuccess=function(M,O,K){var N,J,I;if(u.navInfo.bIE){I=K.nativeXhr.responseBody}else{N=K.nativeXhr.responseText;J=N.length;I=new Uint8Array(J);for(var L=0;L<J;L++){I[L]=N.charCodeAt(L)}}G(u.navInfo.bSafari?I.buffer:I,O,K)}}}m.ajax(E)};e.prototype._sendImgDataToService=function(z,B,A,H,C,G){var E=this,I=E._dwsObject,F=function(M,L,K){if(x.isValidResponseValue(M)){if(m.errorInfo.isUnknownCode(M.exception)){M.description=m.errorInfo.getUnknownString(M.exception,M.description);M.exception=EnumDCS_ErrorCode.Unknown}if(M.exception===EnumDCS_ErrorCode.ConnectionToServiceReset&&m.isString(M.description)){M.description=M.description.replace("Webcam","Camera")}if(M.exception===0){if(m.isFunction(H)){H(M,L,K)}}else{if(M.exception===m.errorInfo.getLicenseVerificationFailedCode()&&M.result){if(!A){I._setErrCodeErrString(M.exception,M.result[1])}if(A&&E._asyncDownloadErrCodeErrStrings[G]){E._asyncDownloadErrCodeErrStrings[G].ec=M.exception;E._asyncDownloadErrCodeErrStrings[G].es=M.result[1]}if(!x.isFullVersion&&M.result[0]!==1&&m.isFunction(H)){H(M)}}else{if(!A){I._setErrCodeErrString(M.exception,M.description)}if(A&&E._asyncDownloadErrCodeErrStrings[G]){E._asyncDownloadErrCodeErrStrings[G].ec=M.exception;E._asyncDownloadErrCodeErrStrings[G].es=M.description}}if(!(M.exception===m.errorInfo.getLicenseVerificationFailedCode()&&!x.isFullVersion&&M.result&&M.result[0]!==1)&&m.isFunction(C)){C(M,L,K)}}}},J=function(M,L,K){if(I instanceof m.sdk.DcsObject){if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<=9&&m.isString(L)&&(L.toLowerCase().indexOf("denied")!==-1||L.toLowerCase().indexOf(x.IE_PERMISSION_DENIED_Err_Code)!==-1||L.toLowerCase().indexOf(x.IE_Unknown_Err_Code)!==-1)){if(!A){I._setErrCodeErrString(m.errorInfo.getOperationNotSupportedCode(),m.errorInfo.getOperationNotSupportedString())}else{if(A&&E._asyncDownloadErrCodeErrStrings[G]){E._asyncDownloadErrCodeErrStrings[G].ec=m.errorInfo.getOperationNotSupportedCode();E._asyncDownloadErrCodeErrStrings[G].es=m.errorInfo.getOperationNotSupportedString()}}}else{if(!A){x.throwServiceNotConnectException(I)}else{if(A&&E._asyncDownloadErrCodeErrStrings[G]){E._asyncDownloadErrCodeErrStrings[G].ec=m.errorInfo.getConnectionToServiceLostCode();E._asyncDownloadErrCodeErrStrings[G].es=m.errorInfo.getConnectionToServiceLostString()}}}}if(m.isFunction(C)){C(M,L,K)}};z=z||[x.preUrl,x.portInfo.curPort,"/",u._getVersionStrForCommand(),"/ts=",m.now()].join("");A=A===undefined?!0:A;var D={method:"POST",url:z,data:B,dataType:"json",onSuccess:F,onError:J,async:A};if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<10){D.mimeType="text/plain; charset=x-user-defined";D.headers={"Accept-Charset":"x-user-defined"}}m.ajax(D)};var n="httpUpload",f="httpUploadAsync";m.each([n,f],function(z){e.prototype[z]=function(){var R=this,M=R._dwsObject,H=R._imgViewer.ui,I=!1,S=m.errorInfo.getOkCode(),N=m.errorInfo.getOkString(),G=function(X,W){S=X===undefined?M.getErrorCode():X;N=W===undefined?M.getErrorString():W};if(R._bDestoryed){return!1}M._setErrCodeErrString(m.errorInfo.getOkCode(),m.errorInfo.getOkString());if(M.getErrorCode()===m.errorInfo.getOkCode()&&!M._validateDivDom(H._getImgViewerId(),!0)){if(z===n){return I}else{G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&!M._validateImgViewerExist(H._getImgViewerId(),R._bRemoved)){if(z===n){return I}else{G()}}if(R._validateImgIsHandlingAsyncOperation()){return!1}if(z===n){if(M.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length<3){M._setErrCodeErrString(m.errorInfo.getParameterNumberUnmatchedCode(),m.errorInfo.getParameterNumberUnmatchedString(!0));return I}if(M.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length>5){M._setErrCodeErrString(m.errorInfo.getParameterNumberUnmatchedCode(),m.errorInfo.getParameterNumberUnmatchedString(!1));return I}}else{if(M.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length<5){S=m.errorInfo.getParameterNumberUnmatchedCode();N=m.errorInfo.getParameterNumberUnmatchedString(!0);M._setErrCodeErrString(S,N)}if(M.getErrorCode()===m.errorInfo.getOkCode()&&arguments.length>8){S=m.errorInfo.getParameterNumberUnmatchedCode();N=m.errorInfo.getParameterNumberUnmatchedString(!1);M._setErrCodeErrString(S,N)}}var E=arguments[0],F=arguments[1],A=arguments[2],O,V,Q,T,J;if(z===n){O=arguments[3]===undefined?r.POST:arguments[3];V=arguments[4]===undefined?h.BINARY:arguments[4]}else{Q=arguments[3];T=arguments[4];J=arguments[5]===undefined?null:arguments[5];O=arguments[6]===undefined?r.POST:arguments[6];V=arguments[7]===undefined?!!window.Blob?h.BINARY:h.BASE64:arguments[7]}if(M.getErrorCode()===m.errorInfo.getOkCode()&&!M._validateStringType("url",E)){if(z===n){return I}else{G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&!M._validateArrayType("indices",F)){if(z===n){return I}else{G()}}F=R._getValidatedIndices(F);if(M.getErrorCode()===m.errorInfo.getOkCode()&&F===null){M._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("indices"));if(z===n){return I}else{G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&F.length>1&&(A!==b.TIFF&&A!=b.PDF)){M._setErrCodeErrString(m.errorInfo.getMultipageNotSupportedCode(),m.errorInfo.getMultipageNotSupportedString());if(z===n){return I}else{G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&!R._isValidValueInEnum(b,A,"imageType")){if(z===n){return I}else{G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&!R._isValidValueInEnum(r,O,"httpMethod")){if(z===n){return I}else{G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&!R._isValidValueInEnum(h,V,"dataFormat")){if(z===n){return I}else{G()}}if(!window.Blob&&V===h.BINARY){V=h.BASE64}var L=parseFloat(u.navInfo.strBrowserVersion);if(u.navInfo.bSafari&&!isNaN(L)&&L<6&&V===h.BINARY){V=h.BASE64}if(z===f){if(M.getErrorCode()===m.errorInfo.getOkCode()&&Q!==null&&!m.isFunction(Q)){
M._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpUploadSuccess"));G()}if(M.getErrorCode()===m.errorInfo.getOkCode()&&T!==null&&!m.isFunction(T)){M._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpUploadFailure"))}if(M.getErrorCode()===m.errorInfo.getOkCode()&&J!==null&&!m.isFunction(J)){M._setErrCodeErrString(m.errorInfo.getTypeNotValidCode(),m.errorInfo.getTypeNotValidString("onHttpUploading"));G()}}if(M.getErrorCode()===m.errorInfo.getOkCode()&&(R._bPropertiesChanged||A==b.PDF&&(R.pdfinfo._pdfCreationDate===null||R.pdfinfo._pdfModifiedDate===null))){var C=R._sendPropertiesToBackend();if(!C){if(z===n){return I}else{G()}}}if(z===f&&M.getErrorCode()!==m.errorInfo.getOkCode()){if(m.isFunction(T)){setTimeout(function(){T(S,N,"")},0)}return null}var K=m.now();if(z===f){R._asyncUploadErrCodeErrStrings[K]={ec:m.errorInfo.getOkCode(),es:m.errorInfo.getOkString()}}var U,P={session:x.sessionId,object:M._dwsObjectId,method:"GetImageData",parameter:[R._imgViewer._imgViewerId,F,A,V]},D=function(Y){U=Y;if(E.trim().length===0){E="invalidUrl"}if(!m.startsWith(E,"http://")&&!m.startsWith(E,"https://")){E=(u.navInfo.bSSL?"https://":"http://")+E}var W=R._composeUploadData(U,A,V===h.BASE64),Z=function(aa){R._HTTPResponse=aa?aa.toString():"";if(z===n){I=!0}else{if(R._asyncUploadErrCodeErrStrings[K]){M._setErrCodeErrString(R._asyncUploadErrCodeErrStrings[K].ec,R._asyncUploadErrCodeErrStrings[K].es)}if(m.isFunction(Q)){setTimeout(function(){Q(R._HTTPResponse)},0)}}if(z===f){delete R._asyncUploadErrCodeErrStrings[K]}},X=function(ad,ae,ab){R._HTTPResponse=ad?ad.toString():"";var aa=0;try{aa=ab.nativeXhr.status}catch(ac){aa=0}if(!ae||ae.indexOf(m.ajax._strOpenErr)!==-1||ae.indexOf(m.ajax._strSendErr)!==-1||u.navInfo.bIE&&ae.toLowerCase().indexOf("unknown")!==-1){M._setErrCodeErrString(m.errorInfo.getValueNotValidCode(),m.errorInfo.getValueNotValidString("url"))}else{M._setErrCodeErrString(m.errorInfo.getHttpErrorCode(),m.errorInfo.getHttpErrorString(aa))}if(z===n){I=!1}else{G();if(m.isFunction(T)){setTimeout(function(){T(S,N,R._HTTPResponse)},0)}}if(z===f){delete R._asyncUploadErrCodeErrStrings[K]}};if(z===f){R._asyncUploadErrCodeErrStrings[K]={ec:m.errorInfo.getOkCode(),es:m.errorInfo.getOkString()}}R._upload(E,O===r.POST?"POST":"PUT",z===f,W,Z,X,J,V)},B=function(Y,X,W){R._HTTPResponse="";if(z===n){I=!1}else{if(R._asyncUploadErrCodeErrStrings[K]){M._setErrCodeErrString(R._asyncUploadErrCodeErrStrings[K].ec,R._asyncUploadErrCodeErrStrings[K].es)}G();if(m.isFunction(T)){setTimeout(function(){T(S,N,"")},0)}}if(z===f){delete R._asyncUploadErrCodeErrStrings[K]}};R._getImgDataFromService(V,m.stringify(P),z===f,D,B,K);if(z===n){return I}}});var p="";e.prototype._composeUploadData=function(A,D,H){var C,G,E;switch(D){case b.BMP:G=".bmp";break;case b.JPEG:G=".jpg";break;case b.PDF:G=".pdf";break;case b.PNG:G=".png";break;case b.TIFF:G=".tif";break;default:G="";break}if(H){var F="\r\n",z="--",I="";p=["----DynamsoftWebCamFormBoundary",m.now()].join("");for(E in this._HTTPFormFields){I=[I,z,p,F,"Content-Disposition: form-data; ",'name="',E,'"',F,F,this._HTTPFormFields[E],F].join("")}I=[I,z,p,F,"Content-Disposition: form-data; ",'name="RemoteFile"; ','filename="',m.now(),G,'"',F,"Content-Type: text/plain; charset=utf-8",F,F,A,F,z,p,z].join("");C=I}else{var B=new FormData;for(E in this._HTTPFormFields){B.append(E,this._HTTPFormFields[E])}B.append("RemoteFile",A,m.now()+G);C=B}return C};e.prototype._getImgDataFromService=function(I,C,B,H,D,E){C=C||null;var F=this,L=F._dwsObject,z=[x.preUrl,x.portInfo.curPort,"/",u._getVersionStrForCommand(),"/ts=",m.now()].join(""),G=function(T,S,O){var R=null,Q=function(){try{R=m.parse(T)}catch(U){R=null}if(m.isObject(R)&&R.exception!==undefined){if(m.errorInfo.isUnknownCode(R.exception)){R.description=m.errorInfo.getUnknownString(R.exception,R.description);R.exception=EnumDCS_ErrorCode.Unknown}if(R.exception===EnumDCS_ErrorCode.ConnectionToServiceReset&&m.isString(R.description)){R.description=R.description.replace("Webcam","Camera")}if(!B&&L instanceof m.sdk.DcsObject){L._setErrCodeErrString(R.exception,R.description)}if(B&&F._asyncUploadErrCodeErrStrings[E]){F._asyncUploadErrCodeErrStrings[E].ec=R.exception;F._asyncUploadErrCodeErrStrings[E].es=R.description}if(m.isFunction(D)){D(T,S,O)}}else{if(m.isFunction(H)){H(T)}}};if(B&&window.Blob&&T instanceof window.Blob&&window.FileReader){var N=new window.FileReader;try{N.readAsText(T)}catch(P){Q()}N.onloadend=function(){var W=N.result,U=null;try{U=m.parse(W)}catch(V){U=null}if(U&&U.exception!==undefined){T=W}Q()}}else{Q()}},M=function(P,O,N){if(L instanceof m.sdk.DcsObject){if(u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<=9&&m.isString(O)&&(O.toLowerCase().indexOf("denied")!==-1||O.toLowerCase().indexOf(x.IE_PERMISSION_DENIED_Err_Code)!==-1||O.toLowerCase().indexOf(x.IE_Unknown_Err_Code)!==-1)){if(!B){L._setErrCodeErrString(m.errorInfo.getOperationNotSupportedCode(),m.errorInfo.getOperationNotSupportedString())}else{if(B&&F._asyncUploadErrCodeErrStrings[E]){F._asyncUploadErrCodeErrStrings[E].ec=m.errorInfo.getOperationNotSupportedCode();F._asyncUploadErrCodeErrStrings[E].es=m.errorInfo.getOperationNotSupportedString()}}}else{if(!B){x.throwServiceNotConnectException(L)}else{if(B&&F._asyncUploadErrCodeErrStrings[E]){F._asyncUploadErrCodeErrStrings[E].ec=m.errorInfo.getConnectionToServiceLostCode();F._asyncUploadErrCodeErrStrings[E].es=m.errorInfo.getConnectionToServiceLostString()}}}}if(m.isFunction(D)){D(P,O,N)}},A=I===h.BASE64?"text/plain; charset=utf-8":"application/octet-stream";cfg={method:"POST",url:z,data:C,dataType:"user-defined",onSuccess:G,onError:M,mimeType:A,async:B};var K=function(R,T,O){var N=null,Q=null,S;try{S=String.fromCharCode.apply(null,new Uint8Array(R));Q=m.parse(S)}catch(P){Q=null}if(m.isObject(Q)&&Q.exception!==undefined){N=S}else{if(I!==h.BASE64){if(R){N=new Uint8Array(R);N=new Blob([N],{type:A})}}else{N=R}}G(N,T,O)};B=B===undefined?!0:B;if(B){if(I!==h.BASE64){cfg.xhrFields={responseType:"blob"};var J=parseFloat(u.navInfo.strBrowserVersion);if(u.navInfo.bSafari&&!isNaN(J)&&J<6.1){cfg.xhrFields={responseType:"arraybuffer"};cfg.onSuccess=K}}}else{if(u.navInfo.bIE&&u.navInfo.bHTML5Edition&&window.Uint8Array){if(I!==h.BASE64){cfg.xhrFields={responseType:"arraybuffer"}}cfg.onSuccess=K}else{cfg.contentType="text/plain; charset=x-user-defined";cfg.mimeType="text/plain; charset=x-user-defined";cfg.onSuccess=function(N,O,T){var R,P,S,V=null;try{V=m.parse(N)}catch(U){V=null}if(m.isObject(V)&&V.exception!==undefined){S=N}else{if(I!==h.BASE64){R=T.nativeXhr.responseText;P=R.length;S=new Uint8Array(P);for(var Q=0;Q<P;Q++){S[Q]=R.charCodeAt(Q)}S=new Blob([S],{type:A})}else{S=T.nativeXhr.responseText}}G(S,O,T)}}}m.ajax(cfg)};e.prototype._upload=function(A,F,C,E,H,B,D,I){var z=-1,G=C&&m.isFunction(D)?function(L,N){var M=L.total===0?100:Math.round(L.loaded*100/L.total),K;if(z!==M){K=D(M)}z=M;if(K===true){N.abort()}}:false,J=C&&m.isFunction(D)?function(K,L){if(!K||!K.upload||u.navInfo.bIE&&parseInt(u.navInfo.strBrowserVersion)<=9){return null}m.addEventListener(K.upload,"progress",function(M){delete M.totalSize;delete M.position;G(M,K)})}:!1;m.ajax({method:F,url:A,data:E,beforeSend:J,contentType:I===h.BINARY?false:"multipart/form-data; boundary="+p,dataType:"user-defined",onSuccess:H,onError:B,async:C})};e.prototype._destory=function(z){if(!z){this._bDestoryed=true}else{this._bRemoved=true}};l.IO=e})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(g,e){var l="PDF",m=l.toLowerCase(),d="get",f="set",b="iValue",a=["Author","CompressionType","CreationDate","ModifiedDate","Creator","Producer","Subject","Keywords","Title","Version"],k=[],j={AUTO:0,FAX3:1,FAX4:2,LZW:3,JPEG:4};function h(o){var n=this;n._io=o;n.EnumPDFCompressionType=j;g.each(a,function(p){n["_"+m+p]=p==="CreationDate"||p==="ModifiedDate"?null:p==="CompressionType"?j.AUTO:""})}g.each(a,function(n){k.push(d+l+n);k.push(f+l+n)});g.each(k,function(n){h.prototype[n]=function(){var t=this,o=t._io._dwsObject;if(t._io._bDestoryed){return false}if(!o._validateDivDom(t._io._imgViewer.ui._getImgViewerId(),!0)){return n.indexOf(d)===0?undefined:false}if(!o._validateImgViewerExist(t._io._imgViewer.ui._getImgViewerId(),t._io._bRemoved)){return n.indexOf(d)===0?undefined:false}if(n.indexOf(d)===0){if(!o._validateParamNum(arguments,0)){return null}}else{if(!o._validateParamNum(arguments,1)){return false}if(dynamsoft.lib.endsWith(n,"CreationDate")||dynamsoft.lib.endsWith(n,"ModifiedDate")){if(!(arguments[0]instanceof Date)){o._setErrCodeErrString(g.errorInfo.getTypeNotValidCode(),g.errorInfo.getTypeNotValidString(b));return false}var r=dynamsoft.lib.endsWith(n,"ModifiedDate")?this["_"+m+"CreationDate"]:this["_"+m+"ModifiedDate"],p=arguments[0];if(r!==null){if(dynamsoft.lib.endsWith(n,"ModifiedDate")&&r.getTime()>p.getTime()||dynamsoft.lib.endsWith(n,"CreationDate")&&r.getTime()<p.getTime()){o._setErrCodeErrString(g.errorInfo.getValueNotValidCode(),"Modified date must be greater than creation date.");return false}}}else{if(dynamsoft.lib.endsWith(n,"CompressionType")){if(!o._validateNumberType(b,arguments[0])||!t._io._isValidValueInEnum(j,arguments[0],b)){return false}}else{if(!o._validateStringType(b,arguments[0])){return false}}}}var q=-1,s="";for(q=0;q<a.length;q++){if(n.indexOf(a[q])!==-1){s=a[q];break}}o._setErrCodeErrString(g.errorInfo.getOkCode(),g.errorInfo.getOkString());if(n.indexOf(d)===0){return t["_"+m+s]}else{if(t["_"+m+s]!==arguments[0]){t._io._bPropertiesChanged=!0}t["_"+m+s]=arguments[0];return true}}});h.prototype._getJsonObj=function(){var t={},r="",s=null;for(var q=0;q<a.length;q++){r=a[q];s=this["_"+m+r];s=s===null?"":s;t[r]=r==="CreationDate"||a[q]==="ModifiedDate"?s.toString():s}var o=new Date,n=this["_"+m+"CreationDate"],p=this["_"+m+"ModifiedDate"];if(n===null&&p===null){t.ModifiedDate=t.CreationDate=this._yyyymmddhhMMss(o)}else{if(n!==null&&p!==null){t.CreationDate=this._yyyymmddhhMMss(n);t.ModifiedDate=this._yyyymmddhhMMss(p)}else{t.ModifiedDate=t.CreationDate=this._yyyymmddhhMMss(n===null?p:n)}}return t};h.prototype._yyyymmddhhMMss=function(o){if(!(o instanceof Date)){return""}var r=o.getFullYear(),s=o.getMonth()+1,p=o.getDate(),n=o.getHours(),u=o.getMinutes(),q=o.getSeconds();var t=function(v){return(v>9?"":"0")+v};return[r,t(s),t(p),t(n),t(u),t(q)].join("")};e.PdfInfo=h})(dynamsoft.lib,dynamsoft.lib.sdk);(function(e,d,b){function a(f){if(f&&f._documentEditorManager){return}this._dwsObject=f}a.prototype.addDocumentEditor=function(h,g){var l=this,f=!0;if(!e.isString(g)||g.indexOf(d._dcoEditorClientIdPrefix)==-1){g=d._dcoEditorClientIdPrefix+e.getRandom();var k={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"AddDocumentEditor",parameter:[g]};f=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(k),null,null)}if(f){var j=new b.DocumentEditor(l._dwsObject,h,g);d._documentEditorDic[h]={dwsObject:l._dwsObject,documentEditor:j}}return f};a.prototype.removeDocumentEditor=function(g){var l=this,f=false,k=d._documentEditorDic[g],j=k.documentEditor,h={session:dynamsoft.lib.detect.sessionId,object:l._dwsObject._dwsObjectId,method:"RemoveDocumentEditor",parameter:[j._docEditorId]};f=dynamsoft.lib.detect.postSyncCommand(l._dwsObject,e.stringify(h),null,null);if(f){j.ui._destory(true);j.document._destory(true);delete d._documentEditorDic[g]}return f};b.DocumentEditorManager=a})(dynamsoft.lib,dynamsoft.dcsEnv,dynamsoft.lib.sdk);(function(d,a){function b(e,g,f){var h=this;this._innerIndex=d.guid();h._dwsObject=e;h._docEditorId=f;h.imageViewer=null;h.document=new a.Document(e,h);h.ui=new a.documentUI(e,h,g);h.documentCtrl=new a.DocumentControl(e,h)}a.DocumentEditor=b})(dynamsoft.lib,dynamsoft.lib.sdk);(function(l,h,m,a){function d(o,n,p){var r=this;r._dwsObject=o;r._documentEditor=n;r._documentContainerId=p;r._userDocumentContainer=l.one("#"+p).getEL();l.empty(r._userDocumentContainer);var q=l.getElDimensions(r._userDocumentContainer,false);r._userDocumentEditorWidth=q?q.clientWidth:r._userDocumentContainer.clientWidth;r._userDocumentEditorHeight=q?q.clientHeight:r._userDocumentContainer.clientHeight;r._userDocumentContainer.innerHTML='<div class="ds-dws-doc-editor-wrapper" oncontextmenu="return false;"><div class="ds-dws-doc-editor-container ds-dws-display-inline-block"><div class="ds-dws-doc-obj-container"></div><canvas class="canvas-editer"></canvas></div></div>';r._documentContainerWrapper=l.one(".ds-dws-doc-editor-wrapper",r._userDocumentContainer).getEL();r._documentContainerWrapper.style.width=r._userDocumentEditorWidth+"px";r._documentContainerWrapper.style.height=r._userDocumentEditorHeight+"px";r._documentContainerBox=l.one(".ds-dws-doc-editor-container",r._documentContainerWrapper).getEL();r._documentContainerBox.style.position="relative";r._documentContainerBox.style.width=r._userDocumentEditorWidth+"px";r._documentContainerBox.style.height=r._userDocumentEditorHeight+"px";r._documentContainerImageObj=l.one(".ds-dws-doc-obj-container",r._documentContainerBox).getEL();r._documentContainerImageObj.style.position="relative";r._documentContainerCanvasEditor=l.one(".canvas-editer",r._documentContainerBox).getEL();r._documentContainerCanvasEditor.style.position="absolute";r._documentContainerCanvasEditor.style.top=0;r._documentContainerCanvasEditor.style.left=0;r._documentContainerCanvasEditor.setAttribute("onselectstart","return false;");r._documentContainerCanvasEditor.setAttribute("draggable","return false;");r._pointInfo=new Array(8);r._MINZOOM=.02,r._MAXZOOM=65;r._zoom=1;r._documentBoundaryColor=1589110015;r._backgroundColor=4294967295;r._documentBoundaryThickness=2;r.MINTHICKNESS=0;r.MAXTHICKNESS=1e5;r._zoomSet=false;r.onmouseclick=null;r.onmousemove=null;r._displayMode="";r._bDestoryed=false;r._bRemoved=false}d.prototype._getDocEditorId=function(){return this._documentContainerId};d.prototype._getDocEditorEl=function(){try{return l.one("#"+this._documentContainerId).getEL()}catch(n){return false}};d.prototype.setDocumentBoundaryThickness=function(n){var o=this;if(o._bDestoryed){return false}if(!o._dwsObject._validateDivDom(o._getDocEditorId(),"document")){return false}if(!o._dwsObject._validateDocEditorExist(o._getDocEditorId(),o._bRemoved)){return false}if(!o._dwsObject._validateParamNum(arguments,1)||!o._dwsObject._validateNumberType("thickness",n)){return false}if(!o._dwsObject._validateValue("thickness",n,[o.MINTHICKNESS,o.MAXTHICKNESS],true)){return false}o._documentBoundaryThickness=Math.round(n);o._refresh();return true};d.prototype.getDocumentBoundaryThickness=function(){var n=this;if(n._bDestoryed){return null}if(!n._dwsObject._validateDivDom(n._getDocEditorId(),"document")){return null}if(!n._dwsObject._validateDocEditorExist(n._getDocEditorId(),n._bRemoved)){return null}if(!n._dwsObject._validateParamNum(arguments,0)){return null}return n._documentBoundaryThickness};d.prototype.getZoom=function(){var n=this;if(n._bDestoryed){return null}if(n._dwsObject._bDestoryed){return null}if(!n._dwsObject._validateDivDom(n._getDocEditorId(),"document")){return null}if(!n._dwsObject._validateDocEditorExist(n._getDocEditorId(),n._bRemoved)){return null}if(!n._dwsObject._validateParamNum(arguments,0)){return null}return n._zoom};d.prototype.setZoom=function(n){var o=this;if(o._bDestoryed){return false}if(o._dwsObject._bDestoryed){return false}if(!o._dwsObject._validateDivDom(o._getDocEditorId(),"document")){return false}if(!o._dwsObject._validateDocEditorExist(o._getDocEditorId(),o._bRemoved)){return false}if(!o._dwsObject._validateParamNum(arguments,1)||!o._dwsObject._validateNumberType("zoomValue",n)){return false}if(!o._dwsObject._validateValue("zoomValue",n,[o._MINZOOM,o._MAXZOOM],true)){return false}o._zoom=n;o._zoomSet=true;o._refresh();return true};var e="getBackgroundColor",b="setBackgroundColor",j="getDocumentBoundaryColor",f="setDocumentBoundaryColor",k=0,g=4294967295;l.each([e,b,j,f],function(n){d.prototype[n]=function(){var o=this;if(o._bDestoryed){if(n==e||n==j){return null}return false}if(o._dwsObject._bDestoryed){if(n==e||n==j){return null}return false}if(!o._dwsObject._validateDivDom(o._getDocEditorId(),"document")){return n==e||n==j?null:false}if(!o._dwsObject._validateDocEditorExist(o._getDocEditorId(),o._bRemoved)){return n==e||n==j?null:false}if(n==e||n==j){if(!o._dwsObject._validateParamNum(arguments,0)){return null}}if(n==b||n==f){if(!o._dwsObject._validateParamNum(arguments,1)||!o._dwsObject._validateNumberType("color",arguments[0])||!o._dwsObject._validateValue("color",arguments[0],[k,g],true)){return false}}if(n==e){return o._backgroundColor}if(n==b){o._backgroundColor=arguments[0];o._userDocumentContainer.style.backgroundColor=l.IntToColorStr(arguments[0]);return true}if(n==j){return o._documentBoundaryColor}if(n==f){o._documentBoundaryColor=arguments[0];o._refresh();return true}}});l.each(["getContainerId","show","hide"],function(n){d.prototype[n]=function(){var p=this;if(p._bDestoryed){return n=="getContainerId"?null:false}var o=p._getDocEditorId();if(!p._dwsObject._validateDivDom(o,"document")){return n=="getContainerId"?null:false}if(!p._dwsObject._validateDocEditorExist(p._getDocEditorId(),p._bRemoved)){return n=="getContainerId"?null:false}if(!p._dwsObject._validateParamNum(arguments,0)){return n=="getContainerId"?null:false}if(n=="getContainerId"){return o}if(n=="show"){p._displayMode=p._displayMode=="none"?"":p._displayMode;if(p._userDocumentContainer.style.display=="none"){p._userDocumentContainer.style.display=p._displayMode}else{p._displayMode=p._userDocumentContainer.style.display}return true}if(n=="hide"){if(p._userDocumentContainer.style.display!="none"){p._displayMode=p._userDocumentContainer.style.display}p._userDocumentContainer.style.display="none";p._displayMode=p._displayMode=="none"?"":p._displayMode;return true}return false}});d.prototype._refresh=function(){var n=this;n._documentEditor.documentCtrl.refreshUI()};d.prototype._GetPointInfo=function(){var q=this,p=q._documentEditor.documentCtrl.updateMovePointInfo();for(var o=0;o<p.length;o++){q._pointInfo[o]=Math.round(p[o])}for(var o=0;o<p.length/2;o++){for(var n=0;n<p.length/2;n++){if(o!=n&&q._pointInfo[2*o]==q._pointInfo[2*n]){if(q._pointInfo[2*o+1]==q._pointInfo[2*n+1]){q._pointInfo[2*o]++}}}}for(var o=0;o<q._pointInfo.length;o++){if(isNaN(q._pointInfo[o])){q._pointInfo[o]=o+1}}return q._pointInfo};d.prototype._destory=function(n){var o=this;l.empty(o._userDocumentContainer);if(!n){o._bDestoryed=true}else{o._bRemoved=true}o._zoomSet=false};h.documentUI=d})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.dcsEnv,dynamsoft.lib.detect);(function(g,e,d,f){function b(j,h){var k=this;k._dwsObject=j;k._documentEditor=h;k._MINADJUSTABLE=-100;k._MAXADJUSTABLE=100;k._bDiscard=false;k._bDestoryed=false;k._bRemoved=false}b.prototype.adjustContrast=function(j){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("contrast",j)){return false}if(!l._dwsObject._validateValue("contrast",j,[l._MINADJUSTABLE,l._MAXADJUSTABLE],true)){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"AdjustContrastOriginal",parameter:[l._documentEditor._docEditorId,j]};var h=g.detect.postSyncCommand(l._dwsObject,g.stringify(k),null,null);if(h){l._documentEditor.documentCtrl.refreshSrc();return true}return false};b.prototype.adjustBrightness=function(k){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,1)||!l._dwsObject._validateNumberType("brightness",k)){return false}if(!l._dwsObject._validateValue("brightness",k,[l._MINADJUSTABLE,l._MAXADJUSTABLE],true)){return false}var j={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"AdjustBrightnessOriginal",parameter:[l._documentEditor._docEditorId,k]};var h=g.detect.postSyncCommand(l._dwsObject,g.stringify(j),null,null);if(h){l._documentEditor.documentCtrl.refreshSrc();return true}return false};var a=["rotateLeft","rotateRight"];g.each(a,function(h){b.prototype[h]=function(){var m=this,l;if(h=="rotateLeft"){l="left"}else{l="right"}if(m._bDestoryed){return false}if(!m._dwsObject._validateDivDom(m._documentEditor.ui._getDocEditorId(),"document")){return false}if(!m._dwsObject._validateDocEditorExist(m._documentEditor.ui._getDocEditorId(),m._bRemoved)){return false}if(!m._dwsObject._validateParamNum(arguments,0)){return false}var k={session:d.sessionId,object:m._dwsObject._dwsObjectId,method:g.upperCaseFirst(h)+"Original",parameter:[m._documentEditor._docEditorId]};var j=g.detect.postSyncCommand(m._dwsObject,g.stringify(k),null,null);if(j){m._documentEditor.documentCtrl.refreshRotate(l);return true}return false}});g.each(["toColor","toGrey"],function(h){b.prototype[h]=function(){var l=this;if(l._bDestoryed){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(!l._dwsObject._validateParamNum(arguments,0)){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:g.upperCaseFirst(h)+"Original",parameter:[l._documentEditor._docEditorId]};var j=g.detect.postSyncCommand(l._dwsObject,g.stringify(k),null,null);if(j){l._documentEditor.documentCtrl.refreshSrc();return true}return false}});b.prototype.ondiscardmodified=function(){return false};b.prototype.discard=function(){var n=this;if(n._bDestoryed){return false}if(!n._dwsObject._validateDivDom(n._documentEditor.ui._getDocEditorId(),"document")){return false}if(!n._dwsObject._validateDocEditorExist(n._documentEditor.ui._getDocEditorId(),n._bRemoved)){return false}if(!n._dwsObject._validateParamNum(arguments,0)){return false}var k={session:d.sessionId,object:n._dwsObject._dwsObjectId,method:"DiscardDocument",parameter:[n._documentEditor._docEditorId,n._bDiscard]},j=function(){n._documentEditor.documentCtrl.destroy()},m=function(o){};var h=g.detect.postSyncCommand(n._dwsObject,g.stringify(k),j,m);if(h){n._bDiscard=false;return true}else{if(n._dwsObject.getErrorCode()==-3001){var l;if(g.isFunction(n.ondiscardmodified)){l=n.ondiscardmodified()}else{l=n.ondiscardmodified}if(l==true){n._dwsObject._setErrCodeErrString(g.errorInfo.getOperationCancelledCode(),g.errorInfo.getOperationCancelledString());return false}else{n._bDiscard=true;n.discard();return true}}else{if(n._dwsObject.getErrorCode()==-1028){n._dwsObject._setErrCodeErrString(g.errorInfo.getDocumentNotExistCode(),g.errorInfo.getDocumentNotExistString());return false}else{return false}}}};b.prototype.save=function(){var l=this,j=false;if(l._bDestoryed){return false}if(!l._dwsObject._validateParamNum(arguments,0)){return false}if(!l._dwsObject._validateDivDom(l._documentEditor.ui._getDocEditorId(),"document")){return false}if(l._documentEditor.imageViewer&&!l._dwsObject._validateDivDom(l._documentEditor.imageViewer.ui._getImgViewerId(),!0)){return false}if(!l._dwsObject._validateDocEditorExist(l._documentEditor.ui._getDocEditorId(),l._bRemoved)){return false}if(l._documentEditor.imageViewer&&!l._dwsObject._validateImgViewerExist(l._documentEditor.imageViewer.ui._getImgViewerId(),l._bRemoved)){return false}if(l._documentEditor.imageViewer&&l._documentEditor.imageViewer.io._validateImgIsHandlingAsyncOperation()){return false}var k={session:d.sessionId,object:l._dwsObject._dwsObjectId,method:"SaveDocument",parameter:[l._documentEditor._docEditorId,l._documentEditor.ui._GetPointInfo()]},h=function(r){var n=l._dwsObject.getErrorCode(),s=l._dwsObject.getErrorString();var t=r.result[0].imageviewid;var q;var p=r.result[0].index;var m=r.result[0].result;if(m==true){for(var o in f._imageViewerDic){if(f._imageViewerDic[o].imgViewerClientId==t){q=f._imageViewerDic[o].imageViewer}}l._documentEditor.documentCtrl.destroy();q.image._updatedImage(p);j=true}else{l._dwsObject._setErrCodeErrString(n,s);return false}};g.detect.postSyncCommand(l._dwsObject,g.stringify(k),h,null);return j};b.prototype.saveAs=function(n){var m=this;if(m._bDestoryed){return false}if(!m._dwsObject._validateParamNum(arguments,1)||!m._dwsObject._validateStringType("imageViewerContainerId",n)){return false}if(!m._dwsObject._validateDivDom(n,!0)){return false}if(!m._dwsObject._validateDivDom(m._documentEditor.ui._getDocEditorId(),!0)){return false}var h=f._documentEditorDic[n];var l=f._videoViewerDic[n];if(h||l){m._dwsObject._setErrCodeErrString(g.errorInfo.getObjectOccupiedCode(),g.errorInfo.getObjectOccupiedString(n));return false}if(!m._dwsObject._validateDocEditorExist(m._documentEditor.ui._getDocEditorId(),m._bRemoved)){return false}if(!m._dwsObject._validateImgViewerExist(n,m._bRemoved)){return false}var j=f._imageViewerDic[n];var p=j.imageViewer;if(p.io._validateImgIsHandlingAsyncOperation()){return false}if(p.image.getCount()==p.image.getCapacity()){m._dwsObject._setErrCodeErrString(g.errorInfo.getBufferIsFullCode(),g.errorInfo.getBufferIsFullString());return false}var k={session:d.sessionId,object:m._dwsObject._dwsObjectId,method:"SaveDocumentAs",parameter:[m._documentEditor._docEditorId,p._imgViewerId,m._documentEditor.ui._GetPointInfo()]},o=function(){m._documentEditor.documentCtrl.destroy();p.ui._addImageControl()};var q=g.detect.postSyncCommand(m._dwsObject,g.stringify(k),o,null);return q};b.prototype._destory=function(h){if(!h){this._bDestoryed=true}else{this._bRemoved=true}};e.Document=b})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(f,d,a,e){function b(h,g){var j=this;j.dwsObject=h;j.documentEditor=g;j.documentEditorWidth="";j.documentEditorHeight="";j.documentUrl="";j.objDocument=false;j.objDocumentDefaultWidth="";j.objDocumentDefaultHeight="";j.defaultPointInfo="";j.pointInfo=new Array(10);j.movePointInfo=new Array(8);j.zoomPointInfo=new Array(8);j.midPointInfo=new Array(8);j.pointInductor=new Array(8);j.slopeSide=new Array(4);j.tempx="";j.tempy="";j.curPointIndex="";j.invalidShape=false;j.drawErrorRect=false;j.outerDiv=false;j.hintDiv=false;j.editorCanvas=false;j.editorCanvasWidth="";j.editorCanvasHeight="";j.containerBox=false;j.zoom=1;j.brushThickness=2;j.MAXLOACOUNT=6;j.curLoadCount=0;j.bDestroy=false;j.init()}b.prototype.init=function(){var g=this;g.documentEditorWidth=g.documentEditor.ui._userDocumentEditorWidth;g.documentEditorHeight=g.documentEditor.ui._userDocumentEditorHeight;g.containerBox=g.documentEditor.ui._documentContainerBox;g.outerDiv=g.documentEditor.ui._documentContainerImageObj;g.editorCanvas=g.documentEditor.ui._documentContainerCanvasEditor;g.documentContainerImageObj=g.documentEditor.ui._documentContainerImageObj};b.prototype.attachDocument=function(){var h=this;h.zoom=1;h.documentUrl=h.getRefreshedDocUrl();h.GetDocBoundaryInfoFromEditor();for(var g=0;g<h.pointInfo.length;g++){if(h.pointInfo[g]<0){h.pointInfo[g]=0}}h.objDocumentDefaultWidth=h.pointInfo[0];h.objDocumentDefaultHeight=h.pointInfo[1];h.movePointInfo=h.getMovePointInfo();h.copyArry(h.movePointInfo,h.zoomPointInfo);h.getSlopeSide();h.midPointInfo=h.getMidPointInfo();h.destroy();h.initHintDiv();h.initObjDoc();h.editorCanvas.onmousedown=function(o){var k=this.getContext("2d");var n=(o||window.event).offsetX;var p=(o||window.event).offsetY;h.brushThickness=h.documentEditor.ui.getDocumentBoundaryThickness();for(var m=0;m<h.pointInductor.length;m++){if(m<4){h.pointInductor[m]=Math.abs(h.zoomPointInfo[2*m]-n)<h.brushThickness*2+8&&Math.abs(h.zoomPointInfo[2*m+1]-p)<h.brushThickness*2+8?true:false}else{h.pointInductor[m]=Math.abs(h.midPointInfo[2*(m-4)]-n)<h.brushThickness*2+8&&Math.abs(h.midPointInfo[2*(m-4)+1]-p)<h.brushThickness*2+8?true:false}}for(var m=h.pointInductor.length-1;m>-1;m--){if(m<4&&h.pointInductor[m]==true){for(var l=0;l<h.pointInductor.length;l++){if(m!=l){h.pointInductor[l]=false}}}}for(var m=0;m<h.pointInductor.length;m++){if(h.pointInductor[m]==true&&!h.invalidShape){h.curPointIndex=m;if(m<4){h.tempx=h.zoomPointInfo[2*m];h.tempy=h.zoomPointInfo[2*m+1]}}}this.onmousemove=function(z){var j=(z||window.event).offsetX;var A=(z||window.event).offsetY;for(var w=0;w<h.pointInductor.length;w++){if(w<4&&h.pointInductor[w]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);h.zoomPointInfo[2*w]=j;h.zoomPointInfo[2*w+1]=A;h.getSlopeSide();if(h.checkPointCross()==true||h.checkPointShape()==true){h.drawErrorRect=true}h.checkPointBorder();h.drawRect()}else{if(w==4&&h.pointInductor[4]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var F=h.zoomPointInfo[0],y=h.zoomPointInfo[1],D=h.zoomPointInfo[2],v=h.zoomPointInfo[3];var s=h.slopeSide[0],E=-1,x=A-h.slopeSide[0]*j;var r=h.slopeSide[1],C=-1,u=h.zoomPointInfo[3]-h.slopeSide[1]*h.zoomPointInfo[2];var q=h.slopeSide[3],B=-1,t=h.zoomPointInfo[1]-h.slopeSide[3]*h.zoomPointInfo[0];if(h.slopeSide[0]==0){if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=A}else{h.zoomPointInfo[2]=(A-h.zoomPointInfo[3])/h.slopeSide[1]+h.zoomPointInfo[2];h.zoomPointInfo[3]=A}if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=A}else{h.zoomPointInfo[0]=(A-h.zoomPointInfo[1])/h.slopeSide[3]+h.zoomPointInfo[0];h.zoomPointInfo[1]=A}}else{if(h.slopeSide[0]=="Infinity"){if(h.slopeSide[1]==0){h.zoomPointInfo[2]=j;h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{h.zoomPointInfo[3]=h.slopeSide[1]*(j-h.zoomPointInfo[2])+h.zoomPointInfo[3];h.zoomPointInfo[2]=j}if(h.slopeSide[3]==0){h.zoomPointInfo[0]=j;h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{h.zoomPointInfo[1]=h.slopeSide[3]*(j-h.zoomPointInfo[0])+h.zoomPointInfo[1];h.zoomPointInfo[0]=j}}else{if(h.slopeSide[1]==0){h.zoomPointInfo[2]=h.zoomPointInfo[2]+(j-h.midPointInfo[0]);h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=h.zoomPointInfo[3]+(A-h.midPointInfo[1])}else{h.zoomPointInfo[2]=(C*x-E*u)/(r*E-s*C);h.zoomPointInfo[3]=(s*u-r*x)/(r*E-s*C)}}if(h.slopeSide[3]==0){h.zoomPointInfo[0]=h.zoomPointInfo[0]+(j-h.midPointInfo[0]);h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=h.zoomPointInfo[1]+(A-h.midPointInfo[1])}else{h.zoomPointInfo[0]=(B*x-E*t)/(q*E-s*B);h.zoomPointInfo[1]=(s*t-q*x)/(q*E-s*B)}}}}if(h.checkPointCross()||h.checkPointBorder()){h.editorCanvas.onmouseup();h.drawErrorRect=true;h.invalidShape=false;h.zoomPointInfo[0]=F;h.zoomPointInfo[1]=y;h.zoomPointInfo[2]=D;h.zoomPointInfo[3]=v}h.drawRect()}else{if(w==5&&h.pointInductor[5]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var F=h.zoomPointInfo[2],y=h.zoomPointInfo[3],D=h.zoomPointInfo[4],v=h.zoomPointInfo[5];var s=h.slopeSide[1],E=-1,x=A-h.slopeSide[1]*j;var r=h.slopeSide[0],C=-1,u=h.zoomPointInfo[3]-h.slopeSide[0]*h.zoomPointInfo[2];var q=h.slopeSide[2],B=-1,t=h.zoomPointInfo[5]-h.slopeSide[2]*h.zoomPointInfo[4];if(h.slopeSide[1]==0){if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=A}else{h.zoomPointInfo[4]=(A-h.zoomPointInfo[5])/h.slopeSide[2]+h.zoomPointInfo[4];h.zoomPointInfo[5]=A}if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=A}else{h.zoomPointInfo[2]=(A-h.zoomPointInfo[3])/h.slopeSide[0]+h.zoomPointInfo[2];h.zoomPointInfo[3]=A}}else{if(h.slopeSide[1]=="Infinity"){if(h.slopeSide[2]==0){h.zoomPointInfo[4]=j;h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{h.zoomPointInfo[5]=h.slopeSide[2]*(j-h.zoomPointInfo[4])+h.zoomPointInfo[5];h.zoomPointInfo[4]=j;
}if(h.slopeSide[0]==0){h.zoomPointInfo[2]=j;h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{h.zoomPointInfo[3]=h.slopeSide[0]*(j-h.zoomPointInfo[2])+h.zoomPointInfo[3];h.zoomPointInfo[2]=j}}else{if(h.slopeSide[2]==0){h.zoomPointInfo[4]=h.zoomPointInfo[4]+(j-h.midPointInfo[2]);h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=h.zoomPointInfo[5]+(A-h.midPointInfo[3])}else{h.zoomPointInfo[4]=(B*x-E*t)/(q*E-s*B);h.zoomPointInfo[5]=(s*t-q*x)/(q*E-s*B)}}if(h.slopeSide[0]==0){h.zoomPointInfo[2]=h.zoomPointInfo[2]+(j-h.midPointInfo[2]);h.zoomPointInfo[3]=h.zoomPointInfo[3]}else{if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[2]=h.zoomPointInfo[2];h.zoomPointInfo[3]=h.zoomPointInfo[3]+(A-h.midPointInfo[3])}else{h.zoomPointInfo[2]=(C*x-E*u)/(r*E-s*C);h.zoomPointInfo[3]=(s*u-r*x)/(r*E-s*C)}}}}if(h.checkPointCross()||h.checkPointBorder()){h.editorCanvas.onmouseup();h.drawErrorRect=true;h.invalidShape=false;h.zoomPointInfo[2]=F;h.zoomPointInfo[3]=y;h.zoomPointInfo[4]=D;h.zoomPointInfo[5]=v}h.drawRect()}else{if(w==6&&h.pointInductor[6]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var F=h.zoomPointInfo[4],y=h.zoomPointInfo[5],D=h.zoomPointInfo[6],v=h.zoomPointInfo[7];var s=h.slopeSide[2],E=-1,x=A-h.slopeSide[2]*j;var r=h.slopeSide[1],C=-1,u=h.zoomPointInfo[5]-h.slopeSide[1]*h.zoomPointInfo[4];var q=h.slopeSide[3],B=-1,t=h.zoomPointInfo[7]-h.slopeSide[3]*h.zoomPointInfo[6];if(h.slopeSide[2]==0){if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=A}else{h.zoomPointInfo[6]=(A-h.zoomPointInfo[7])/h.slopeSide[3]+h.zoomPointInfo[6];h.zoomPointInfo[7]=A}if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=A}else{h.zoomPointInfo[4]=(A-h.zoomPointInfo[5])/h.slopeSide[1]+h.zoomPointInfo[4];h.zoomPointInfo[5]=A}}else{if(h.slopeSide[2]=="Infinity"){if(h.slopeSide[3]==0){h.zoomPointInfo[6]=j;h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{h.zoomPointInfo[7]=h.slopeSide[3]*(j-h.zoomPointInfo[6])+h.zoomPointInfo[7];h.zoomPointInfo[6]=j}if(h.slopeSide[1]==0){h.zoomPointInfo[4]=j;h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{h.zoomPointInfo[5]=h.slopeSide[1]*(j-h.zoomPointInfo[4])+h.zoomPointInfo[5];h.zoomPointInfo[4]=j}}else{if(h.slopeSide[3]==0){h.zoomPointInfo[6]=h.zoomPointInfo[6]+(j-h.midPointInfo[4]);h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{if(h.slopeSide[3]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=h.zoomPointInfo[7]+(A-h.midPointInfo[5])}else{h.zoomPointInfo[6]=(B*x-E*t)/(q*E-s*B);h.zoomPointInfo[7]=(s*t-q*x)/(q*E-s*B)}}if(h.slopeSide[1]==0){h.zoomPointInfo[4]=h.zoomPointInfo[4]+(j-h.midPointInfo[4]);h.zoomPointInfo[5]=h.zoomPointInfo[5]}else{if(h.slopeSide[1]=="Infinity"){h.zoomPointInfo[4]=h.zoomPointInfo[4];h.zoomPointInfo[5]=h.zoomPointInfo[5]+(A-h.midPointInfo[5])}else{h.zoomPointInfo[4]=(C*x-E*u)/(r*E-s*C);h.zoomPointInfo[5]=(s*u-r*x)/(r*E-s*C)}}}}if(h.checkPointCross()||h.checkPointBorder()){h.editorCanvas.onmouseup();h.drawErrorRect=true;h.invalidShape=false;h.zoomPointInfo[4]=F;h.zoomPointInfo[5]=y;h.zoomPointInfo[6]=D;h.zoomPointInfo[7]=v}h.drawRect()}else{if(w==7&&h.pointInductor[7]==true){this.style.cursor="move";k.clearRect(0,0,h.editorCanvasWidth,h.editorCanvasHeight);var F=h.zoomPointInfo[6],y=h.zoomPointInfo[7],D=h.zoomPointInfo[0],v=h.zoomPointInfo[1];var s=h.slopeSide[3],E=-1,x=A-h.slopeSide[3]*j;var r=h.slopeSide[2],C=-1,u=h.zoomPointInfo[7]-h.slopeSide[2]*h.zoomPointInfo[6];var q=h.slopeSide[0],B=-1,t=h.zoomPointInfo[1]-h.slopeSide[0]*h.zoomPointInfo[0];if(h.slopeSide[3]==0){if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=A}else{h.zoomPointInfo[0]=(A-h.zoomPointInfo[1])/h.slopeSide[0]+h.zoomPointInfo[0];h.zoomPointInfo[1]=A}if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=A}else{h.zoomPointInfo[6]=(A-h.zoomPointInfo[7])/h.slopeSide[2]+h.zoomPointInfo[6];h.zoomPointInfo[7]=A}}else{if(h.slopeSide[3]=="Infinity"){if(h.slopeSide[0]==0){h.zoomPointInfo[0]=j;h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{h.zoomPointInfo[1]=h.slopeSide[0]*(j-h.zoomPointInfo[0])+h.zoomPointInfo[1];h.zoomPointInfo[0]=j}if(h.slopeSide[2]==0){h.zoomPointInfo[6]=j;h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{h.zoomPointInfo[7]=h.slopeSide[2]*(j-h.zoomPointInfo[6])+h.zoomPointInfo[7];h.zoomPointInfo[6]=j}}else{if(h.slopeSide[0]==0){h.zoomPointInfo[0]=h.zoomPointInfo[0]+(j-h.midPointInfo[6]);h.zoomPointInfo[1]=h.zoomPointInfo[1]}else{if(h.slopeSide[0]=="Infinity"){h.zoomPointInfo[0]=h.zoomPointInfo[0];h.zoomPointInfo[1]=h.zoomPointInfo[1]+(A-h.midPointInfo[7])}else{h.zoomPointInfo[0]=(B*x-E*t)/(q*E-s*B);h.zoomPointInfo[1]=(s*t-q*x)/(q*E-s*B)}}if(h.slopeSide[2]==0){h.zoomPointInfo[6]=h.zoomPointInfo[6]+(j-h.midPointInfo[6]);h.zoomPointInfo[7]=h.zoomPointInfo[7]}else{if(h.slopeSide[2]=="Infinity"){h.zoomPointInfo[6]=h.zoomPointInfo[6];h.zoomPointInfo[7]=h.zoomPointInfo[7]+(A-h.midPointInfo[7])}else{h.zoomPointInfo[6]=(C*x-E*u)/(r*E-s*C);h.zoomPointInfo[7]=(s*u-r*x)/(r*E-s*C)}}}}if(h.checkPointCross()||h.checkPointBorder()){h.editorCanvas.onmouseup();h.drawErrorRect=true;h.invalidShape=false;h.zoomPointInfo[6]=F;h.zoomPointInfo[7]=y;h.zoomPointInfo[0]=D;h.zoomPointInfo[1]=v}h.drawRect()}}}}}}}};h.editorCanvas.onmouseup=function(j){this.style.cursor="default";this.onmousemove=null;if(h.curPointIndex<4){if(h.checkPointCross()==true||h.checkPointShape()==true){h.zoomPointInfo[2*h.curPointIndex]=h.tempx;h.zoomPointInfo[2*h.curPointIndex+1]=h.tempy;h.getSlopeSide();h.drawErrorRect=true;h.drawRect();h.invalidShape=false}}};h.editorCanvas.onmouseout=function(j){this.style.cursor="default";this.onmousemove=null;h.editorCanvas.onmouseup()};h.editorCanvas.onmouseover=function(j){this.style.cursor="default";this.onmousemove=null;h.editorCanvas.onmouseup()}};b.prototype.getMovePointInfo=function(){var h=this;for(var g=0;g<h.movePointInfo.length;g++){h.movePointInfo[g]=h.pointInfo[g+2]}return h.movePointInfo};b.prototype.getMidPointInfo=function(){var g=this;g.midPointInfo[0]=1*((g.zoomPointInfo[0]+g.zoomPointInfo[2])/2);g.midPointInfo[1]=1*((g.zoomPointInfo[1]+g.zoomPointInfo[3])/2);g.midPointInfo[2]=1*((g.zoomPointInfo[2]+g.zoomPointInfo[4])/2);g.midPointInfo[3]=1*((g.zoomPointInfo[3]+g.zoomPointInfo[5])/2);g.midPointInfo[4]=1*((g.zoomPointInfo[4]+g.zoomPointInfo[6])/2);g.midPointInfo[5]=1*((g.zoomPointInfo[5]+g.zoomPointInfo[7])/2);g.midPointInfo[6]=1*((g.zoomPointInfo[6]+g.zoomPointInfo[0])/2);g.midPointInfo[7]=1*((g.zoomPointInfo[7]+g.zoomPointInfo[1])/2);return g.midPointInfo};b.prototype.getSlopeSide=function(){var h=this;for(var g=0;g<4;g++){if(g<3){if(h.zoomPointInfo[2*g+3]-h.zoomPointInfo[2*g+1]==0&&h.zoomPointInfo[2*(g+1)]-h.zoomPointInfo[2*g]==0){h.slopeSide[g]=0}else{h.slopeSide[g]=(h.zoomPointInfo[2*g+3]-h.zoomPointInfo[2*g+1])/(h.zoomPointInfo[2*(g+1)]-h.zoomPointInfo[2*g])}}else{if(g==3){if(h.zoomPointInfo[7]-h.zoomPointInfo[1]==0&&h.zoomPointInfo[6]-h.zoomPointInfo[0]==0){h.slopeSide[3]=0}else{h.slopeSide[3]=(h.zoomPointInfo[7]-h.zoomPointInfo[1])/(h.zoomPointInfo[6]-h.zoomPointInfo[0])}}}}return h.slopeSide};b.prototype.updateMovePointInfo=function(){var j=this,h;h=j.documentEditor.ui.getZoom();for(var g=0;g<j.zoomPointInfo.length;g++){j.movePointInfo[g]=1*(j.zoomPointInfo[g]/h)}for(var g=0;g<j.zoomPointInfo.length;g++){if(j.movePointInfo[g]<0){j.movePointInfo[g]=0}if(j.movePointInfo[2*g]>j.objDocumentDefaultWidth-1){j.movePointInfo[2*g]=j.objDocumentDefaultWidth-1}if(j.movePointInfo[2*g+1]>j.objDocumentDefaultHeight-1){j.movePointInfo[2*g+1]=j.objDocumentDefaultHeight-1}}return j.movePointInfo};b.prototype.updateZoomPointInfo=function(){var j=this,h;h=j.documentEditor.ui.getZoom();for(var g=0;g<j.zoomPointInfo.length;g++){j.zoomPointInfo[g]=j.zoomPointInfo[g]*(h/j.zoom)}j.zoom=h;return j.zoomPointInfo};b.prototype.checkPointBorder=function(){var h=this;for(var g=0;g<h.zoomPointInfo.length;g++){if(h.zoomPointInfo[g]<0){if(h.invalidShape==false){h.zoomPointInfo[g]=0;h.editorCanvas.onmouseup()}else{h.editorCanvas.onmouseup()}return true}if(h.zoomPointInfo[2*g]>h.editorCanvasWidth-1){if(h.invalidShape==false){h.zoomPointInfo[2*g]=h.editorCanvasWidth-1;h.editorCanvas.onmouseup()}else{h.editorCanvas.onmouseup()}return true}if(h.zoomPointInfo[2*g+1]>h.editorCanvasHeight-1){if(h.invalidShape==false){h.zoomPointInfo[2*g+1]=h.editorCanvasHeight-1;h.editorCanvas.onmouseup()}else{h.editorCanvas.onmouseup()}return true}}};b.prototype.checkPointCross=function(){var g=this;if(Math.round(g.zoomPointInfo[2])-Math.round(g.zoomPointInfo[0])<1||Math.round(g.zoomPointInfo[4])-Math.round(g.zoomPointInfo[6])<1||Math.round(g.zoomPointInfo[7])-Math.round(g.zoomPointInfo[1])<1||Math.round(g.zoomPointInfo[5])-Math.round(g.zoomPointInfo[3])<1){g.invalidShape=true;return true}return false};b.prototype.checkPointShape=function(){var n=this;var m=(n.zoomPointInfo[5]-n.zoomPointInfo[1])/(n.zoomPointInfo[4]-n.zoomPointInfo[0]),l=(n.zoomPointInfo[7]-n.zoomPointInfo[3])/(n.zoomPointInfo[6]-n.zoomPointInfo[2]);var j=m*(n.zoomPointInfo[2]-n.zoomPointInfo[0])+n.zoomPointInfo[1];var g=m*(n.zoomPointInfo[6]-n.zoomPointInfo[0])+n.zoomPointInfo[1];var k=l*(n.zoomPointInfo[0]-n.zoomPointInfo[2])+n.zoomPointInfo[3];var h=l*(n.zoomPointInfo[4]-n.zoomPointInfo[2])+n.zoomPointInfo[3];if(n.zoomPointInfo[3]-j<0&&n.zoomPointInfo[7]-g<0){n.invalidShape=true;return true}else{if(n.zoomPointInfo[3]-j>0&&n.zoomPointInfo[7]-g>0){n.invalidShape=true;return true}}if(n.zoomPointInfo[1]-k<0&&n.zoomPointInfo[5]-h<0){n.invalidShape=true;return true}else{if(n.zoomPointInfo[1]-k>0&&n.zoomPointInfo[5]-h>0){n.invalidShape=true;return true}}};b.prototype.initHintDiv=function(){var g=this;g.hintDiv=document.createElement("div");g.hintDiv.className="ds-dws-doc-hint-container";g.setHintString("Loading ...");g.hintDiv.style.display="none";g.hintDiv.style.textAlign="center";g.outerDiv.appendChild(g.hintDiv)};b.prototype.setHintString=function(g){if(!f.isString(g)){return null}var h=this;if(h.hintDiv.innerText){h.hintDiv.innerText=g}else{if(h.hintDiv.textContent){h.hintDiv.textContent=g}else{h.hintDiv.appendChild(document.createTextNode(g))}}};b.prototype.drawRect=function(h){var j=this;j.getMidPointInfo();var g=j.editorCanvas.getContext("2d");j.brushThickness=j.documentEditor.ui.getDocumentBoundaryThickness();g.clearRect(0,0,j.editorCanvasWidth,j.editorCanvasHeight);g.beginPath();if(j.drawErrorRect){g.strokeStyle=f.IntToColorStr(4278190335);j.drawErrorRect=false;setTimeout(function(){j.drawRect()},100)}else{g.strokeStyle=f.IntToColorStr(j.documentEditor.ui.getDocumentBoundaryColor())}g.lineWidth=j.brushThickness;g.moveTo(j.zoomPointInfo[0],j.zoomPointInfo[1]);g.lineTo(j.zoomPointInfo[2],j.zoomPointInfo[3]);g.lineTo(j.zoomPointInfo[4],j.zoomPointInfo[5]);g.lineTo(j.zoomPointInfo[6],j.zoomPointInfo[7]);g.closePath();g.stroke();j.drawArc(j.zoomPointInfo[0],j.zoomPointInfo[1],j.brushThickness+4,j.brushThickness+3);j.drawArc(j.zoomPointInfo[2],j.zoomPointInfo[3],j.brushThickness+4,j.brushThickness+3);j.drawArc(j.zoomPointInfo[4],j.zoomPointInfo[5],j.brushThickness+4,j.brushThickness+3);j.drawArc(j.zoomPointInfo[6],j.zoomPointInfo[7],j.brushThickness+4,j.brushThickness+3);j.drawArc(j.midPointInfo[0],j.midPointInfo[1],j.brushThickness+3,j.brushThickness+2);j.drawArc(j.midPointInfo[2],j.midPointInfo[3],j.brushThickness+3,j.brushThickness+2);j.drawArc(j.midPointInfo[4],j.midPointInfo[5],j.brushThickness+3,j.brushThickness+2);j.drawArc(j.midPointInfo[6],j.midPointInfo[7],j.brushThickness+3,j.brushThickness+2)};b.prototype.drawArc=function(j,g,m,k){var l=this;var h=l.editorCanvas.getContext("2d");h.beginPath();h.fillStyle=f.IntToColorStr(l.documentEditor.ui.getDocumentBoundaryColor());h.lineWidth=l.documentEditor.ui.getDocumentBoundaryThickness();h.arc(j,g,m,0,Math.PI*2);h.stroke();h.closePath();h.beginPath();h.fillStyle="rgba(255,255,255,.5)";h.arc(j,g,k,0,Math.PI*2);h.fill();h.closePath()};b.prototype.initObjDoc=function(){var g=this;g.objDocument=new Image;g.objDocument.className="ds-dws-doc-obj";g.objDocument.setAttribute("alt","document editor");g.objDocument.style.display="none";g.hintDiv.style.display="block";g.setHintString("Loading ...");g.positionHintDiv();g.objDocument.onload=function(){g.fitDocument();g.hintDiv.style.display="none";g.objDocument.style.display=""};g.objDocument.onerror=function(){++g.curLoadCount;if(g.curLoadCount>g.MAXLOACOUNT){g.setHintString("Error ocurrs");a.handleImageLoadingError(g.dwsObject,g.objDocument.src);if(g.objDocument.parentNode){g.objDocument.parentNode.removeChild(this)}}else{g.objDocument.src=[g.documentUrl,"&ts=",f.now()].join("")}};g.curLoadCount=1;g.objDocument.src=[g.documentUrl,"&ts=",f.now()].join("");g.outerDiv.appendChild(g.objDocument)};b.prototype.refreshUIDoc=function(){var h=this,g;g=h.documentEditor.ui.getZoom();h.objDocument.width=g*h.objDocumentDefaultWidth;h.objDocument.height=g*h.objDocumentDefaultHeight;h.editorCanvas.setAttribute("width",g*h.objDocumentDefaultWidth);h.editorCanvas.setAttribute("height",g*h.objDocumentDefaultHeight);h.editorCanvasWidth=g*h.objDocumentDefaultWidth;h.editorCanvasHeight=g*h.objDocumentDefaultHeight;h.refreshScrollBar();h.positionObjDoc();h.positionEditorCanvas()};b.prototype.refreshSrcDoc=function(){var k=this,j;var g=k.hintDiv,h=k.objDocument;j=k.documentEditor.ui.getZoom();k.initHintDiv();k.objDocument=new Image;k.objDocument.className="ds-dws-doc-obj";k.objDocument.setAttribute("alt","document editor");k.objDocument.style.display="none";k.hintDiv.style.display="block";k.setHintString("Loading ...");k.positionHintDiv();k.objDocument.onload=function(){k.documentContainerImageObj.removeChild(g);k.documentContainerImageObj.removeChild(h);k.objDocument.width=j*k.objDocumentDefaultWidth;k.objDocument.height=j*k.objDocumentDefaultHeight;k.positionObjDoc();k.hintDiv.style.display="none";k.objDocument.style.display=""};k.objDocument.onerror=function(){++k.curLoadCount;if(k.curLoadCount>k.MAXLOACOUNT){k.setHintString("Error ocurrs");a.handleImageLoadingError(k.dwsObject,k.objDocument.src);if(k.objDocument.parentNode){k.objDocument.parentNode.removeChild(this)}}else{k.objDocument.src=[k.documentUrl,"&ts=",f.now()].join("")}};k.curLoadCount=1;k.objDocument.src=[k.documentUrl,"&ts=",f.now()].join("");k.outerDiv.appendChild(k.objDocument)};b.prototype.refreshRotateDoc=function(l){var m=this,j,h;var g=m.hintDiv,k=m.objDocument;m.zoom=m.documentEditor.ui.getZoom();m.initHintDiv();m.objDocument=new Image;m.objDocument.className="ds-dws-doc-obj";m.objDocument.setAttribute("alt","document editor");m.objDocument.style.display="none";m.hintDiv.style.display="block";m.setHintString("Loading ...");m.positionHintDiv();j=m.objDocumentDefaultWidth;m.objDocumentDefaultWidth=m.objDocumentDefaultHeight;m.objDocumentDefaultHeight=j;m.objDocument.onload=function(){m.documentContainerImageObj.removeChild(g);m.documentContainerImageObj.removeChild(k);m.objDocument.width=m.zoom*m.objDocumentDefaultWidth;m.objDocument.height=m.zoom*m.objDocumentDefaultHeight;m.positionObjDoc();m.hintDiv.style.display="none";m.objDocument.style.display="";m.refreshScrollBar();if(l=="left"){m.refreshRotateLeftCanvas()}else{m.refreshRotateRightCanvas()}if(m.documentEditor.ui._zoomSet==false){m.fitDocument()}};m.objDocument.onerror=function(){++m.curLoadCount;if(m.curLoadCount>m.MAXLOACOUNT){m.setHintString("Error ocurrs");a.handleImageLoadingError(m.dwsObject,m.objDocument.src);if(m.objDocument.parentNode){m.objDocument.parentNode.removeChild(this)}}else{m.objDocument.src=[m.documentUrl,"&ts=",f.now()].join("")}};m.curLoadCount=1;m.objDocument.src=[m.documentUrl,"&ts=",f.now()].join("");m.outerDiv.appendChild(m.objDocument)};b.prototype.refreshRotateRightCanvas=function(){var k=this,j=new Array(8),h=new Array(8);k.copyArry(k.zoomPointInfo,j);k.editorCanvasWidth=k.zoom*k.objDocumentDefaultWidth;k.editorCanvasHeight=k.zoom*k.objDocumentDefaultHeight;k.editorCanvas.setAttribute("width",k.zoom*k.objDocumentDefaultWidth);k.editorCanvas.setAttribute("height",k.zoom*k.objDocumentDefaultHeight);for(var g=0;g<j.length;g++){if(g<2){k.zoomPointInfo[g]=j[g+6]}else{if(g>1){k.zoomPointInfo[g]=j[g-2]}}}k.copyArry(k.zoomPointInfo,h);for(var g=0;g<h.length/2;g++){k.zoomPointInfo[2*g+1]=h[2*g];k.zoomPointInfo[2*g]=k.editorCanvasWidth-h[2*g+1]}k.drawRect();k.positionEditorCanvas()};b.prototype.refreshRotateLeftCanvas=function(){var k=this,j=new Array(8),h=new Array(8);k.copyArry(k.zoomPointInfo,j);k.editorCanvasWidth=k.zoom*k.objDocumentDefaultWidth;k.editorCanvasHeight=k.zoom*k.objDocumentDefaultHeight;k.editorCanvas.setAttribute("width",k.zoom*k.objDocumentDefaultWidth);k.editorCanvas.setAttribute("height",k.zoom*k.objDocumentDefaultHeight);k.zoomPointInfo[0]=j[2];k.zoomPointInfo[1]=j[3];k.zoomPointInfo[2]=j[4];k.zoomPointInfo[3]=j[5];k.zoomPointInfo[4]=j[6];k.zoomPointInfo[5]=j[7];k.zoomPointInfo[6]=j[0];k.zoomPointInfo[7]=j[1];k.copyArry(k.zoomPointInfo,h);for(var g=0;g<h.length/2;g++){k.zoomPointInfo[2*g+1]=k.editorCanvasHeight-h[2*g];k.zoomPointInfo[2*g]=h[2*g+1]}k.drawRect();k.positionEditorCanvas()};b.prototype.fitDocument=function(){var j=this;var h=j.documentEditorWidth/j.documentEditorHeight;var g=j.objDocumentDefaultWidth/j.objDocumentDefaultHeight;if(g>h){j.objDocument.width=j.documentEditorWidth;j.objDocument.height=j.objDocument.width/g}else{j.objDocument.height=j.documentEditorHeight;j.objDocument.width=j.objDocument.height*g}j.editorCanvas.setAttribute("width",j.objDocument.width);j.editorCanvas.setAttribute("height",j.objDocument.height);j.editorCanvasWidth=j.objDocument.width;j.editorCanvasHeight=j.objDocument.height;j.documentEditor.ui._zoom=j.objDocument.width/j.objDocumentDefaultWidth;j.updateZoomPointInfo();j.positionObjDoc();j.positionEditorCanvas();j.refreshScrollBar();j.drawRect()};b.prototype.refreshScrollBar=function(){var g=this;if(g.objDocument.width>g.documentEditorWidth){g.containerBox.style.overflowX="scroll"}else{g.containerBox.style.overflowX="hidden"}if(g.objDocument.height>g.documentEditorHeight){g.containerBox.style.overflowY="scroll"}else{g.containerBox.style.overflowY="hidden"}};b.prototype.positionObjDoc=function(){var j=this;if(!j.objDocument){return}j.objDocument.style.position="absolute";var h=(j.documentEditorHeight-j.objDocument.height)/2,g=(j.documentEditorWidth-j.objDocument.width)/2;if(h<0){h=0}if(g<0){g=0}j.objDocument.style.top=parseInt(h)+"px";j.objDocument.style.left=parseInt(g)+"px"};b.prototype.positionEditorCanvas=function(){var j=this;var h=(j.documentEditorHeight-j.editorCanvasHeight)/2,g=(j.documentEditorWidth-j.editorCanvasWidth)/2;if(h<0){h=0}if(g<0){g=0}j.editorCanvas.style.top=parseInt(h)+"px";j.editorCanvas.style.left=parseInt(g)+"px"};b.prototype.positionHintDiv=function(){var m=this,h=m.documentEditor.ui._userDocumentEditorWidth,j=m.documentEditor.ui._userDocumentEditorHeight,l=m.hintDiv.style.width,g=m.hintDiv.style.height;var k=(j-g)/2;if(k<0){k=0}m.hintDiv.style.position="relative";m.hintDiv.style.top=parseInt(k)+"px"};b.prototype.refreshUI=function(){var g=this;g.updateZoomPointInfo();g.midPointInfo=g.getMidPointInfo();g.refreshUIDoc();g.drawRect()};b.prototype.refreshSrc=function(){var g=this;g.documentUrl=g.getRefreshedDocUrl();g.refreshSrcDoc()};b.prototype.refreshRotate=function(g){var h=this;h.documentUrl=h.getRefreshedDocUrl();h.refreshRotateDoc(g)};b.prototype.copyArry=function(h,g){for(var j=0;j<h.length;j++){g[j]=h[j]}};b.prototype.getRefreshedDocUrl=function(){var g=this;return[a.preUrl,a.portInfo.curPort,"/",dynamsoft.dcsEnv._getVersionStrForCommand(),"/img?session=",a.sessionId,"&object=",g.dwsObject._dwsObjectId,"&documenteditor=",g.documentEditor._docEditorId].join("")};b.prototype.GetDocBoundaryInfoFromEditor=function(){var k=this;var j={session:a.sessionId,object:k.dwsObject._dwsObjectId,method:"GetDocBoundaryInfo",parameter:[k.documentEditor._docEditorId]},h=function(l){k.pointInfo=l.result};var g=f.detect.postSyncCommand(k._dwsObject,f.stringify(j),h,null)};b.prototype.destroy=function(){var g=this;if(g.hintDiv&&g.hintDiv.parentNode){g.hintDiv.parentNode.removeChild(g.hintDiv)}if(g.objDocument&&g.objDocument.parentNode){g.objDocument.parentNode.removeChild(g.objDocument)}if(g.editorCanvas){g.editorCanvas.getContext("2d").clearRect(0,0,g.documentEditor.ui._userDocumentEditorWidth,g.documentEditor.ui._userDocumentEditorHeight)}else{g.documentEditor.ui._documentContainerCanvasEditor.getContext("2d").clearRect(0,0,g.documentEditor.ui._userDocumentEditorWidth,g.documentEditor.ui._userDocumentEditorHeight)}g.editorCanvas.setAttribute("width","");g.editorCanvas.setAttribute("height","");g.editorCanvasWidth=g.objDocument.width=0;g.editorCanvasHeight=g.objDocument.height=0;g.zoom=1;g.documentEditor.ui._zoom=1;g.documentEditor.ui._zoomSet=false;g.refreshScrollBar();g.bDestroy=true};d.DocumentControl=b})(dynamsoft.lib,dynamsoft.lib.sdk,dynamsoft.lib.detect,dynamsoft.dcsEnv);var EnumDCS_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};(function(d,j){var e=false;var h=function(){var l=dynamsoft.initOrder,n=false;if(!e){for(var m=0;m<l.length;m++){if(l[m]=="dcs"){n=true;break}}if(!n){l.push("dcs");e=true}}j.initQueue.push(arguments)};var g=function(m){if(arguments.length!=1||!d.isString(m)){return null}var l=j._videoViewerDic[m];return l?l.dwsObject:null};var b=function(){var l;if(arguments.length>0){return l}var n={session:d.detect.sessionId,method:"GetConfigedLogLevel"},m=function(o){if(o.result[0]!==undefined){l=o.result[0]}};d.detect.postSyncCommand(null,d.stringify(n),m,null);return l};var a=function(m){var l=!1;if(arguments.length!=1||!d.isNumber(arguments[0])){return l}m=Math.round(m);if(m!==0&&m!==1){return l}var n={session:d.detect.sessionId,method:"ConfigLogLevel",parameter:[m]};l=d.detect.postSyncCommand(null,d.stringify(n),null,null);return l};var k=function(){var l=!1;if(arguments.length>0){return l}var m={session:d.detect.sessionId,method:"RemoveAllCameraAuthorizations"};l=d.detect.postSyncCommand(null,d.stringify(m),null,null);return l};var f=function(o){var l=!1;if(arguments.length!=1||!d.isNumber(arguments[0])){return l}o=Math.round(o);var m=!1;for(var n in EnumDCS_Language){if(EnumDCS_Language[n]==o){m=!0;break}}if(!m){return l}j._lang=o;return true};j.init=h;j.getObject=g;j.getLogLevel=b;j.setLogLevel=a;j.removeAllCameraAuthorizations=k;j.ondcsnotfound=undefined;j.ondcsneedupgrade=undefined;j.setLanguage=f;j.initQueue=[];j._videoViewerDic={};j._imageViewerDic={};j._documentEditorDic={};j._bTurnToInitDcsObj=false})(dynamsoft.lib,dynamsoft.dcsEnv);(function(k,t,r){var f=false,l=false,j=null;var o=function(){f=true;if(!t.bConnected&&!t.dcsModuleBinary&&t.downloadDcsModuleStatus===t.enumDownloadDcsModuleStatus.idle){t.downloadDcsModule()}if(t.bConnected){t.sendHeartBeatCommand(true)}if(t.bConnected&&j){a()}},a=function(){Dynamsoft__OnclickCloseInstallEx();setTimeout(function(){t.sendHeartBeatCommand(true);var x=r._dwsObjClientIdPrefix+k.getRandom(),w=r._imgViewerClientIdPrefix+k.getRandom(),v=t.getInitInfo(x,w);if(v===undefined){t.bConnected=false}else{if(t.isValidResponseValue(v)&&v.exception!=0){t.sendRemoveObjectCommand(x);if(!k.isNull(j[3])){if(v.exception===EnumDCS_ErrorCode.CameraNotAuthorized&&k.isString(v.description)){v.description=v.description.replace("/Webcams","")}j[3](v.exception,v.description)}}else{if(t.isValidResponseValue(v)&&v.exception==0){new k.sdk.DcsObject(j[0],j[1],x,w);if(!k.isNull(j[2])){j[2](j[0],j[1])}}}}if(v==undefined){r.initQueue.unshift(j)}j=null;l=false;h(true)},100)};t.bConnectNumLimited=true;t.asyncGetServiceInfo(function(){o()},function(){o()});var q=4,d,e,s,m,n,g,u;var h=function(v){if(dynamsoft.initOrder.length>0&&dynamsoft.initOrder[0]=="dcs"){dynamsoft.initOrder.splice(0,1);r._bTurnToInitDcsObj=v}};var b=function(){d=j[0];e=j[1];s=j[2];m=j[3];n=false;g=0;u="Successful";if(j.length!=q){n=true;g=k.errorInfo.getParameterNumberUnmatchedCode();u=k.errorInfo.getParameterNumberUnmatchedString(j.length<4)}if(!n&&!k.isString(d)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("videoViewerContainer")}if(!n&&!k.isString(e)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("imageViewerContainer")}if(!n&&!k.isFunction(s)&&!k.isNull(s)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("onSuccess")}if(!n&&!k.isFunction(m)&&!k.isNull(m)){n=true;g=k.errorInfo.getTypeNotValidCode();u=k.errorInfo.getTypeNotValidString("onFailure")}if(!n&&d==e){n=true;g=k.errorInfo.getContainerIdNotValidCode();u=k.errorInfo.getContainerIdNotValidString()}if(!n){var x;try{x=k.one("#"+d).getEL()}catch(w){x=false}if(!x){n=true;g=k.errorInfo.getObjectNotExistCode();u=k.errorInfo.getObjectNotExistString(d)}if(!n&&x.nodeName.toUpperCase()!="DIV"){n=true;g=k.errorInfo.getContainerTypeNotValidCode();u=k.errorInfo.getContainerTypeNotValidString(false)}}if(!n){var v;try{v=k.one("#"+e).getEL()}catch(w){v=false}if(!v){n=true;g=k.errorInfo.getObjectNotExistCode();u=k.errorInfo.getObjectNotExistString(e)}if(!n&&v.nodeName.toUpperCase()!="DIV"){n=true;g=k.errorInfo.getContainerTypeNotValidCode();u=k.errorInfo.getContainerTypeNotValidString(true)}}if(!n&&r._videoViewerDic[d]){n=true;g=k.errorInfo.getObjectOccupiedCode();u=k.errorInfo.getObjectOccupiedString(d)}if(!n&&r._imageViewerDic[e]){n=true;g=k.errorInfo.getObjectOccupiedCode();u=k.errorInfo.getObjectOccupiedString(e)}};var p=function(){if(!t.bConnected&&!f||r.initQueue.length<=0||l){return}if(!(dynamsoft.initOrder.length>0&&dynamsoft.initOrder[0]=="dcs"||r._bTurnToInitDcsObj)){return}l=true;j=r.initQueue[0];r.initQueue.splice(0,1);if(!j){l=false;return}else{b();if(n){l=false;if(k.isFunction(m)){setTimeout(function(){m(g,u)},0)}h(false);return}}var v=function(){if(!k.isString(t.getSessionIdSync())){if(j){r.initQueue.unshift(j)}l=false;return true}return false},w=function(){t.asyncGetServiceInfo(function(){if(v()){return}a()},function(){t.downloadDcsModule(function(){dynamsoft.dcp.loadZip(t.dcsModuleBinary,100,function(y){var x;try{x=k.parse(y)}catch(z){x=null}if(x&&x.result&&x.result.length>0&&!x.result[0]){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getSendDcsModuleFailedCode(),k.errorInfo.getSendDcsModuleFailedString())},0)}t.downloadDcsModuleStatus=t.enumDownloadDcsModuleStatus.fail;h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return}t.asyncGetServiceInfo(function(){if(v()){return}a()},function(){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getConnectDcsModuleFailedCode(),k.errorInfo.getConnectDcsModuleFailedString())},0)}h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return},500,20)},function(){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getSendDcsModuleFailedCode(),k.errorInfo.getSendDcsModuleFailedString())},0)}h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return})},function(){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getDownloadDcsModuleFailedCode(),k.errorInfo.getDownloadDcsModuleFailedString())},0)}h(false);setTimeout(function(){Dynamsoft__OnclickCloseInstallEx()},0);return})},undefined,2)};dynamsoft.dcp.versionInfo(function(x,z){if(dynamsoft.dcp.detect.bConnected){w()}else{if(r.navInfo.bIE&&parseInt(r.navInfo.strBrowserVersion)<=9&&k.isString(z)&&(z.toLowerCase().indexOf("denied")!==-1||z.toLowerCase().indexOf(t.IE_PERMISSION_DENIED_Err_Code)!==-1||z.toLowerCase().indexOf(t.IE_Unknown_Err_Code)!==-1)){l=false;if(k.isFunction(m)){setTimeout(function(){m(k.errorInfo.getOperationNotSupportedCode(),k.errorInfo.getOperationNotSupportedString())},0)}h(false);return}var y=false;if(k.isFunction(r.ondcsnotfound)){y=r.ondcsnotfound()}if(k.isBoolean(y)&&!y){Dynamsoft__OnclickCloseInstallEx();r.showInstallDialog(true)}t.asyncConnDcpUnitlReady(function(){w()})}})};setInterval(p,1e3)})(dynamsoft.lib,dynamsoft.lib.detect,dynamsoft.dcsEnv);(function(a){a.ready(function(){var b=[dynamsoft.dcsEnv.resourcesPath,"/hint.css"].join("");a.getCss(b)})})(dynamsoft.lib);